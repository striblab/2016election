<!DOCTYPE html>
<html lang="en">
<head>
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
#if($req.param("show"))
  #set($showMap = $req.param("show"))
#end
#if($showMap)
#set($paneNum = $showMap)
#else
#set($paneNum = "1")
#end
<style type="text/css">
/*
This CSS resource incorporates links to font software which is
the valuable copyrighted property of WebType LLC, The Font Bureau,
Ascender Corporation and/or their suppliers. You may not
attempt to copy, install, redistribute, convert, modify or reverse
engineer this font software. Please contact WebType with any
questions: http://www.webtype.com
*/

/*
@font-face syntax based on Fontspring @font-face syntax.
*/

@font-face {
  font-family: Popular;
  src: url("http://apps.startribune.com/fonts/popular/regular/851caebd-2961-4fd9-a500-2b38452b1ec9-2.eot?") format("embedded-opentype"),
     url("http://apps.startribune.com/fonts/popular/regular/851caebd-2961-4fd9-a500-2b38452b1ec9-3.woff") format("woff"),
     url("http://apps.startribune.com/fonts/popular/regular/851caebd-2961-4fd9-a500-2b38452b1ec9-1.ttf") format("truetype"),
     url("http://apps.startribune.com/fonts/popular/regular/851caebd-2961-4fd9-a500-2b38452b1ec9-4.svg#web") format("svg");
  font-style: normal;
  font-weight: normal;
}

@font-face {
  font-family: Popular-medium;
  src: url("http://apps.startribune.com/fonts/popular/medium/96c3bd87-fed5-419d-a1cf-d947b17d6ab7-2.eot?") format("embedded-opentype"),
     url("http://apps.startribune.com/fonts/popular/medium/96c3bd87-fed5-419d-a1cf-d947b17d6ab7-3.woff") format("woff"),
     url("http://apps.startribune.com/fonts/popular/medium/96c3bd87-fed5-419d-a1cf-d947b17d6ab7-1.ttf") format("truetype"),
     url("http://apps.startribune.com/fonts/popular/medium/96c3bd87-fed5-419d-a1cf-d947b17d6ab7-4.svg#web") format("svg");
  font-style: normal;
  font-weight: normal;
}

@font-face {
  font-family: Popular-bold;
  src: url("http://apps.startribune.com/fonts/popular/bold/9a23c9ca-82fe-417a-9070-5f5daeaf6214-2.eot?") format("embedded-opentype"),
  url("http://apps.startribune.com/fonts/popular/bold/9a23c9ca-82fe-417a-9070-5f5daeaf6214-3.woff") format("woff"),
  url("http://apps.startribune.com/fonts/popular/bold/9a23c9ca-82fe-417a-9070-5f5daeaf6214-1.ttf") format("truetype"),
  url("http://apps.startribune.com/fonts/popular/bold/9a23c9ca-82fe-417a-9070-5f5daeaf6214-4.svg#web") format("svg");
  font-style: normal;
  font-weight: bold;
}
</style>

    <meta charset="utf-8">

<link href="http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="http://www.startribune.com/includes/election2014dashboards.css" type="text/css" />
<!--STYLESHEETS-->
<link href="http://apps.startribune.com/js/nvd3-master/src/nv.d3.css" rel="stylesheet" type="text/css">
<link href='//cdn.datatables.net/1.10.2/css/jquery.dataTables.css' rel='stylesheet' />
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css">

<style>
path:hover {
  fill-opacity: 1 !important;
  fill: #888 !important;
  stroke-width: .5px !important;
  cursor:pointer;
}

path{
  stroke-width: .5px !important;
}

.symbol {
  fill: #ddd;
  fill-opacity: 1;
  stroke: #fff;
}

.land {
  fill: #222;
}

.state {
    fill: #ddd;
}

.state:hover {
    cursor:pointer;
    stroke: white !important;
    fill: #888 !important;
stroke-opacity: 0 !important;
}

.state-label{
    cursor:pointer;
}

rect{
border-radius:2px !important;
}

rect:hover{
stroke-opacity: 1 !important;
stroke: #000 !important;
cursor:pointer;
}

.dfl_safe{ 
fill:#506fb3;

}

.dfl_safe:hover{
    fill: #888 !important;
stroke-opacity: 0 !important;
}

.gop_safe{ 
fill:#d46354;
}

.gop_safe:hover{
    fill: #888 !important;
stroke-opacity: 0 !important;
}

.dfl_lean{ 
fill:#8493c8;
}

.dfl_lean:hover{
    fill: #888 !important;
stroke-opacity: 0 !important;
}

.gop_lean{ 
fill:#d46354;
}

.i_lean{ 
fill:#000;
}

.gop_lean:hover{
    fill: #888 !important;
stroke-opacity: 0 !important;
}

.nothing{ 
fill:#ddd;
}

.nothing:hover{
    fill: #888 !important;
stroke-opacity: 0 !important;
}


.state-label {
    -webkit-user-select: none;  /* Chrome all / Safari all */
    -moz-user-select: none;     /* Firefox all */
    -ms-user-select: none;      /* IE 10+ */
}

.key text {
    dominant-baseline: central;
    font-size: 12px;
}
.leader {
    stroke: #666;
    shape-rendering: crispEdges;
}

.selectable{
fill:#c0bfeb !important;
background-color:#c0bfeb !important;
}

 #container {
    display: table;
    width:100%;
    }

  #row  {
    display: table-row;
    }

  #left, #right/*, #middle */{
    display: table-cell;
    vertical-align: top;
    }

div{
vertical-align: text-top;
}

.nvtooltip{
font-size:16px !important;
font-weight:bold !important;
padding:10px !important;
display: block !important;
margin-left: auto !important;
margin-right: auto !important;
width:auto !important;
border: 1px solid black !important;
}

.nv-axisMaxMin text{
font-weight: normal !important;
}

.nv-slice:hover{
stroke-opacity: 1 !important;
stroke: #000 !important;
}

.nvd3 .nv-wrap .nv-multiBarHorizontalChart{
width:100% !important;
}

.nvd3 .nv-wrap .nv-multiBarHorizontalChart g{
width:100% !important;
}

.dfl_safe{ 
fill:#506fb3;
}

.gop_safe{ 
fill:#d46354;
}

.dfl_lean{ 
fill:#8493c8;
}

.gop_lean{ 
fill:#f48072;
}

.nothing{ 
fill:#ddd;
}

</style>

<style>
.CSSTableGenerator {
  margin:0px;padding:0px;
  width:100%;
  border:1px solid #fff;
  
  -moz-border-radius-bottomleft:0px;
  -webkit-border-bottom-left-radius:0px;
  border-bottom-left-radius:0px;
  
  -moz-border-radius-bottomright:0px;
  -webkit-border-bottom-right-radius:0px;
  border-bottom-right-radius:0px;
  
  -moz-border-radius-topright:0px;
  -webkit-border-top-right-radius:0px;
  border-top-right-radius:0px;
  
  -moz-border-radius-topleft:0px;
  -webkit-border-top-left-radius:0px;
  border-top-left-radius:0px;
}

.CSSTableGenerator table{
    border-collapse: collapse;
        border-spacing: 0;
  width:100%;
  height:100%;
  margin:0px;padding:0px;
}

.CSSTableGenerator tr:last-child td:last-child {
  -moz-border-radius-bottomright:0px;
  -webkit-border-bottom-right-radius:0px;
  border-bottom-right-radius:0px;
}

.CSSTableGenerator table tr:first-child td:first-child {
  -moz-border-radius-topleft:0px;
  -webkit-border-top-left-radius:0px;
  border-top-left-radius:0px;
}

.CSSTableGenerator table tr:first-child td:last-child {
  -moz-border-radius-topright:0px;
  -webkit-border-top-right-radius:0px;
  border-top-right-radius:0px;
}

.CSSTableGenerator tr:last-child td:first-child{
  -moz-border-radius-bottomleft:0px;
  -webkit-border-bottom-left-radius:0px;
  border-bottom-left-radius:0px;
}

.CSSTableGenerator tr:hover td{
  
}

.CSSTableGenerator tr:nth-child(odd){ background-color:#ddd; }

.CSSTableGenerator tr:nth-child(even) {background-color:#ddd; }

.CSSTableGenerator td{
  vertical-align:middle;
  border:1px solid #fff;
  border-width:0px 1px 1px 0px;
  text-align:center;
  padding:5px 0px;
  font-size:14px;
  font-family: Helvetica, Arial, sans-serif;
  font-weight:normal;
  color:#000000;
}

.CSSTableGenerator tr:last-child td{
  border-width:0px 1px 0px 0px;
}

.CSSTableGenerator tr td:last-child{
  border-width:0px 0px 1px 0px;
}

.CSSTableGenerator tr:last-child td:last-child{
  border-width:0px 0px 0px 0px;
}

#menu{
width:100%;
float:left;
}

a{
text-decoration:none;
color:#000;
}

a:hover{
text-decoration:none;
color:#000;
}

.nav-tabs .active{
background-color: #222222 !important;
color:red !important;
font-weight:bold;
}

.active a{
color:#fff !important;
}

div a{
color:black !important;
}

td:hover{
background-color: #888;
cursor:pointer;
}

.tab-content.active{
display: block;
}
 
.tab-content.hide{
display: none;
}
</style>

<style>

path:hover {
  fill-opacity: 0.5;
  stroke: #fff !important;
}

.symbol {
  fill: #ddd;
  fill-opacity: 1;
  stroke: #fff;
}

.tooltip{ background-color:rgba(255,255,255,1);
          margin: 10px;
          height: 90px;
          width: 180px;
          padding-left: 10px; 
          padding-right: 10px; 
          padding-top: 10px;
    -webkit-border-radius:10px;
    -moz-border-radius:10px;
    border-radius:0;
    border: 1px solid black;
    font-size:12px;
    font-family: Helvetica, sans-serif;
        }

label > input{ /* HIDE RADIO */
  display:none;
}
label > input + img{ /* IMAGE STYLES */
  cursor:pointer;
  border:2px solid transparent;
  width:47px;
}
label > input:checked + img{ /* (CHECKED) IMAGE STYLES */
  border:2px solid #ddd;
}

#stateMaps-full, #cartoMaps-full {
  width:200px;
}

#target-leg, #target-leg2, #target-gov, #target-gov2, #target-rep, #target-rep2, #target-sen, #target-sen2, #map-leg, #map-gov, #map-gov2, #map-sen, #map-sen2, #map-rep, #map-rep2, #table-leg, #table-gov, #table-rep, #table-sen, #table-leg2, #table-gov2, #table-rep3, #table-sen2 {

height:230px !important;
}

#target-leg, #target-leg2, #target-gov, #target-gov2, #target-rep, #target-rep2, #target-sen, #target-sen2, #map-leg, #map-gov, #map-sen, #map-rep, #map-rep2, #map-gov3, #map-sen3 {

width:200px !important;
}

#target-gov2 svg, #target-sen2 svg, #map-sen2 svg, #map-gov2 svg {
width:378px !important;
height:230px !important;
}

#target-leg, #target-leg2, #target-rep, #target-rep2, #target-sen, #target-sen2, #map-leg, #map-leg2, #map-sen, #map-sen2, #map-rep, #map-rep2, #table-gov, #table-rep, #table-sen, #table-gov2, #table-rep2, #table-sen2, #target-gov2, #map-gov2, #voteCounts_mnsen_f, #voteCounts_mnsen_m, #voteCounts_mnsen_d, #voteCounts_mnsen_r, #voteCounts_ussen_d, #voteCounts_ussen_r, #voteCounts_mnleg_d, #voteCounts_mnleg_r, #voteCounts_usgov_d, #voteCounts_usgov_r, #voteCounts_mnsen_p, #voteCounts_ushouse_d, #voteCounts_ushouse_r, #map-sen3  {
display:none;
}

#cartoMaps-full, #cartoMaps-metro, #stateTables-full, #usTables-full{
display:none;
}

#can1, #can2{
   /* font-weight: 900;
    font-size: 18px;*/
}

.bigNum{
  /*  font-weight: 900;
    font-size: 48px;*/
}
.votes{
    font-size: 10px;
}

#container{
float:left !important;
}

.list{
width:90% !important;
padding-right:100px;
}
.dataTables_length, .dataTables_filter, .dataTables_info, .dataTables_paginate {
display:none;
}

.candidates{
float:left;
}

.percentages{
float:right;
}

#legend{
float:right;
width:100%;
font-family: Helvetica, Arial, sans-serif;
font-weight:none !important;
font-size:12px;
text-align:center;
border-bottom: 1px #999 solid;
margin: 10px 0;
}

.legend span{
line-height:100%;
margin-top:0;
display:table-cell;
font-family: Helvetica, Arial, sans-serif;
font-weight:normal !important;
}

.legend .block {
display:table-cell;
height:10px;
width:10px;
color:#808080;
  }

.leg{
margin-right:5px;
float:left;
}

#wrapper{
  width:630px;
}

#timestamp{
  padding:20px !important;
  font-family: Helvetica, Arial, sans-serif;
  font-size:12px;
}

#map-leg2 svg{
  width: 170px !important;
  height: 210px !important;
  /*background-color:green;*/
}

#balanceOfPower {
  background-color:#222222;
  padding:5px;
  font-size:.85em;
  color:#fff;
  font-family: Popular-medium;
  font-style: normal;
  font-weight: normal;
  text-align:center;
  margin-top:25px;
}

#title {
  font-family: Popular-medium;
  font-style: normal;
  font-weight: normal;
  font-size: 1.3em;
  line-height: 100%;
  color: #000000;
  margin: 10px 0;
}

.districts {
  font-family: Popular-medium;
  font-size:13px;
  font-style: normal;
  font-weight: normal;

}

.secondHR {
  clear:both;
  margin-top:20px;
}

#buttons {
  display:none;
  
}

#donutLabel-ushouse{
  text-align:center;
  position:absolute;
  top:260px;
  left: 515px;
  font-family: Helvetica, Arial, sans-serif;
  font-size:12px;
}

#donutLabel-ussenate{
  text-align:center;
  position:absolute;
  top:260px;
  left: 515px;
  font-family: Helvetica, Arial, sans-serif;
  font-size:12px;
}

#donutLabel-mnhouse{
  text-align:center;
  position:absolute;
  top:260px;
  left: 515px;
  font-family: Helvetica, Arial, sans-serif;
  font-size:12px;
}

#metroExpand{
  text-align:center;
  position:absolute;
  top:200px;
  left: 180px;
  font-family: Helvetica, Arial, sans-serif;
  font-size:12px;
}
</style>

<!--SCRIPTS-->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.9/d3.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.9/d3.min.js"></script>
<script src="//cdn.jsdelivr.net/underscorejs/1.6.0/underscore-min.map"></script>
<script src="//cdn.jsdelivr.net/underscorejs/1.6.0/underscore-min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="http://apps.startribune.com/js/nvd3-master/lib/d3.v3.js"></script>
<script src="http://apps.startribune.com/js/nvd3-master/nv.d3.js"></script>
<script src="http://apps.startribune.com/js/nvd3-master/src/utils.js"></script>
<script src="http://apps.startribune.com/js/nvd3-master/src/tooltip.js"></script>
<script src="http://apps.startribune.com/js/nvd3-master/src/models/legend.js"></script>
<script src="http://apps.startribune.com/js/nvd3-master/src/models/axis.js"></script>
<script src="http://apps.startribune.com/js/nvd3-master/src/models/pie.js"></script>
<script src="http://apps.startribune.com/js/nvd3-master/src/models/pieChart.js"></script>
<script src="http://apps.startribune.com/js/nvd3-master/examples/stream_layers.js"></script>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js" type="text/javascript"></script>
<script src="http://d3js.org/queue.v1.min.js"></script>
<script src="http://datamaps.github.com/scripts/datamaps-all.js"></script>
<script src="//cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script>
<script src="//code.jquery.com/ui/1.11.2/jquery-ui.js"></script>


<script> 
            setInterval(function() {
                  window.location.reload();
                }, 300000); 

jQuery(document).ready(function(){

  jQuery("#cartage").click(function(){
    jQuery("#stateMaps-full").slideUp("slow");
    jQuery("#stateMaps-metro").slideUp("slow");
    jQuery("#cartoMaps-full").slideDown("slow");
    jQuery("#cartoMaps-metro").slideDown("slow");
  });

  jQuery("#mappage").click(function(){
    jQuery("#stateMaps-full").slideDown("slow");
    jQuery("#stateMaps-metro").slideDown("slow");
    jQuery("#cartoMaps-full").slideUp("slow");
    jQuery("#cartoMaps-metro").slideUp("slow");
  });

jQuery("a").click(function(){
jQuery(function() {
    function count(jQuerythis){
        var current = parseInt(jQuerythis.html(), 10);

        if(current < jQuerythis.data('count')){
        jQuerythis.html(++current);
            setTimeout(function(){count(jQuerythis)}, 0.3);
        }
    }        
  jQuery(".bigNum").each(function() {
      jQuery(this).data('count', parseInt(jQuery(this).html(), 10));
      jQuery(this).html('0');
      count(jQuery(this));
  });
});
});
});


</script>
</head>

<body style="padding:0;margin:0;">

<div id="wrapper">
<div id="menu">
<div class="CSSTableGenerator">
                <table class="nav-tabs">
                    <tr class="nav-tabs">
                                                <td #if($paneNum == "1") class="active"#end width="16.6%">
                            <a href="#tab1" onclick="setVisibility('target-leg', 'none');setVisibility('map-leg', 'none');setVisibility('target-leg2', 'none');setVisibility('map-leg2', 'none');setVisibility('target-rep', 'none');setVisibility('map-rep', 'none');setVisibility('target-rep2', 'none');setVisibility('map-rep2', 'none');setVisibility('target-sen', 'none');setVisibility('map-sen', 'none');setVisibility('target-sen2', 'none');setVisibility('map-sen2', 'none');setVisibility('target-gov', 'block');setVisibility('map-gov', 'block');setVisibility('target-gov2', 'none');setVisibility('map-gov2', 'none');setVisibility('voteCounts_mnsen_f', 'none');setVisibility('voteCounts_mnsen_m', 'none');setVisibility('voteCounts_mnsen_d', 'none');setVisibility('voteCounts_mnsen_r', 'none');setVisibility('voteCounts_mngov_d', 'block');setVisibility('voteCounts_mngov_j', 'block');setVisibility('voteCounts_mngov_dv', 'block');setVisibility('voteCounts_mngov_rv', 'block');setVisibility('voteCounts_ussen_d', 'none');setVisibility('voteCounts_ussen_r', 'none');setVisibility('voteCounts_mnleg_d', 'none');setVisibility('voteCounts_mnleg_r', 'none');setVisibility('voteCounts_usgov_d', 'none');setVisibility('voteCounts_usgov_r', 'none');setVisibility('voteCounts_mnsen_p', 'none');setVisibility('voteCounts_mngov_p', 'block');setVisibility('voteCounts_ushouse_d', 'none');setVisibility('voteCounts_ushouse_r', 'none');setVisibility('map-sen3', 'none');setVisibility('daytonImg', 'block');setVisibility('frankenImg', 'none');setVisibility('mcfaddenImg', 'none');setVisibility('johnsonImg', 'block');setVisibility('map-gov3', 'block');setVisibility('balanceOfPower', 'none');setVisibility('donutLabel-mnhouse', 'none');setVisibility('donutLabel-ushouse', 'none');setVisibility('donutLabel-ussenate', 'none');setVisibility('metroExpand', 'block');redrawGraph(mngovData,0);updateIt(mngovData);">MN Governor</a>
                        </td>
                        <td #if($paneNum == "2") class="active"#end width="16.6%">
                            <a href="#tab1" onclick="setVisibility('target-leg', 'none');setVisibility('map-leg', 'none');setVisibility('target-leg2', 'none');setVisibility('map-leg2', 'none');setVisibility('target-rep', 'none');setVisibility('map-rep', 'none');setVisibility('target-rep2', 'none');setVisibility('map-rep2', 'none');setVisibility('target-sen', 'block');setVisibility('map-sen', 'block');setVisibility('target-sen2', 'none');setVisibility('map-sen2', 'none');setVisibility('target-gov', 'none');setVisibility('map-gov', 'none');setVisibility('target-gov2', 'none');setVisibility('map-gov2', 'none');setVisibility('voteCounts_mnsen_f', 'block');setVisibility('voteCounts_mnsen_m', 'block');setVisibility('voteCounts_mnsen_d', 'block');setVisibility('voteCounts_mnsen_r', 'block');setVisibility('voteCounts_mngov_d', 'none');setVisibility('voteCounts_mngov_j', 'none');setVisibility('voteCounts_mngov_dv', 'none');setVisibility('voteCounts_mngov_rv', 'none');setVisibility('voteCounts_ussen_d', 'none');setVisibility('voteCounts_ussen_r', 'none');setVisibility('voteCounts_mnleg_d', 'none');setVisibility('voteCounts_mnleg_r', 'none');setVisibility('voteCounts_usgov_d', 'none');setVisibility('voteCounts_usgov_r', 'none');setVisibility('voteCounts_mnsen_p', 'block');setVisibility('voteCounts_mngov_p', 'none');setVisibility('voteCounts_ushouse_d', 'none');setVisibility('voteCounts_ushouse_r', 'none');setVisibility('map-sen3', 'block');setVisibility('map-gov3', 'none');setVisibility('daytonImg', 'none');setVisibility('frankenImg', 'block');setVisibility('mcfaddenImg', 'block');setVisibility('johnsonImg', 'none');setVisibility('balanceOfPower', 'none');setVisibility('donutLabel-mnhouse', 'none');setVisibility('donutLabel-ushouse', 'none');setVisibility('donutLabel-ussenate', 'none');setVisibility('metroExpand', 'block');redrawGraph(mnsenData,1);updateIt(mnsenData);">MN Senator</a>
                        </td>
                        <td #if($paneNum == "3") class="active"#end width="16.6%">
                            <a href="#tab1" onclick="setVisibility('target-leg', 'block');setVisibility('map-leg', 'block');setVisibility('target-leg2', 'block');setVisibility('map-leg2', 'block');setVisibility('target-rep', 'none');setVisibility('map-rep', 'none');setVisibility('target-rep2', 'none');setVisibility('map-rep2', 'none');setVisibility('target-sen', 'none');setVisibility('map-sen', 'none');setVisibility('target-sen2', 'none');setVisibility('map-sen2', 'none');setVisibility('target-gov', 'none');setVisibility('map-gov', 'none');setVisibility('target-gov2', 'none');setVisibility('map-gov2', 'none');setVisibility('voteCounts_mnsen_f', 'none');setVisibility('voteCounts_mnsen_m', 'none');setVisibility('voteCounts_mnsen_d', 'none');setVisibility('voteCounts_mnsen_r', 'none');setVisibility('voteCounts_mngov_d', 'none');setVisibility('voteCounts_mngov_j', 'none');setVisibility('voteCounts_mngov_dv', 'none');setVisibility('voteCounts_mngov_rv', 'none');setVisibility('voteCounts_ussen_d', 'none');setVisibility('voteCounts_ussen_r', 'none');setVisibility('voteCounts_mnleg_d', 'block');setVisibility('voteCounts_mnleg_r', 'block');setVisibility('voteCounts_usgov_d', 'none');setVisibility('voteCounts_usgov_r', 'none');setVisibility('voteCounts_mnsen_p', 'none');setVisibility('voteCounts_mngov_p', 'none');setVisibility('voteCounts_ushouse_d', 'none');setVisibility('voteCounts_ushouse_r', 'none');setVisibility('map-sen3', 'none');setVisibility('map-gov3', 'none');setVisibility('daytonImg', 'none');setVisibility('frankenImg', 'none');setVisibility('mcfaddenImg', 'none');setVisibility('johnsonImg', 'none');setVisibility('balanceOfPower', 'block');setVisibility('donutLabel-mnhouse', 'block');setVisibility('donutLabel-ushouse', 'none');setVisibility('donutLabel-ussenate', 'none');setVisibility('metroExpand', 'block');redrawGraph(mnlegData,2);updateIt(mnlegData);">MN House</a>
                        </td>
                        <td #if($paneNum == "4") class="active"#end width="16.6%">
                           <a href="#tab1" onclick="setVisibility('target-leg', 'none');setVisibility('map-leg', 'none');setVisibility('target-leg2', 'none');setVisibility('map-leg2', 'none');setVisibility('target-rep', 'block');setVisibility('map-rep', 'block');setVisibility('target-rep2', 'none');setVisibility('map-rep2', 'none');setVisibility('target-sen', 'none');setVisibility('map-sen', 'none');setVisibility('target-sen2', 'none');setVisibility('map-sen2', 'none');setVisibility('target-gov', 'none');setVisibility('map-gov', 'none');setVisibility('target-gov2', 'none');setVisibility('map-gov2', 'none');setVisibility('voteCounts_mnsen_f', 'none');setVisibility('voteCounts_mnsen_m', 'none');setVisibility('voteCounts_mnsen_d', 'none');setVisibility('voteCounts_mnsen_r', 'none');setVisibility('voteCounts_mngov_d', 'none');setVisibility('voteCounts_mngov_j', 'none');setVisibility('voteCounts_mngov_dv', 'none');setVisibility('voteCounts_mngov_rv', 'none');setVisibility('voteCounts_ussen_d', 'none');setVisibility('voteCounts_ussen_r', 'none');setVisibility('voteCounts_mnleg_d', 'none');setVisibility('voteCounts_mnleg_r', 'none');setVisibility('voteCounts_usgov_d', 'none');setVisibility('voteCounts_usgov_r', 'none');setVisibility('voteCounts_mnsen_p', 'none');setVisibility('voteCounts_mngov_p', 'none');setVisibility('voteCounts_ushouse_d', 'block');setVisibility('voteCounts_ushouse_r', 'block');setVisibility('map-sen3', 'none');setVisibility('map-gov3', 'none');setVisibility('daytonImg', 'none');setVisibility('frankenImg', 'none');setVisibility('mcfaddenImg', 'none');setVisibility('johnsonImg', 'none');setVisibility('balanceOfPower', 'block');setVisibility('donutLabel-mnhouse', 'none');setVisibility('donutLabel-ushouse', 'block');setVisibility('donutLabel-ussenate', 'none');setVisibility('metroExpand', 'none');redrawGraph(ushouseData,3);updateIt(ushouseData);">U.S. House</a>
                        </td>
                        <td #if($paneNum == "5") class="active"#end width="16.6%">
                           <a href="#tab1" onclick="setVisibility('target-leg', 'none');setVisibility('map-leg', 'none');setVisibility('target-leg2', 'none');setVisibility('map-leg2', 'none');setVisibility('target-rep', 'none');setVisibility('map-rep', 'none');setVisibility('target-rep2', 'none');setVisibility('map-rep2', 'none');setVisibility('target-sen', 'none');setVisibility('map-sen', 'none');setVisibility('target-sen2', 'block');setVisibility('map-sen2', 'block');setVisibility('target-gov', 'none');setVisibility('map-gov', 'none');setVisibility('target-gov2', 'none');setVisibility('map-gov2', 'none');setVisibility('voteCounts_mnsen_f', 'none');setVisibility('voteCounts_mnsen_m', 'none');setVisibility('voteCounts_mnsen_d', 'none');setVisibility('voteCounts_mnsen_r', 'none');setVisibility('voteCounts_mngov_d', 'none');setVisibility('voteCounts_mngov_j', 'none');setVisibility('voteCounts_mngov_dv', 'none');setVisibility('voteCounts_mngov_rv', 'none');setVisibility('voteCounts_ussen_d', 'block');setVisibility('voteCounts_ussen_r', 'block');setVisibility('voteCounts_mnleg_d', 'none');setVisibility('voteCounts_mnleg_r', 'none');setVisibility('voteCounts_usgov_d', 'none');setVisibility('voteCounts_usgov_r', 'none');setVisibility('voteCounts_mnsen_p', 'none');setVisibility('voteCounts_mngov_p', 'none');setVisibility('voteCounts_ushouse_d', 'none');setVisibility('voteCounts_ushouse_r', 'none');setVisibility('map-sen3', 'none');setVisibility('map-gov3', 'none');setVisibility('daytonImg', 'none');setVisibility('frankenImg', 'none');setVisibility('mcfaddenImg', 'none');setVisibility('johnsonImg', 'none');setVisibility('balanceOfPower', 'block');setVisibility('donutLabel-mnhouse', 'none');setVisibility('donutLabel-ushouse', 'none');setVisibility('donutLabel-ussenate', 'block');setVisibility('metroExpand', 'none');redrawGraph(ussenData,4);updateIt(ussenData);">U.S. Senate</a>
                        </td>
                        <td #if($paneNum == "6") class="active"#end width="16.6%">
                           <a href="#tab1" onclick="setVisibility('target-leg', 'none');setVisibility('map-leg', 'none');setVisibility('target-leg2', 'none');setVisibility('map-leg2', 'none');setVisibility('target-rep', 'none');setVisibility('map-rep', 'none');setVisibility('target-rep2', 'none');setVisibility('map-rep2', 'none');setVisibility('target-sen', 'none');setVisibility('map-sen', 'none');setVisibility('target-sen2', 'none');setVisibility('map-sen2', 'none');setVisibility('target-gov', 'none');setVisibility('map-gov', 'none');setVisibility('target-gov2', 'block');setVisibility('map-gov2', 'block');setVisibility('voteCounts_mnsen_f', 'none');setVisibility('voteCounts_mnsen_m', 'none');setVisibility('voteCounts_mnsen_d', 'none');setVisibility('voteCounts_mnsen_r', 'none');setVisibility('voteCounts_mngov_d', 'none');setVisibility('voteCounts_mngov_j', 'none');setVisibility('voteCounts_mngov_dv', 'none');setVisibility('voteCounts_mngov_rv', 'none');setVisibility('voteCounts_ussen_d', 'none');setVisibility('voteCounts_ussen_r', 'none');setVisibility('voteCounts_mnleg_d', 'none');setVisibility('voteCounts_mnleg_r', 'none');setVisibility('voteCounts_usgov_d', 'block');setVisibility('voteCounts_usgov_r', 'block');setVisibility('voteCounts_mnsen_p', 'none');setVisibility('voteCounts_mngov_p', 'none');setVisibility('voteCounts_ushouse_d', 'none');setVisibility('voteCounts_ushouse_r', 'none');setVisibility('map-sen3', 'none');setVisibility('map-gov3', 'none');setVisibility('daytonImg', 'none');setVisibility('frankenImg', 'none');setVisibility('mcfaddenImg', 'none');setVisibility('johnsonImg', 'none');setVisibility('balanceOfPower', 'block');setVisibility('donutLabel-mnhouse', 'none');setVisibility('donutLabel-ushouse', 'none');setVisibility('donutLabel-ussenate', 'none');setVisibility('metroExpand', 'none');redrawGraph(usgovData,5);updateIt(usgovData);">Gubernatorial</a>
                        </td>
                    </tr>
                </table>
            </div>
</div>
<div id="title" style="padding:40px 0 0 10px">GOVERNOR OF MINNESOTA</div>
<section id="tab1" class="tab-content">
<div id="buttons">
  <label value="small">
    <input type="radio" name="pickView" id="map-select" checked/>
    <img src="http://stmedia.startribune.com/images/mnview.png" id="mappage">
  </label>
  
  <label>
    <input type="radio" name="pickView" value="big" id="carto-select"  />
    <img src="http://stmedia.startribune.com/images/blockview.png " id="cartage">
  </label>

  
</div>

<div id="container" ><!-- style="background-color:red;" -->
  <div id="row">

    <div id="left" style="padding-left:10px;">
               <div id="cartoMaps-full" ><!-- style="background-color:aqua;" -->
      <div id="target-leg"></div>
      <div id="target-rep"></div>
      <div id="target-sen"></div>
      <div id="target-gov"></div>
      <div id="target-sen2"></div>
      <div id="target-gov2"></div>
               </div>
               <div id="stateMaps-full" ><!-- style="background-color:beige;" -->
                <div id="map-leg"><svg width="200" height="225"></svg></div>
                <div id="map-rep"><svg width="200" height="225"></svg></div>
                <div id="map-sen"><svg width="200" height="225"></svg></div>
                <div id="map-gov"><svg width="200" height="225"></svg></div>
                 <div id="map-sen2"><svg width="150" height="160"></svg></div>
                <div id="map-gov2"><svg width="150" height="160"></svg></div>
               </div>
               <div id="stateTables-full">
                <div id="table-leg" class="list">
<table id="mnleg-table" class="display" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th>Race</th>
                <th>DFL</th>
                <th>Percentage</th>
                <th>GOP</th>
                <th>Percentage</th>
            </tr>
        </thead>
    </table>
</div>
                <div id="table-rep" class="list">
<table id="mnrep-table" class="display" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th>Race</th>
                <th>DFL</th>
                <th>Percentage</th>
                <th>GOP</th>
                <th>Percentage</th>
            </tr>
        </thead>
    </table>
                </div>
                <div id="table-sen" class="list">
<table id="mnsen-table" class="display" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th>Race</th>
                <th>DFL</th>
                <th>Percentage</th>
                <th>GOP</th>
                <th>Percentage</th>
            </tr>
        </thead>
    </table>
                </div>
                <div id="table-gov" class="list">
<table id="mngov-table" class="display" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th>Race</th>
                <th>DFL</th>
                <th>Percentage</th>
                <th>GOP</th>
                <th>Percentage</th>
            </tr>
        </thead>
    </table>
                </div>
               </div>
    </div>

    <div id="middle" style="float:left;">
               <div id="cartoMaps-metro">
      <div id="target-leg2"></div>
      <div id="target-rep2"></div>
  
               </div>
               <div id="stateMaps-metro">
                <div id="map-leg2"><svg width="170" height="170"></svg></div>
                <div id="map-sen3"><svg width="150" height="160"></svg></div>
                <div id="map-gov3"><svg width="150" height="160"></svg></div>
                <div id="map-rep2"><svg width="150" height="160"></svg></div>
               
               </div>
               <div id="usTables-full">
                <div id="table-leg2" class="list">
<table id="usleg-table" class="display" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th>Race</th>
                <th>DFL</th>
                <th>Percentage</th>
                <th>GOP</th>
                <th>Percentage</th>
            </tr>
        </thead>
    </table>
                </div>
                <div id="table-rep2" class="list">
<table id="usrep-table" class="display" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th>Race</th>
                <th>DFL</th>
                <th>Percentage</th>
                <th>GOP</th>
                <th>Percentage</th>
            </tr>
        </thead>
    </table>
                </div>
                <div id="table-sen2" class="list">

                </div>
               </div>
    </div>


<div id="right" style="float:right;">
      <div id="row">
          <div id="balanceOfPower" style="display:none;">BALANCE OF POWER</div>
          <div id="left1" style="width:86px;float:left;text-align: center;">
            
                  <img id="daytonImg" src="http://stmedia.startribune.com/images/markDayton2014.png">
                  <img id="frankenImg" style="display:none" src="http://stmedia.startribune.com/images/alFranken_W2014.png">
                      <div class="candidateName" id="can1">DAYTON - D&nbsp;</div>
                      <div id="voteCounts_mnsen_f" class="bigNum voteShare"></div>
                      <div id="voteCounts_mnsen_d" class="votes"></div>
                      <div id="voteCounts_mngov_d" class="bigNum voteShare"></div>
          <div id="voteCounts_mngov_dv" class="votes"></div>
          <div id="voteCounts_ussen_d" class="bigNum voteShare"></div>
          <div id="voteCounts_mnleg_d" class="bigNum voteShare"></div>
          <div id="voteCounts_usgov_d" class="bigNum voteShare"></div>
          <div id="voteCounts_ushouse_d" class="bigNum voteShare"></div>
          </div>

          

          <div id="right1" style="width:86px;float:left;text-align: center;">
            
                  <img id="johnsonImg" src="http://stmedia.startribune.com/images/jeffJohnson2014.png">
                  <img id="mcfaddenImg" style="display:none" src="http://stmedia.startribune.com/images/mikeMcFadden2014.png">
                  <div class="candidateName" id="can2">JOHNSON - R&nbsp;</div>
                  <div id="voteCounts_mnsen_m" class="bigNum voteShare"></div>
                  <div id="voteCounts_mnsen_r" class="votes"></div>
          <div id="voteCounts_mngov_j" class="bigNum voteShare"></div>
          <div id="voteCounts_mngov_rv" class="votes"></div>
          <div id="voteCounts_ussen_r" class="bigNum voteShare"></div>
          <div id="voteCounts_mnleg_r" class="bigNum voteShare"></div>
          <div id="voteCounts_usgov_r" class="bigNum voteShare"></div>
          <div id="voteCounts_ushouse_r" class="bigNum voteShare"></div>
          </div>
          <br style="clear:both" />
          <!-- <div id="middle" style="width:175px;"> -->
            <div id="tracker" class="tracking"><svg style="height:100px;width:175px;"><!-- background-color:grey --></svg></div>
         <!--  </div> -->
</div>

</div>
</div>
</div>



<div id='legend'>
  <nav class='legend clearfix'>
<span class="block leg" style='background:#eee;'></span> <span class="leg">no results</span>
<span class="block leg"  style='background:#ddd;'></span> <span class="leg">toss-up |</span> 
<span class="leg" id="d-can" style="padding-right:5px;">DAYTON</span>
<span class="block leg"  style='background:#8493c8;'></span> <span class="leg">leaning</span>
<span class="block leg"  style='background:#506fb3;'></span> <span class="leg">safe | </span>
<span class="block leg"  style='background:#666;'></span> <span class="leg">ind | </span>
<span class="leg" id="r-can" style="padding-right:5px;">JOHNSON</span>
<span class="block leg"  style='background:#f48072;'></span> <span class="leg">leaning</span>
<span class="block leg"  style='background:#d46354;'></span> <span class="leg">safe</span>
</div>

<div style="padding-top:15px; font-size:10px;font-family: Helvetica, Arial, sans-serif;color:#999;">Map is colored for areas with more than 20 percent of precincts reporting. Safe races are those either with a 20 point or higher margin or those with all precincts reporting where a winner has been declared.</div>

<div id='donutLabel-mnhouse' style='display:none;'>68 seats<br>for majority</div>
<div id='donutLabel-ushouse' style='display:none;'>218 seats<br>for national<br>majority</div>
<div id='donutLabel-ussenate' style='display:none;'>51 seats<br>for majority</div>

<div id='metroExpand'>Expanded<br>metro area</div>

<div id="timestamp">Last updated:</div>

<div id="voteCounts_mnsen_p">Precincts Reporting</div>
<div id="voteCounts_mngov_p">Precincts Reporting</div>

</section>

</div>

<script>
//MENU STUFF
function setVisibility(id, visibility) {
document.getElementById(id).style.display = visibility;
}
  jQuery(document).ready(function() {
    jQuery('.nav-tabs > td > a').click(function(event){
    event.preventDefault();//stop browser to take action for clicked anchor

    //get displaying tab content jQuery selector
    var active_tab_selector = jQuery('.nav-tabs > td.active > a').attr('href');         
 
    //find actived navigation and remove 'active' css
    var actived_nav = jQuery('.nav-tabs > td.active');
    actived_nav.removeClass('active');
 
    //add 'active' css into clicked navigation
    jQuery(this).parents('td').addClass('active');
 
    //hide displaying tab content
    jQuery(active_tab_selector).removeClass('active');
    jQuery(active_tab_selector).addClass('hide');
 
    //show target tab content
    var target_tab_selector = jQuery(this).attr('href');
    jQuery(target_tab_selector).removeClass('hide');
    jQuery(target_tab_selector).addClass('active');
       });
    });
</script>


<script>
//MN U.S. REPRESENTATIVES LIVE MAPS

jQuery.getJSON('http://data-layer-elections.startribune.com/api/v1/cached/summary/mn-ushouse/', function(json2) {


jQuery( "#target-rep" ).empty();

//LOAD DATA AND COLOR VARIABLES
var time_updated = new Date(json2.last_update_timestamp);
var timeOptions = {
     hour: "2-digit", minute: "2-digit"
};
console.log(time_updated + "1HEY!!");
var district_mnrep = [];
var precinct_rep_mnrep = []
var total_prec_mnrep = [];
var percent_prec_mnrep = [];
var candidate1_mnrep = [];
var candidate2_mnrep = []; 
var party1_mnrep = [];
var party2_mnrep = []
var votes_count1_mnrep = [];
var votes_count2_mnrep = [];
var votes_percent1_mnrep = [];
var votes_percent2_mnrep = [];
var in_status1_mnrep = [];
var in_status2_mnrep = [];
var is_winner1_mnrep = [];
var is_winner2_mnrep = [];
// var time_updated = time_updated.getHours() + ':' + time_updated.getMinutes() + ':' + time_updated.getSeconds();

console.log("As of " + time_updated.toLocaleTimeString("en-us", timeOptions) + " there are HEY!!");

dfl_safe = "#506fb3";
gop_safe = "#d46354";
dfl_lean = "#8493c8";
gop_lean = "#f48072";
basecolor = "#ddd";

for ( i = 0; i < 8; i++ ) {
district_mnrep[i] = json2.results[0]['items'][0]['items'][i]['header'];
precinct_rep_mnrep[i] = Number(json2.results[0]['items'][0]['items'][i]['precincts_reporting']);
total_prec_mnrep[i] = Number(json2.results[0]['items'][0]['items'][i]['total_precincts']);
percent_prec_mnrep[i] = Number(json2.results[0]['items'][0]['items'][i]['percent_of_precincts']);

candidate1_mnrep[i] = json2.results[0]['items'][0]['items'][i]['items'][0]['first_name']+ ' ' + json2.results[0]['items'][0]['items'][i]['items'][0]['last_name'];
candidate2_mnrep[i] = json2.results[0]['items'][0]['items'][i]['items'][1]['first_name']+ ' ' + json2.results[0]['items'][0]['items'][i]['items'][1]['last_name'];
party1_mnrep[i] = json2.results[0]['items'][0]['items'][i]['items'][0]['party_abbreviation'];
party2_mnrep[i] = json2.results[0]['items'][0]['items'][i]['items'][1]['party_abbreviation'];
votes_count1_mnrep[i] = Number(json2.results[0]['items'][0]['items'][i]['items'][0]['votes']);
votes_count2_mnrep[i] = Number(json2.results[0]['items'][0]['items'][i]['items'][1]['votes']);
votes_percent1_mnrep[i] = Number(json2.results[0]['items'][0]['items'][i]['items'][0]['percent_of_votes']);
votes_percent2_mnrep[i] = Number(json2.results[0]['items'][0]['items'][i]['items'][1]['percent_of_votes']);
in_status1_mnrep[i] = Boolean(json2.results[0]['items'][0]['items'][i]['items'][0]['is_incumbent']);
in_status2_mnrep[i] = Boolean(json2.results[0]['items'][0]['items'][i]['items'][1]['is_incumbent']);
is_winner1_mnrep[i] = Boolean(json2.results[0]['items'][0]['items'][i]['items'][0]['is_winner']);
is_winner2_mnrep[i] = Boolean(json2.results[0]['items'][0]['items'][i]['items'][1]['is_winner']);

          
}

// var projection6 = d3.geo.mercator().scale([17000]).center([-87.9565,45.6524]);
var projection6 = d3.geo.mercator().scale([9200]).center([-78.4500,42.6000]);
var path6 = d3.geo.path().projection(projection6);
var svg6 = d3.select("#map-rep svg");

//MN U.S. REPRESENTATIVE MAP
d3.json("http://www.startribune.com/includes/usleg.json", function(json) {
        svg6.selectAll("path")
           .data(json.features)
           .enter()
           .append("path")
           .attr("d", path6)
           .attr("stroke-width", .5)
           .style("stroke", "white")
           .style("fill", function(d) {

         var j = Number(d.properties.NAMELSAD) - 1;
                if (percent_prec_mnrep[j] > 20){
                     if (votes_percent1_mnrep[j] > votes_percent2_mnrep[j] && percent_prec_mnrep[j] == 100 || (votes_percent1_mnrep[j] - votes_percent2_mnrep[j]) > 20) {
                                  if (party1_mnrep[j] == 'D' ) {
                                     return dfl_safe;
                                      }
                                  else if (party1_mnrep[j] == 'R') {
                                     return gop_safe;
                                      }
                                }
                     if (votes_percent1_mnrep[j] < votes_percent2_mnrep[j] && percent_prec_mnrep[j] == 100 || (votes_percent2_mnrep[j] - votes_percent1_mnrep[j]) > 20) {
                                  if (party2_mnrep[j] == 'D' ) {
                                     return dfl_safe;
                                      }
                                  else if (party2_mnrep[j] == 'R' ) {
                                     return gop_safe;
                                      }
                                }
                     if (votes_percent1_mnrep[j] > votes_percent2_mnrep[j] && percent_prec_mnrep[j] < 100) {
                                  if (party1_mnrep[j] == 'D' ) {
                                     return dfl_lean;
                                      }
                                  else if (party1_mnrep[j] == 'R') {
                                     return gop_lean;
                                      }
                                }
                     if (votes_percent1_mnrep[j] < votes_percent2_mnrep[j] && percent_prec_mnrep[j] < 100) {
                                  if (party2_mnrep[j] == 'D' ) {
                                     return dfl_lean;
                                      }
                                  else if (party2_mnrep[j] == 'R' ) {
                                     return gop_lean;
                                      }
                                }

                      else {
                                 return basecolor;
                                }
}
                      else {
                                 return basecolor;
                                }

          })
             .call(d3.helper.tooltip(
        function(d){
          var j = Number(d.properties.NAMELSAD) - 1;

          if (in_status1_mnrep[j] == true && is_winner1_mnrep[j] == true){
          return "<div class='districts'><b>Congressional District "+ d.properties.NAMELSAD+ "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate1_mnrep[j] + " (" + party1_mnrep[j] + ")* </b></div><div class='percentages'>" + votes_percent1_mnrep[j] + "%</div><br /><div class='candidates'>" + candidate2_mnrep[j] + " (" + party2_mnrep[j] + ")</div><div class='percentages'>" + votes_percent2_mnrep[j] + "%</div><hr style='clear:both'><div class='candidates'>" + "Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_rep_mnrep[j] / total_prec_mnrep[j]) * 100) + "%</div>";
    }
          else if (in_status2_mnrep[j] == true && is_winner2_mnrep[j] == true){ 
          return "<div class='districts'><b>Congressional District "+ d.properties.NAMELSAD+ "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate2_mnrep[j] + " (" + party2_mnrep[j] + ")*</b></div><div class='percentages'>" + votes_percent2_mnrep[j] + "%</div><br /><div class='candidates'>" + candidate1_mnrep[j] + " (" + party1_mnrep[j] + ")</div><div class='percentages'>" + votes_percent1_mnrep[j] + "%</div><hr style='clear:both'><div class='candidates'>" + "Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_rep_mnrep[j] / total_prec_mnrep[j]) * 100) + "%</div>";
                }
          else if (in_status1_mnrep[j] == true && is_winner1_mnrep[j] == false){
          return "<div class='districts'><b>Congressional District "+ d.properties.NAMELSAD+ "</b></div><hr><div class='candidates'><b>" + candidate1_mnrep[j] + " (" + party1_mnrep[j] + ")*</b></div><div class='percentages'>" + votes_percent1_mnrep[j] + "%</div><br /><div class='candidates'>" + candidate2_mnrep[j] + " (" + party2_mnrep[j] + ")</div><div class='percentages'>" + votes_percent2_mnrep[j] + "%</div><hr style='clear:both'><div class='candidates'>" + "Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_rep_mnrep[j] / total_prec_mnrep[j]) * 100) + "%</div>";
    }
          else if (in_status2_mnrep[j] == true && is_winner2_mnrep[j] == false){ 
          return "<div class='districts'><b>Congressional District "+ d.properties.NAMELSAD+ "</b></div><hr><div class='candidates'><b>" + candidate2_mnrep[j] + " (" + party2_mnrep[j] + ")*</b></div><div class='percentages'>" + votes_percent2_mnrep[j] + "%</div><br /><div class='candidates'>" + candidate1_mnrep[j] + " (" + party1_mnrep[j] + ")</div><div class='percentages'>" + votes_percent1_mnrep[j] + "%</div><hr style='clear:both'><div class='candidates'>" + "Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_rep_mnrep[j] / total_prec_mnrep[j]) * 100) + "%</div>";
    }
          else if  (in_status1_mnrep[j] == false && in_status2_mnrep[j] == false && is_winner1_mnrep[j] == true) {
          return "<div class='districts'><b>Congressional District "+ d.properties.NAMELSAD+ "</b></div><hr><div class='candidates'>&#10004;" + candidate1_mnrep[j] + " (" + party1_mnrep[j] + ") </div><div class='percentages'>" + votes_percent1_mnrep[j] + "%</div><br /><div class='candidates'>" + candidate2_mnrep[j] + " (" + party2_mnrep[j] + ")</div><div class='percentages'>" + votes_percent2_mnrep[j] + "%</div><hr style='clear:both'><div class='candidates'>" + "Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_rep_mnrep[j] / total_prec_mnrep[j]) * 100) + "%</div>";
                }
          else if  (in_status1_mnrep[j] == false && in_status2_mnrep[j] == false && is_winner2_mnrep[j] == true) {
          return "<div class='districts'><b>Congressional District "+ d.properties.NAMELSAD+ "</b></div><hr><div class='candidates'>" + candidate1_mnrep[j] + " (" + party1_mnrep[j] + ")</div><div class='percentages'>" + votes_percent1_mnrep[j] + "%</div><br /><div class='candidates'>&#10004;" + candidate2_mnrep[j] + " (" + party2_mnrep[j] + ")</div><div class='percentages'>" + votes_percent2_mnrep[j] + "%</div><hr style='clear:both'><div class='candidates'>" + "Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_rep_mnrep[j] / total_prec_mnrep[j]) * 100) + "%</div>";
                }
          else {
          return "<div class='districts'><b>Congressional District "+ d.properties.NAMELSAD+ "</b></div><hr><div class='candidates'>" + candidate1_mnrep[j] + " (" + party1_mnrep[j] + ")</div><div class='percentages'>" + votes_percent1_mnrep[j] + "%</div><br /><div class='candidates'>" + candidate2_mnrep[j] + " (" + party2_mnrep[j] + ") </div><div class='percentages'>" + votes_percent2_mnrep[j] + "%</div><hr style='clear:both'><div class='candidates'>" + "Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_rep_mnrep[j] / total_prec_mnrep[j]) * 100) + "%</div>";
                }
                      }
        ));
    });

//MN U.S. REPRESENTATIVE CARTOGRAM

var cartogram4 = {
    margin: {
        top: 25,
        right: 0,
        bottom: 0,
        left: 10
    },

    selector: '#target-rep',

    init: function() {
        var self = this;

        self.jQueryel = jQuery(self.selector);

        self.width = 300 - self.margin.left - self.margin.right;
        self.height = 300 - self.margin.top - self.margin.bottom;

        self.svg = d3.select(self.selector).append('svg')
            .attr('height', self.height + self.margin.top + self.margin.bottom)
            .attr('width', self.width + self.margin.left + self.margin.right)

        self.state_size = self.width / 12;
        self.state_padding = 2;

        self.map = self.svg.append('g')
            .attr('transform', 'translate(' + self.margin.left + ','
                  + self.margin.top + ')')

        self.drawMap();
    },

    drawMap: function() {
        var self = this;

        var states = self.map.selectAll('.states')
            .data(self.state_pos_c1)
            .enter().append('g')
            .attr('class', 'state-groups');

        var state = states.append('rect')
            .attr('id', function(d) {
                return d.state_postal + "-mnrep";
            })
            .attr('class', 'state')
            .attr('class', function(d) {
                     var j = d.color_value;
                if (percent_prec_mnrep[j] > 20){
                     if (votes_percent1_mnrep[j] > votes_percent2_mnrep[j] && percent_prec_mnrep[j] == 100) {
                                  if (party1_mnrep[j] == 'D') {
                                     return 'gop_safe';
                                      }
                                  else if (party1_mnrep[j] == 'R') {
                                     return 'dfl_safe';
                                      }
                                }
                     if (votes_percent1_mnrep[j] < votes_percent2_mnrep[j] && percent_prec_mnrep[j] == 100) {
                                  if (party2_mnrep[j] == 'D' ) {
                                     return 'gop_safe';
                                      }
                                  else if (party2_mnrep[j] == 'R' ) {
                                     return 'dfl_safe';
                                      }
                                }
                     if (votes_percent1_mnrep[j] > votes_percent2_mnrep[j] && percent_prec_mnrep[j] < 100) {
                                  if (party2_mnrep[j] == 'D' ) {
                                     return 'gop_lean';
                                      }
                                  else if (party2_mnrep[j] == 'R' ) {
                                     return 'dfl_lean';
                                      }
                                }
                     if (votes_percent1_mnrep[j] < votes_percent2_mnrep[j] && percent_prec_mnrep[j] < 100) {
                                  if (party2_mnrep[j] == 'D' ) {
                                     return 'gop_lean';
                                      }
                                  else if (party2_mnrep[j] == 'R' ) {
                                     return 'dfl_lean';
                                      }
                                }
}
                     else {
                                 return 'nothing';
                                }
            })
            .attr('rx', 2)
            .attr('ry', 2)
            .attr('x', function(d) {
                return d.column * (self.state_size + self.state_padding);
            })
            .attr('y', function(d) {
                return d.row * (self.state_size + self.state_padding);
            })
            .attr('width', self.state_size)
            .attr('height', self.state_size)
             .call(d3.helper.tooltip(
        function(d){
          var j = d.color_value;

          if (in_status1_mnrep[j] == true && is_winner1_mnrep[j] == true){
          return "<div class='districts'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate1_mnrep[j] + " (" + party1_mnrep[j] + ")* </b></div><div class='percentages'>" + votes_percent1_mnrep[j] + "%</div><br /><div class='candidates'>" + candidate2_mnrep[j] + " (" + party2_mnrep[j] + ")</div><div class='percentages'>" + votes_percent2_mnrep[j] + "%</div><hr style='clear:both'><div class='candidates'>" + "Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_rep_mnrep[j] / total_prec_mnrep[j]) * 100) + "%</div>";
    }
          else if (in_status2_mnrep[j] == true && is_winner2_mnrep[j] == true){ 
          return "<div class='districts'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate2_mnrep[j] + " (" + party2_mnrep[j] + ")*</b></div><div class='percentages'>" + votes_percent2_mnrep[j] + "%</div><br /><div class='candidates'>" + candidate1_mnrep[j] + " (" + party1_mnrep[j] + ")</div><div class='percentages'>" + votes_percent1_mnrep[j] + "%</div><hr style='clear:both'><div class='candidates'>" + "Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_rep_mnrep[j] / total_prec_mnrep[j]) * 100) + "%</div>";
                }
          else if (in_status1_mnrep[j] == true && is_winner1_mnrep[j] == false){
          return "<div class='districts'><b>"+ d.state_full + "</b></div><hr><div class='candidates'><b>" + candidate1_mnrep[j] + " (" + party1_mnrep[j] + ")*</b></div><div class='percentages'>" + votes_percent1_mnrep[j] + "%</div><br /><div class='candidates'>" + candidate2_mnrep[j] + " (" + party2_mnrep[j] + ")</div><div class='percentages'>" + votes_percent2_mnrep[j] + "%</div><hr style='clear:both'><div class='candidates'>" + "Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_rep_mnrep[j] / total_prec_mnrep[j]) * 100) + "%</div>";
    }
          else if (in_status2_mnrep[j] == true && is_winner2_mnrep[j] == false){ 
          return "<div class='districts'><b>"+ d.state_full + "</b></div><hr><div class='candidates'><b>" + candidate2_mnrep[j] + " (" + party2_mnrep[j] + ")*</b></div><div class='percentages'>" + votes_percent2_mnrep[j] + "%</div><br /><div class='candidates'>" + candidate1_mnrep[j] + " (" + party1_mnrep[j] + ")</div><div class='percentages'>" + votes_percent1_mnrep[j] + "%</div><hr style='clear:both'><div class='candidates'>" + "Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_rep_mnrep[j] / total_prec_mnrep[j]) * 100) + "%</div>";
    }
          else if  (in_status1_mnrep[j] == false && in_status2_mnrep[j] == false && is_winner1_mnrep[j] == true) {
          return "<div class='districts'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;" + candidate1_mnrep[j] + " (" + party1_mnrep[j] + ") </div><div class='percentages'>" + votes_percent1_mnrep[j] + "%</div><br /><div class='candidates'>" + candidate2_mnrep[j] + " (" + party2_mnrep[j] + ")</div><div class='percentages'>" + votes_percent2_mnrep[j] + "%</div><hr style='clear:both'><div class='candidates'>" + "Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_rep_mnrep[j] / total_prec_mnrep[j]) * 100) + "%</div>";
                }
          else if  (in_status1_mnrep[j] == false && in_status2_mnrep[j] == false && is_winner2_mnrep[j] == true) {
          return "<div class='districts'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>" + candidate1_mnrep[j] + " (" + party1_mnrep[j] + ")</div><div class='percentages'>" + votes_percent1_mnrep[j] + "%</div><br /><div class='candidates'>&#10004;" + candidate2_mnrep[j] + " (" + party2_mnrep[j] + ")</div><div class='percentages'>" + votes_percent2_mnrep[j] + "%</div><hr style='clear:both'><div class='candidates'>" + "Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_rep_mnrep[j] / total_prec_mnrep[j]) * 100) + "%</div>";
                }
          else {
          return "<div class='districts'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>" + candidate1_mnrep[j] + " (" + party1_mnrep[j] + ")</div><div class='percentages'>" + votes_percent1_mnrep[j] + "%</div><br /><div class='candidates'>" + candidate2_mnrep[j] + " (" + party2_mnrep[j] + ") </div><div class='percentages'>" + votes_percent2_mnrep[j] + "%</div><hr style='clear:both'><div class='candidates'>" + "Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_rep_mnrep[j] / total_prec_mnrep[j]) * 100) + "%</div>";
                }
                      }
        ));

        var text = states.append('text')
            .attr('class', 'state-label')
            .attr('dominant-baseline', 'central')
            .attr('x', function(d) {
                return (d.column * (self.state_size + self.state_padding))
                        + self.state_size / 2; })
            .attr('y', function(d) {
                return (d.row * (self.state_size + self.state_padding))
                    + self.state_size / 2; })
            .style('text-anchor', 'middle')
          //  .text(function(d) {
          //      return d.state_postal;
          //  });
    },

    state_pos_c1: [{'state_full':'Congressional District 7','state_postal':'7','row':0,'column':0,'color_value':6},
        {'state_full':'Congressional District 8','state_postal':'8','row':0,'column':1,'color_value':7},
        {'state_full':'Congressional District 6','state_postal':'6','row':1,'column':0,'color_value':5},
        {'state_full':'Congressional District 3','state_postal':'3','row':1,'column':1,'color_value':2},
        {'state_full':'Congressional District 5','state_postal':'5','row':2,'column':0,'color_value':4},
        {'state_full':'Congressional District 4','state_postal':'4','row':2,'column':1,'color_value':3},
        {'state_full':'Congressional District 1','state_postal':'1','row':3,'column':0,'color_value':0},
        {'state_full':'Congressional District 2','state_postal':'2','row':3,'column':1,'color_value':1}
        ]
};

jQuery(document).ready(function() {
   cartogram4.init();
  if (jQuery("#cartoMaps-full").is(":visible") ){
  // jQuery( "#cartoMaps-full" ).effect( "shake" );
  } else {
  // jQuery( "#stateMaps-full" ).effect( "shake" );
  }
});

jQuery("#timestamp").html("Last updated: " + time_updated);

           // });

 });
</script>

<script>
//US GOVERNOR LIVE MAP

jQuery.getJSON('http://data-layer-elections.startribune.com/api/v1/cached/summary/all-governor/', function(json2) {
          

jQuery( "#target-gov2" ).empty();

//LOAD DATA AND COLOR VARIABLES
var state_usgov = [];
var precinct_usgov = [];
var total_prec_usgov = [];
var percent_prec_usgov = [];
var candidate1_usgov = [];
var candidate2_usgov = [];
var party1_usgov = [];
var party2_usgov = [];
var votes_count1_usgov = [];
var votes_count2_usgov = [];
var votes_percent1_usgov = [];
var votes_percent2_usgov = [];
var in_status1_usgov = [];
var in_status2_usgov = [];
var is_winner1_usgov = [];
var is_winner2_usgov = [];
var d_safe_count_usgov = 7;
var r_safe_count_usgov = 7;
var d_lean_count_usgov = 0;
var r_lean_count_usgov = 0;
var toss_count_usgov = 0;

dfl_safe = "#506fb3";
gop_safe = "#d46354";
dfl_lean = "#8493c8";
gop_lean = "#f48072";
basecolor = "#ddd";

           for ( i = 0; i < 36; i++ ) {
state_usgov[i+1] = json2.results[i]['header'];
precinct_usgov[i+1] = Number(json2.results[i]['items'][0]['items'][0]['precincts_reporting']);
total_prec_usgov[i+1] = Number(json2.results[i]['items'][0]['items'][0]['total_precincts']);
percent_prec_usgov[i+1] = Number(json2.results[i]['items'][0]['items'][0]['percent_of_precincts']);
candidate1_usgov[i+1] = json2.results[i]['items'][0]['items'][0]['items'][0]['first_name']+ ' ' + json2.results[i]['items'][0]['items'][0]['items'][0]['last_name']; //GOT IT
candidate2_usgov[i+1] = json2.results[i]['items'][0]['items'][0]['items'][1]['first_name']+ ' ' + json2.results[i]['items'][0]['items'][0]['items'][1]['last_name']; //GOT IT
party1_usgov[i+1] = json2.results[i]['items'][0]['items'][0]['items'][0]['party_abbreviation'];
party2_usgov[i+1] = json2.results[i]['items'][0]['items'][0]['items'][1]['party_abbreviation'];
votes_count1_usgov[i+1] = Number(json2.results[i]['items'][0]['items'][0]['items'][0]['votes']);
votes_count2_usgov[i+1] = Number(json2.results[i]['items'][0]['items'][0]['items'][1]['votes']);
votes_percent1_usgov[i+1] = Number(json2.results[i]['items'][0]['items'][0]['items'][0]['percent_of_votes']);
votes_percent2_usgov[i+1] = Number(json2.results[i]['items'][0]['items'][0]['items'][1]['percent_of_votes']);
in_status1_usgov[i+1] = Boolean(json2.results[i]['items'][0]['items'][0]['items'][0]['is_incumbent']);
in_status2_usgov[i+1] = Boolean(json2.results[i]['items'][0]['items'][0]['items'][1]['is_incumbent']);
is_winner1_usgov[i+1] = Boolean(json2.results[i]['items'][0]['items'][0]['items'][0]['is_winner']);
is_winner2_usgov[i+1] = Boolean(json2.results[i]['items'][0]['items'][0]['items'][1]['is_winner']);
  if (is_winner1_usgov[i+1] == true){
              if  (party1_usgov[i+1] == 'D'){
    d_safe_count_usgov++;
                  }
              else if (party1_usgov[i+1] == 'R'){
    r_safe_count_usgov++;
                  }
             }
  else if (is_winner2_usgov[i+1] == true){
        if  (party2_usgov[i+1] == 'D'){
    d_safe_count_usgov++;
                  }
              else if (party2_usgov[i+1] == 'R'){
    r_safe_count_usgov++;
                  }
             }
  else if (votes_percent1_usgov[i+1] > votes_percent2_usgov[i+1] && percent_prec_usgov[i+1] < 85){
              if  (party1_usgov[i+1] == 'D'){
    d_lean_count_usgov++;
                  }
              else if (party1_usgov[i+1] == 'R'){
    r_lean_count_usgov++;
                  }
             }
  else if (votes_percent1_usgov[i+1] < votes_percent2_usgov[i+1] && percent_prec_usgov[i+1] < 85){
        if  (party2_usgov[i+1] == 'D'){
    d_lean_count_usgov++;
                  }
              else if (party2_usgov[i+1] == 'R'){
    r_lean_count_usgov++;
                  }
             }
        else {toss_count_usgov++;}
}

var results_usgov = [];

results_usgov[0] = d_safe_count_usgov;
results_usgov[1] = d_lean_count_usgov;
results_usgov[2] = toss_count_usgov;
results_usgov[3] = r_lean_count_usgov;
results_usgov[4] = r_safe_count_usgov;

var results_json_usgov = JSON.stringify(results_usgov);

var projection5 = d3.geo.albersUsa().scale(400).translate([210, 100]);
var path5 = d3.geo.path().projection(projection5);
var svg5 = d3.select("#map-gov2 svg");

//US GOV MAP
d3.json("http://www.startribune.com/includes/states_gov.json", function(json) {
        svg5.selectAll("path")
           .data(json.features)
           .enter()
           .append("path")
           .attr("d", path5)
           .attr("stroke-width", .5)
           .style("stroke", "white")
           .text(function(d) { return d.properties.DISTRICT; })
           .style("fill", function(d) {

         var j = Number(d.properties.INDEX);
                if (percent_prec_usgov[j] > 20){
                     if (votes_percent1_usgov[j] > votes_percent2_usgov[j] && percent_prec_usgov[j] == 100 || (votes_percent1_usgov[j] - votes_percent2_usgov[j]) > 20) {
                                  if (party1_usgov[j] == 'D' ) {
                                     return dfl_safe;
                                      }
                                  else if (party1_usgov[j] == 'R') {
                                     return gop_safe;
                                      }
                                }
                     if (votes_percent1_usgov[j] < votes_percent2_usgov[j] && percent_prec_usgov[j] == 100 || (votes_percent2_usgov[j] - votes_percent1_usgov[j]) > 20)  {
                                  if (party2_usgov[j] == 'D' ) {
                                     return dfl_safe;
                                      }
                                  else if (party2_usgov[j] == 'R' ) {
                                     return gop_safe;
                                      }
                                }
                     if (votes_percent1_usgov[j] > votes_percent2_usgov[j] && percent_prec_usgov[j] < 100) {
                                  if (party1_usgov[j] == 'D' ) {
                                     return dfl_lean;
                                      }
                                  else if (party1_usgov[j] == 'R') {
                                     return gop_lean;
                                      }
                                }
                     if (votes_percent1_usgov[j] < votes_percent2_usgov[j] && percent_prec_usgov[j] < 100) {
                                  if (party2_usgov[j] == 'D' ) {
                                     return dfl_lean;
                                      }
                                  else if (party2_usgov[j] == 'R' ) {
                                     return gop_lean;
                                      }
                                }

                      else {
                                 return basecolor;
                                }
}
                      else {
                                 return basecolor;
                                }

          })
             .call(d3.helper.tooltip(
        function(d){
          var j = Number(d.properties.INDEX);

          if (candidate1_usgov[j] == null){
            return "<div class='districts'><b>" + d.properties.NAME + "</b></div><hr>No races";
               }
          else {
          if (in_status1_usgov[j] == true && is_winner1_usgov[j] == true){
          return "<div class='districts'><b>"+ state_usgov[j] + "</b></div><hr><div class='candidates'><b>&#10004;" + candidate1_usgov[j] + " (" + party1_usgov[j] + ")*</b></div><div class='percentages'>" + votes_percent1_usgov[j] + "%</div><br /><div class='candidates'>" + candidate2_usgov[j] + " (" + party2_usgov[j] + ")</div><div class='percentages'>" + votes_percent2_usgov[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_usgov[j] / total_prec_usgov[j]) * 100) + "%</div>";
    }
          else if (in_status2_usgov[j] == true && is_winner2_usgov[j] == true){ 
          return "<div class='districts'><b>"+ state_usgov[j] + "</b></div><hr><div class='candidates'><b>&#10004;" + candidate2_usgov[j] + " (" + party2_usgov[j] + ")*</b></div><div class='percentages'>" + votes_percent2_usgov[j] + "%</div><br /><div class='candidates'>" + candidate1_usgov[j] + " (" + party1_usgov[j] + ")</div><div class='percentages'>" + votes_percent1_usgov[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_usgov[j] / total_prec_usgov[j]) * 100) + "%</div>";
    }
          else if (in_status1_usgov[j] == true && is_winner1_usgov[j] == false){
          return "<div class='districts'><b>"+ state_usgov[j] + "</b></div><hr><div class='candidates'><b>" + candidate1_usgov[j] + " (" + party1_usgov[j] + ")*</b></div><div class='percentages'>" + votes_percent1_usgov[j] + "%</div><br /><div class='candidates'>" + candidate2_usgov[j] + " (" + party2_usgov[j] + ")</div><div class='percentages'>" + votes_percent2_usgov[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_usgov[j] / total_prec_usgov[j]) * 100) + "%</div>";
    }
          else if (in_status2_usgov[j] == true && is_winner2_usgov[j] == false){ 
          return "<div class='districts'><b>"+ state_usgov[j] + "</b></div><hr><div class='candidates'><b>" + candidate2_usgov[j] + " (" + party2_usgov[j] + ")*</b></div><div class='percentages'>" + votes_percent2_usgov[j] + "%</div><br /><div class='candidates'>" + candidate1_usgov[j] + " (" + party1_usgov[j] + ")</div><div class='percentages'>" + votes_percent1_usgov[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_usgov[j] / total_prec_usgov[j]) * 100) + "%</div>";
    }
          else if (in_status1_usgov[j] == false && is_winner1_usgov[j] == true){
          return "<div class='districts'><b>"+ state_usgov[j] + "</b></div><hr><div class='candidates'>&#10004;" + candidate1_usgov[j] + " (" + party1_usgov[j] + ")</div><div class='percentages'>" + votes_percent1_usgov[j] + "%</div><br /><div class='candidates'>" + candidate2_usgov[j] + " (" + party2_usgov[j] + ")</div><div class='percentages'>" + votes_percent2_usgov[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_usgov[j] / total_prec_usgov[j]) * 100) + "%</div>";
    }
          else if (in_status2_usgov[j] == false && is_winner2_usgov[j] == true){ 
          return "<div class='districts'><b>"+ state_usgov[j] + "</b></div><hr><div class='candidates'>" + candidate1_usgov[j] + " (" + party1_usgov[j] + ")</div><div class='percentages'>" + votes_percent1_usgov[j] + "%</div><br /><div class='candidates'>&#10004;" + candidate2_usgov[j] + " (" + party2_usgov[j] + ")</div><div class='percentages'>" + votes_percent2_usgov[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_usgov[j] / total_prec_usgov[j]) * 100) + "%</div>";
    }
          else  {
          return "<div class='districts'><b>"+ state_usgov[j] + "</b></div><hr><div class='candidates'>" + candidate1_usgov[j] + " (" + party1_usgov[j] + ")</div><div class='percentages'>" + votes_percent1_usgov[j] + "%</div><br /><div class='candidates'>" + candidate2_usgov[j] + " (" + party2_usgov[j] + ")</div><div class='percentages'>" + votes_percent2_usgov[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_usgov[j] / total_prec_usgov[j]) * 100) + "%</div>";
                }
               }
                      }
        ));

    });

//US GOV CARTOGRAM
var cartogram6 = {
    margin: {
        top: 70,
        right: 0,
        bottom: 0,
        left: 90
    },

    selector: '#target-gov2',

    init: function() {
        var self = this;

        self.jQueryel = jQuery(self.selector);

        self.width = 300 - self.margin.left - self.margin.right;
        self.height = 300 - self.margin.top - self.margin.bottom;

        self.svg = d3.select(self.selector).append('svg')
            .attr('height', self.height + self.margin.top + self.margin.bottom)
            .attr('width', self.width + self.margin.left + self.margin.right)

        self.state_size = self.width / 12;
        self.state_padding = 2;

        self.map = self.svg.append('g')
            .attr('transform', 'translate(' + self.margin.left + ','
                  + self.margin.top + ')')

        self.drawMap();
    },

    drawMap: function() {
        var self = this;

        var states = self.map.selectAll('.states')
            .data(self.state_pos_co22)
            .enter().append('g')
            .attr('class', 'state-groups');

        var state = states.append('rect')
            .attr('id', function(d) {
                return d.state_postal + "-usgov";
            })
            .attr('class', 'state')
            .attr('rx', 2)
            .attr('ry', 2)
            .attr('x', function(d) {
                return d.column * (self.state_size + self.state_padding);
            })
            .attr('y', function(d) {
                return d.row * (self.state_size + self.state_padding);
            })
            .attr('width', self.state_size)
            .attr('height', self.state_size)
            .attr('class', function(d) {
                  var j = d.color_value ;
                if (percent_prec_usgov[j] > 20){
                     if (votes_percent1_usgov[j] > votes_percent2_usgov[j] && percent_prec_usgov[j] == 100) {
                                  if (party1_usgov[j] == 'D' ) {
                                     return 'dfl_safe';
                                      }
                                  else if (party1_usgov[j] == 'R') {
                                     return 'gop_safe';
                                      }
                                }
                     if (votes_percent1_usgov[j] < votes_percent2_usgov[j] && percent_prec_usgov[j] == 100) {
                                  if (party2_usgov[j] == 'D' ) {
                                     return 'dfl_safe';
                                      }
                                  else if (party2_usgov[j] == 'R' ) {
                                     return 'gop_safe';
                                      }
                                }
                     if (votes_percent1_usgov[j] > votes_percent2_usgov[j] && percent_prec_usgov[j] < 100) {
                                  if (party1_usgov[j] == 'D' ) {
                                     return 'dfl_lean';
                                      }
                                  else if (party1_usgov[j] == 'R') {
                                     return 'gop_lean';
                                      }
                                }
                     if (votes_percent1_usgov[j] < votes_percent2_usgov[j] && percent_prec_usgov[j] < 100) {
                                  if (party2_usgov[j] == 'D' ) {
                                     return 'dfl_lean';
                                      }
                                  else if (party2_usgov[j] == 'R' ) {
                                     return 'gop_lean';
                                      }
                                }
}
                     else {
                                 return 'nothing';
                                }
            })
             .call(d3.helper.tooltip(
        function(d){
          var j = d.color_value;

          if (candidate1_usgov[j] == null){
            return "<div class='districts'><b>" + d.state_full + "</b></div><hr>No races";
               }
          else {
          if (in_status1_usgov[j] == true && is_winner1_usgov[j] == true){
          return "<div class='districts'><b>"+ state_usgov[j] + "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate1_usgov[j] + " (" + party1_usgov[j] + ")*</b></div><div class='percentages'>" + votes_percent1_usgov[j] + "%</div><br /><div class='candidates'>" + candidate2_usgov[j] + " (" + party2_usgov[j] + ")</div><div class='percentages'>" + votes_percent2_usgov[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_usgov[j] / total_prec_usgov[j]) * 100) + "%</div>";
    }
          else if (in_status2_usgov[j] == true && is_winner2_usgov[j] == true){ 
          return "<div class='districts'><b>"+ state_usgov[j] + "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate2_usgov[j] + " (" + party2_usgov[j] + ")*</b></div><div class='percentages'>" + votes_percent2_usgov[j] + "%</div><br /><div class='candidates'>" + candidate1_usgov[j] + " (" + party1_usgov[j] + ")</div><div class='percentages'>" + votes_percent1_usgov[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_usgov[j] / total_prec_usgov[j]) * 100) + "%</div>";
    }
          else if (in_status1_usgov[j] == true && is_winner1_usgov[j] == false){
          return "<div class='districts'><b>"+ state_usgov[j] + "</b></div><hr><div class='candidates'><b>" + candidate1_usgov[j] + " (" + party1_usgov[j] + ")*</b></div><div class='percentages'>" + votes_percent1_usgov[j] + "%</div><br /><div class='candidates'>" + candidate2_usgov[j] + " (" + party2_usgov[j] + ")</div><div class='percentages'>" + votes_percent2_usgov[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_usgov[j] / total_prec_usgov[j]) * 100) + "%</div>";
    }
          else if (in_status2_usgov[j] == true && is_winner2_usgov[j] == false){ 
          return "<div class='districts'><b>"+ state_usgov[j] + "</b></div><hr><div class='candidates'><b>" + candidate2_usgov[j] + " (" + party2_usgov[j] + ")*</b></div><div class='percentages'>" + votes_percent2_usgov[j] + "%</div><br /><div class='candidates'>" + candidate1_usgov[j] + " (" + party1_usgov[j] + ")</div><div class='percentages'>" + votes_percent1_usgov[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_usgov[j] / total_prec_usgov[j]) * 100) + "%</div>";
    }
          else if (in_status1_usgov[j] == false && is_winner1_usgov[j] == true){
          return "<div class='districts'><b>"+ state_usgov[j] + "</b></div><hr><div class='candidates'>&#10004;" + candidate1_usgov[j] + " (" + party1_usgov[j] + ")</div><div class='percentages'>" + votes_percent1_usgov[j] + "%</div><br /><div class='candidates'>" + candidate2_usgov[j] + " (" + party2_usgov[j] + ")</div><div class='percentages'>" + votes_percent2_usgov[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_usgov[j] / total_prec_usgov[j]) * 100) + "%</div>";
    }
          else if (in_status2_usgov[j] == false && is_winner2_usgov[j] == true){ 
          return "<div class='districts'><b>"+ state_usgov[j] + "</b></div><hr><div class='candidates'>" + candidate1_usgov[j] + " (" + party1_usgov[j] + ")</div><div class='percentages'>" + votes_percent1_usgov[j] + "%</div><br /><div class='candidates'>&#10004;" + candidate2_usgov[j] + " (" + party2_usgov[j] + ")</div><div class='percentages'>" + votes_percent2_usgov[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_usgov[j] / total_prec_usgov[j]) * 100) + "%</div>";
    }
          else  {
          return "<div class='districts'><b>"+ state_usgov[j] + "</b></div><hr><div class='candidates'>" + candidate1_usgov[j] + " (" + party1_usgov[j] + ")</div><div class='percentages'>" + votes_percent1_usgov[j] + "%</div><br /><div class='candidates'>" + candidate2_usgov[j] + " (" + party2_usgov[j] + ")</div><div class='percentages'>" + votes_percent2_usgov[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_usgov[j] / total_prec_usgov[j]) * 100) + "%</div>";
                }
               }
                      }
        ));

        var text = states.append('text')
            .attr('class', 'state-label')
            .attr('dominant-baseline', 'central')
            .attr('x', function(d) {
                return (d.column * (self.state_size + self.state_padding))
                        + self.state_size / 2; })
            .attr('y', function(d) {
                return (d.row * (self.state_size + self.state_padding))
                    + self.state_size / 2; })
            .style('text-anchor', 'middle')
          //  .text(function(d) {
           //     return d.state_postal;
           // });
    },

    state_pos_co22: [{'state_full':'Alabama','state_postal':'AL','row':5,'column':6,'color_value':1},
        {'state_full':'Alaska','state_postal':'AK','row':6,'column':0,'color_value':2},
        {'state_full':'Arizona','state_postal':'AZ','row':4,'column':1,'color_value':3},
        {'state_full':'Arkansas','state_postal':'AR','row':4,'column':4,'color_value':4},
        {'state_full':'California','state_postal':'CA','row':2,'column':0,'color_value':5},
        {'state_full':'Colorado','state_postal':'CO','row':3,'column':2,'color_value':6},
        {'state_full':'Connecticut','state_postal':'CT','row':2,'column':9,'color_value':7},
        {'state_full':'D.C.','state_postal':'DC','row':4,'column':8,'color_value':0},
        {'state_full':'Delaware','state_postal':'DE','row':3,'column':9,'color_value':0},
        {'state_full':'Florida','state_postal':'FL','row':6,'column':8,'color_value':8},
        {'state_full':'Georgia','state_postal':'GA','row':5,'column':7,'color_value':9},
        {'state_full':'Hawaii','state_postal':'HI','row':6,'column':-1,'color_value':10},
        {'state_full':'Idaho','state_postal':'ID','row':1,'column':1,'color_value':11},
        {'state_full':'Illinois','state_postal':'IL','row':1,'column':6,'color_value':12},
        {'state_full':'Indiana','state_postal':'IN','row':2,'column':5,'color_value':0},
        {'state_full':'Iowa','state_postal':'IA','row':2,'column':4,'color_value':13},
        {'state_full':'Kansas','state_postal':'KS','row':4,'column':3,'color_value':14},
        {'state_full':'Kentucky','state_postal':'KY','row':3,'column':5,'color_value':0},
        {'state_full':'Louisiana','state_postal':'LA','row':5,'column':4,'color_value':0},
        {'state_full':'Maine','state_postal':'ME','row':-1,'column':10,'color_value':15},
        {'state_full':'Maryland','state_postal':'MD','row':3,'column':8,'color_value':16},
        {'state_full':'Massachusetts','state_postal':'MA','row':1,'column':9,'color_value':17},
        {'state_full':'Michigan','state_postal':'MI','row':1,'column':7,'color_value':18},
        {'state_full':'Minnesota','state_postal':'MN','row':1,'column':4,'color_value':19},
        {'state_full':'Mississippi','state_postal':'MS','row':5,'column':5,'color_value':0},
        {'state_full':'Missouri','state_postal':'MO','row':3,'column':4,'color_value':0},
        {'state_full':'Montana','state_postal':'MT','row':1,'column':2,'color_value':0},
        {'state_full':'Nebraska','state_postal':'NE','row':3,'column':3,'color_value':20},
        {'state_full':'Nevada','state_postal':'NV','row':2,'column':1,'color_value':21},
        {'state_full':'New Hampshire','state_postal':'NH','row':0,'column':10,'color_value':22},
        {'state_full':'New Jersey','state_postal':'NJ','row':2,'column':8,'color_value':0},
        {'state_full':'New Mexico','state_postal':'NM','row':4,'column':2,'color_value':23},
        {'state_full':'New York','state_postal':'NY','row':1,'column':8,'color_value':24},
        {'state_full':'North Carolina','state_postal':'NC','row':4,'column':6,'color_value':0},
        {'state_full':'North Dakota','state_postal':'ND','row':1,'column':3,'color_value':0},
        {'state_full':'Ohio','state_postal':'OH','row':2,'column':6,'color_value':25},
        {'state_full':'Oklahoma','state_postal':'OK','row':5,'column':3,'color_value':26},
        {'state_full':'Oregon','state_postal':'OR','row':1,'column':0,'color_value':27},
        {'state_full':'Pennsylvania','state_postal':'PA','row':2,'column':7,'color_value':28},
        {'state_full':'Rhode Island','state_postal':'RI','row':2,'column':10,'color_value':29},
        {'state_full':'South Carolina','state_postal':'SC','row':4,'column':7,'color_value':30},
        {'state_full':'South Dakota','state_postal':'SD','row':2,'column':3,'color_value':31},
        {'state_full':'Tennessee','state_postal':'TN','row':4,'column':5,'color_value':32},
        {'state_full':'Texas','state_postal':'TX','row':6,'column':3,'color_value':33},
        {'state_full':'Utah','state_postal':'UT','row':3,'column':1,'color_value':0},
        {'state_full':'Vermont','state_postal':'VT','row':0,'column':9,'color_value':34},
        {'state_full':'Virginia','state_postal':'VA','row':3,'column':7,'color_value':0},
        {'state_full':'Washington','state_postal':'WA','row':0,'column':0,'color_value':0},
        {'state_full':'West Virginia','state_postal':'WV','row':3,'column':6,'color_value':0},
        {'state_full':'Wisconsin','state_postal':'WI','row':1,'column':5,'color_value':35},
        {'state_full':'Wyoming','state_postal':'WY','row':2,'column':2,'color_value':36}]

};

jQuery(document).ready(function() {
    cartogram6.init();
});

            //});

 });
</script>

<script>
//US SENATE LIVE MAP

jQuery.getJSON('http://data-layer-elections.startribune.com/api/v1/cached/summary/all-ussenate/', function(json2) {            

jQuery( "#target-sen2" ).empty();

//LOAD DATA AND COLOR VARIABLES
var state_ussen = [];
var precinct_ussen = [];
var total_prec_ussen = [];
var percent_prec_ussen = [];
var candidate1_ussen = [];
var candidate2_ussen = [];
var party1_ussen = [];
var party2_ussen = [];
var votes_count1_ussen = [];
var votes_count2_ussen = [];
var votes_percent1_ussen = [];
var votes_percent2_ussen = [];
var in_status1_ussen = [];
var in_status2_ussen = [];
var is_winner1_ussen = [];
var is_winner2_ussen = [];
var d_safe_count_ussen = 32;
var r_safe_count_ussen = 30;
var d_lean_count_ussen = 0;
var r_lean_count_ussen = 0;
var toss_count_ussen = 0;


dfl_safe = "#506fb3";
gop_safe = "#d46354";
dfl_lean = "#8493c8";
gop_lean = "#f48072";
basecolor = "#ddd";

           for ( i = 0; i < 33; i++ ) {
state_ussen[i+1] = json2.results[i]['header'];
precinct_ussen[i+1] = Number(json2.results[i]['items'][0]['items'][0]['precincts_reporting']);
total_prec_ussen[i+1] = Number(json2.results[i]['items'][0]['items'][0]['total_precincts']);
percent_prec_ussen[i+1] = Number(json2.results[i]['items'][0]['items'][0]['percent_of_precincts']);
candidate1_ussen[i+1] = json2.results[i]['items'][0]['items'][0]['items'][0]['first_name']+ ' ' + json2.results[i]['items'][0]['items'][0]['items'][0]['last_name'];
candidate2_ussen[i+1] = json2.results[i]['items'][0]['items'][0]['items'][1]['first_name']+ ' ' + json2.results[i]['items'][0]['items'][0]['items'][1]['last_name'];
party1_ussen[i+1] = json2.results[i]['items'][0]['items'][0]['items'][0]['party_abbreviation'];
party2_ussen[i+1] = json2.results[i]['items'][0]['items'][0]['items'][1]['party_abbreviation'];
votes_count1_ussen[i+1] = Number(json2.results[i]['items'][0]['items'][0]['items'][0]['votes']);
votes_count2_ussen[i+1] = Number(json2.results[i]['items'][0]['items'][0]['items'][1]['votes']);
votes_percent1_ussen[i+1] = Number(json2.results[i]['items'][0]['items'][0]['items'][0]['percent_of_votes']);
votes_percent2_ussen[i+1] = Number(json2.results[i]['items'][0]['items'][0]['items'][1]['percent_of_votes']);
in_status1_ussen[i+1] = Boolean(json2.results[i]['items'][0]['items'][0]['items'][0]['is_incumbent']);
in_status2_ussen[i+1] = Boolean(json2.results[i]['items'][0]['items'][0]['items'][1]['is_incumbent']);
is_winner1_ussen[i+1] = Boolean(json2.results[i]['items'][0]['items'][0]['items'][0]['is_winner']);
is_winner2_ussen[i+1] = Boolean(json2.results[i]['items'][0]['items'][0]['items'][1]['is_winner']);

  if (is_winner1_ussen[i+1] == true){
              if  (party1_ussen[i+1] == 'D'){
    d_safe_count_ussen++;
                  }
              else if (party1_ussen[i+1] == 'R'){
    r_safe_count_ussen++;
                  }
             }
  else if (is_winner2_ussen[i+1] == true){
        if  (party2_ussen[i+1] == 'D'){
    d_safe_count_ussen++;
                  }
              else if (party2_ussen[i+1] == 'R'){
    r_safe_count_ussen++;
                  }
             }
  else if (votes_percent1_ussen[i+1] > votes_percent2_ussen[i+1] && percent_prec_ussen[i+1] < 85){
              if  (party1_ussen[i+1] == 'D'){
    d_lean_count_ussen++;
                  }
              else if (party1_ussen[i+1] == 'R'){
    r_lean_count_ussen++;
                  }
             }
  else if (votes_percent1_ussen[i+1] < votes_percent2_ussen[i+1] && percent_prec_ussen[i+1] < 85){
        if  (party2_ussen[i+1] == 'D'){
    d_lean_count_ussen++;
                  }
              else if (party2_ussen[i+1] == 'R'){
    r_lean_count_ussen++;
                  }
             }
        else {toss_count_ussen++;}
                    
}

var results_ussen = [];

results_ussen[0] = d_safe_count_ussen;
results_ussen[1] = d_lean_count_ussen;
results_ussen[2] = toss_count_ussen;
results_ussen[3] = r_lean_count_ussen;
results_ussen[4] = r_safe_count_ussen;

var results_json_ussen = JSON.stringify(results_ussen);

var projection4 = d3.geo.albersUsa().scale(400).translate([210, 100]);
var path4 = d3.geo.path().projection(projection4);
var svg4 = d3.select("#map-sen2 svg");

//US SENATE MAP
d3.json("http://www.startribune.com/includes/states_sen.json", function(json) {
        svg4.selectAll("path")
           .data(json.features)
           .enter()
           .append("path")
           .attr("d", path4)
           .attr("stroke-width", .5)
           .style("stroke", "white")
           .style("fill", function(d) {

         var j = Number(d.properties.INDEX);
                     if (state_ussen[i+1] == 'Alabama') { 
                                     return gop_safe;
                                }
               else  if (percent_prec_ussen[j] > 20){
                     if (votes_percent1_ussen[j] > votes_percent2_ussen[j] && percent_prec_ussen[j] == 100 ||  (votes_percent1_ussen[j] - votes_percent2_ussen[j]) > 20) { 
                                  if (party1_ussen[j] == 'D' ) {
                                     return dfl_safe;
                                      }
                                  else if (party1_ussen[j] == 'R') {
                                     return gop_safe;
                                      }
                                }
                     if (votes_percent2_ussen[j] > votes_percent1_ussen[j] && percent_prec_ussen[j] == 100 ||  (votes_percent2_ussen[j] - votes_percent1_ussen[j]) > 20) {
                                  if (party2_ussen[j] == 'D' ) {
                                     return dfl_safe;
                                      }
                                  else if (party2_ussen[j] == 'R' ) {
                                     return gop_safe;
                                      }
                                  else if (party2_ussen[j] == 'I' ) {
                                     return '#000';
                                      }
                                }
                     if (votes_percent1_ussen[j] > votes_percent2_ussen[j] && percent_prec_ussen[j] < 100) { 
                                  if (party1_ussen[j] == 'D' ) {
                                     return dfl_lean;
                                      }
                                  else if (party1_ussen[j] == 'R') {
                                     return gop_lean;
                                      }
                                }
                     if (votes_percent1_ussen[j] < votes_percent2_ussen[j] && percent_prec_ussen[j] < 100) {
                                  if (party2_ussen[j] == 'D' ) {
                                     return dfl_lean;
                                      }
                                  else if (party2_ussen[j] == 'R' ) {
                                     return gop_lean;
                                      }
                                  else if (party2_ussen[j] == 'I' ) {
                                     return '#000';
                                      }
                                }
                      else {
                                 return basecolor;
                                }
}
                      else {
                                 return basecolor;
                                }

          })
             .call(d3.helper.tooltip(
        function(d){
          var j = Number(d.properties.INDEX);

          if (candidate1_ussen[j] == null){
            return "<div class='districts'><b>" + d.properties.NAME+ "</b></div><hr>No races";
               }
          else {
          if (in_status1_ussen[j] == true && is_winner1_ussen[j] == true){
          return "<div class='districts'><b>"+ state_ussen[j] + "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate1_ussen[j] + "</b> (" + party1_ussen[j] + ")*</div><div class='percentages'>" + votes_percent1_ussen[j] + "%</div><br /><div class='candidates'>" + candidate2_ussen[j] + " (" + party2_ussen[j] + ")</div><div class='percentages'>" + votes_percent2_ussen[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_ussen[j] / total_prec_ussen[j]) * 100) + "%</div>";
    }
          else if (in_status2_ussen[j] == true && is_winner2_ussen[j] == true){ 
          return "<div class='districts'><b>"+ state_ussen[j] + "</b></div><hr><div class='candidates'><b>&#10004;" + candidate2_ussen[j] + "</b> (" + party2_ussen[j] + ")*</div><div class='percentages'>" + votes_percent2_ussen[j] + "%</div><br /><div class='candidates'>" + candidate1_ussen[j] + " (" + party1_ussen[j] + ")</div><div class='percentages'>" + votes_percent1_ussen[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_ussen[j] / total_prec_ussen[j]) * 100) + "%</div>";
    }
          if (in_status1_ussen[j] == true && is_winner1_ussen[j] == false){
          return "<div class='districts'><b>"+ state_ussen[j] + "</b></div><hr><div class='candidates'><b>" + candidate1_ussen[j] + "</b> (" + party1_ussen[j] + ")*</div><div class='percentages'>" + votes_percent1_ussen[j] + "%</div><br /><div class='candidates'>" + candidate2_ussen[j] + " (" + party2_ussen[j] + ")</div><div class='percentages'>" + votes_percent2_ussen[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_ussen[j] / total_prec_ussen[j]) * 100) + "%</div>";
    }
          else if (in_status2_ussen[j] == true && is_winner2_ussen[j] == false){ 
          return "<div class='districts'><b>"+ state_ussen[j] + "</b></div><hr><div class='candidates'><b>" + candidate2_ussen[j] + "</b> (" + party2_ussen[j] + ")*</div><div class='percentages'>" + votes_percent2_ussen[j] + "%</div><br /><div class='candidates'>" + candidate1_ussen[j] + " (" + party1_ussen[j] + ")</div><div class='percentages'>" + votes_percent1_ussen[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_ussen[j] / total_prec_ussen[j]) * 100) + "%</div>";
    }
          if (in_status1_ussen[j] == false && is_winner1_ussen[j] == true){
          return "<div class='districts'><b>"+ state_ussen[j] + "</b></div><hr><div class='candidates'>&#10004;" + candidate1_ussen[j] + " (" + party1_ussen[j] + ")</div><div class='percentages'>" + votes_percent1_ussen[j] + "%</div><br /><div class='candidates'>" + candidate2_ussen[j] + " (" + party2_ussen[j] + ")</div><div class='percentages'>" + votes_percent2_ussen[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_ussen[j] / total_prec_ussen[j]) * 100) + "%</div>";
    }
          else if (in_status2_ussen[j] == false && is_winner2_ussen[j] == true){ 
          return "<div class='districts'><b>"+ state_ussen[j] + "</b></div><hr><div class='candidates'>" + candidate1_ussen[j] + " (" + party1_ussen[j] + ")</div><div class='percentages'>" + votes_percent1_ussen[j] + "%</div><br /><div class='candidates'>&#10004;" + candidate2_ussen[j] + " (" + party2_ussen[j] + ")</div><div class='percentages'>" + votes_percent2_ussen[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_ussen[j] / total_prec_ussen[j]) * 100) + "%</div>";
    }
          else  {
          return "<div class='districts'><b>"+ state_ussen[j] + "</b></div><hr><div class='candidates'>" + candidate1_ussen[j] + " (" + party1_ussen[j] + ")</div><div class='percentages'>" + votes_percent1_ussen[j] + "%</div><br /><div class='candidates'>" + candidate2_ussen[j] + " (" + party2_ussen[j] + ")</div><div class='percentages'>" + votes_percent2_ussen[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_ussen[j] / total_prec_ussen[j]) * 100) + "%</div>";
                }
               }
                      }
        ));
    });


//US SENATE CARTOGRAM
var cartogram5 = {
    margin: {
        top: 25,
        right: 0,
        bottom: 0,
        left: 10
    },

    selector: '#target-sen2',

    init: function() {
        var self = this;

        self.jQueryel = jQuery(self.selector);

        self.width = 250 - self.margin.left - self.margin.right;
        self.height = 200 - self.margin.top - self.margin.bottom;

        self.svg = d3.select(self.selector).append('svg')
            .attr('height', self.height + self.margin.top + self.margin.bottom)
            .attr('width', self.width + self.margin.left + self.margin.right)

        self.state_size = self.width / 12;
        self.state_padding = 2;

        self.map = self.svg.append('g')
            .attr('transform', 'translate(' + self.margin.left + ','
                  + self.margin.top + ')')

        self.drawMap();
    },

    drawMap: function() {
        var self = this;

        var states = self.map.selectAll('.states')
            .data(self.state_pos_co2)
            .enter().append('g')
            .attr('class', 'state-groups');

        var state = states.append('rect')
            .attr('id', function(d) {
                return d.state_postal + "-ussen";
            })
            .attr('class', 'state')
            .attr('rx', 2)
            .attr('ry', 2)
            .attr('x', function(d) {
                return d.column * (self.state_size + self.state_padding);
            })
            .attr('y', function(d) {
                return d.row * (self.state_size + self.state_padding);
            })
            .attr('width', self.state_size)
            .attr('height', self.state_size)
            .attr('class', function(d) {
                  var j = d.color_value;
                     if (votes_percent1_ussen[j] > votes_percent2_ussen[j] && percent_prec_ussen[j] == 100) {
                                  if (party1_ussen[j] == 'D' ) {
                                     return 'dfl_safe';
                                      }
                                  else if (party1_ussen[j] == 'R') {
                                     return 'gop_safe';
                                      }
                                }
                     if (votes_percent1_ussen[j] < votes_percent2_ussen[j] && percent_prec_ussen[j] == 100) {
                                  if (party2_ussen[j] == 'D' ) {
                                     return 'dfl_safe';
                                      }
                                  else if (party2_ussen[j] == 'R' ) {
                                     return 'gop_safe';
                                      }
                                  else if (party2_ussen[j] == 'I' ) {
                                     return 'i_lean';
                                      }
                                }
                     if (votes_percent1_ussen[j] > votes_percent2_ussen[j] && percent_prec_ussen[j] < 100) {
                                  if (party1_ussen[j] == 'D' ) {
                                     return 'dfl_lean';
                                      }
                                  else if (party1_ussen[j] == 'R') {
                                     return 'gop_lean';
                                      }
                                }
                     if (votes_percent1_ussen[j] < votes_percent2_ussen[j] && percent_prec_ussen[j] < 100) {
                                  if (party2_ussen[j] == 'D' ) {
                                     return 'dfl_lean';
                                      }
                                  else if (party2_ussen[j] == 'R' ) {
                                     return 'gop_lean';
                                      }
                                  else if (party2_ussen[j] == 'I' ) {
                                     return 'i_lean';
                                      }
                                }
                     else {
                                 return 'nothing';
                                }
            })    
             .call(d3.helper.tooltip(
        function(d){
          var j = d.color_value;

          if (candidate1_ussen[j] == null){
            return "<div class='districts'><b>" + d.state_full + "</b></div><hr>No races";
               }
          else {
          if (in_status1_ussen[j] == true && is_winner1_ussen[j] == true){
          return "<div class='districts'><b>"+ state_ussen[j] + "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate1_ussen[j] + "</b> (" + party1_ussen[j] + ")*</div><div class='percentages'>" + votes_percent1_ussen[j] + "%</div><br /><div class='candidates'>" + candidate2_ussen[j] + " (" + party2_ussen[j] + ")</div><div class='percentages'>" + votes_percent2_ussen[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_ussen[j] / total_prec_ussen[j]) * 100) + "%</div>";
    }
          else if (in_status2_ussen[j] == true && is_winner2_ussen[j] == true){ 
          return "<div class='districts'><b>"+ state_ussen[j] + "</b></div><hr><div class='candidates'><b>&#10004;" + candidate2_ussen[j] + "</b> (" + party2_ussen[j] + ")*</div><div class='percentages'>" + votes_percent2_ussen[j] + "%</div><br /><div class='candidates'>" + candidate1_ussen[j] + " (" + party1_ussen[j] + ")</div><div class='percentages'>" + votes_percent1_ussen[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_ussen[j] / total_prec_ussen[j]) * 100) + "%</div>";
    }
          if (in_status1_ussen[j] == true && is_winner1_ussen[j] == false){
          return "<div class='districts'><b>"+ state_ussen[j] + "</b></div><hr><div class='candidates'><b>" + candidate1_ussen[j] + "</b> (" + party1_ussen[j] + ")*</div><div class='percentages'>" + votes_percent1_ussen[j] + "%</div><br /><div class='candidates'>" + candidate2_ussen[j] + " (" + party2_ussen[j] + ")</div><div class='percentages'>" + votes_percent2_ussen[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_ussen[j] / total_prec_ussen[j]) * 100) + "%</div>";
    }
          else if (in_status2_ussen[j] == true && is_winner2_ussen[j] == false){ 
          return "<div class='districts'><b>"+ state_ussen[j] + "</b></div><hr><div class='candidates'><b>" + candidate2_ussen[j] + "</b> (" + party2_ussen[j] + ")*</div><div class='percentages'>" + votes_percent2_ussen[j] + "%</div><br /><div class='candidates'>" + candidate1_ussen[j] + " (" + party1_ussen[j] + ")</div><div class='percentages'>" + votes_percent1_ussen[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_ussen[j] / total_prec_ussen[j]) * 100) + "%</div>";
    }
          if (in_status1_ussen[j] == false && is_winner1_ussen[j] == true){
          return "<div class='districts'><b>"+ state_ussen[j] + "</b></div><hr><div class='candidates'>&#10004;" + candidate1_ussen[j] + " (" + party1_ussen[j] + ")</div><div class='percentages'>" + votes_percent1_ussen[j] + "%</div><br /><div class='candidates'>" + candidate2_ussen[j] + " (" + party2_ussen[j] + ")</div><div class='percentages'>" + votes_percent2_ussen[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_ussen[j] / total_prec_ussen[j]) * 100) + "%</div>";
    }
          else if (in_status2_ussen[j] == false && is_winner2_ussen[j] == true){ 
          return "<div class='districts'><b>"+ state_ussen[j] + "</b></div><hr><div class='candidates'>" + candidate1_ussen[j] + " (" + party1_ussen[j] + ")</div><div class='percentages'>" + votes_percent1_ussen[j] + "%</div><br /><div class='candidates'>&#10004;" + candidate2_ussen[j] + " (" + party2_ussen[j] + ")</div><div class='percentages'>" + votes_percent2_ussen[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_ussen[j] / total_prec_ussen[j]) * 100) + "%</div>";
    }
          else  {
          return "<div class='districts'><b>"+ state_ussen[j] + "</b></div><hr><div class='candidates'>" + candidate1_ussen[j] + " (" + party1_ussen[j] + ")</div><div class='percentages'>" + votes_percent1_ussen[j] + "%</div><br /><div class='candidates'>" + candidate2_ussen[j] + " (" + party2_ussen[j] + ")</div><div class='percentages'>" + votes_percent2_ussen[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_ussen[j] / total_prec_ussen[j]) * 100) + "%</div>";
                }
               }
                      }
        ));

        var text = states.append('text')
            .attr('class', 'state-label')
            .attr('dominant-baseline', 'central')
            .attr('x', function(d) {
                return (d.column * (self.state_size + self.state_padding))
                        + self.state_size / 2; })
            .attr('y', function(d) {
                return (d.row * (self.state_size + self.state_padding))
                    + self.state_size / 2; })
            .style('text-anchor', 'middle')
          //  .text(function(d) {
          //      return d.state_postal;
         //   });
    },

    state_pos_co2: [{'state_full':'Alabama','state_postal':'AL','row':5,'column':6,'color_value':0},
        {'state_full':'Alaska','state_postal':'AK','row':6,'column':0,'color_value':1},
        {'state_full':'Arizona','state_postal':'AZ','row':4,'column':1,'color_value':0},
        {'state_full':'Arkansas','state_postal':'AR','row':4,'column':4,'color_value':2},
        {'state_full':'California','state_postal':'CA','row':2,'column':0,'color_value':0},
        {'state_full':'Colorado','state_postal':'CO','row':3,'column':2,'color_value':3},
        {'state_full':'Connecticut','state_postal':'CT','row':2,'column':9,'color_value':0},
        {'state_full':'D.C.','state_postal':'DC','row':4,'column':8,'color_value':0},
        {'state_full':'Delaware','state_postal':'DE','row':3,'column':9,'color_value':4},
        {'state_full':'Florida','state_postal':'FL','row':6,'column':8,'color_value':0},
        {'state_full':'Georgia','state_postal':'GA','row':5,'column':7,'color_value':5},
        {'state_full':'Hawaii','state_postal':'HI','row':6,'column':-1,'color_value':6},
        {'state_full':'Idaho','state_postal':'ID','row':1,'column':1,'color_value':7},
        {'state_full':'Illinois','state_postal':'IL','row':1,'column':6,'color_value':8},
        {'state_full':'Indiana','state_postal':'IN','row':2,'column':5,'color_value':0},
        {'state_full':'Iowa','state_postal':'IA','row':2,'column':4,'color_value':9},
        {'state_full':'Kansas','state_postal':'KS','row':4,'column':3,'color_value':10},
        {'state_full':'Kentucky','state_postal':'KY','row':3,'column':5,'color_value':11},
        {'state_full':'Louisiana','state_postal':'LA','row':5,'column':4,'color_value':12},
        {'state_full':'Maine','state_postal':'ME','row':-1,'column':10,'color_value':13},
        {'state_full':'Maryland','state_postal':'MD','row':3,'column':8,'color_value':0},
        {'state_full':'Massachusetts','state_postal':'MA','row':1,'column':9,'color_value':14},
        {'state_full':'Michigan','state_postal':'MI','row':1,'column':7,'color_value':15},
        {'state_full':'Minnesota','state_postal':'MN','row':1,'column':4,'color_value':16},
        {'state_full':'Mississippi','state_postal':'MS','row':5,'column':5,'color_value':17},
        {'state_full':'Missouri','state_postal':'MO','row':3,'column':4,'color_value':0},
        {'state_full':'Montana','state_postal':'MT','row':1,'column':2,'color_value':18},
        {'state_full':'Nebraska','state_postal':'NE','row':3,'column':3,'color_value':19},
        {'state_full':'Nevada','state_postal':'NV','row':2,'column':1,'color_value':0},
        {'state_full':'New Hampshire','state_postal':'NH','row':0,'column':10,'color_value':20},
        {'state_full':'New Jersey','state_postal':'NJ','row':2,'column':8,'color_value':21},
        {'state_full':'New Mexico','state_postal':'NM','row':4,'column':2,'color_value':22},
        {'state_full':'New York','state_postal':'NY','row':1,'column':8,'color_value':0},
        {'state_full':'North Carolina','state_postal':'NC','row':4,'column':6,'color_value':23},
        {'state_full':'North Dakota','state_postal':'ND','row':1,'column':3,'color_value':0},
        {'state_full':'Ohio','state_postal':'OH','row':2,'column':6,'color_value':0},
        {'state_full':'Oklahoma','state_postal':'OK','row':5,'column':3,'color_value':24},
        {'state_full':'Oregon','state_postal':'OR','row':1,'column':0,'color_value':25},
        {'state_full':'Pennsylvania','state_postal':'PA','row':2,'column':7,'color_value':0},
        {'state_full':'Rhode Island','state_postal':'RI','row':2,'column':10,'color_value':26},
        {'state_full':'South Carolina','state_postal':'SC','row':4,'column':7,'color_value':27},
        {'state_full':'South Dakota','state_postal':'SD','row':2,'column':3,'color_value':28},
        {'state_full':'Tennessee','state_postal':'TN','row':4,'column':5,'color_value':29},
        {'state_full':'Texas','state_postal':'TX','row':6,'column':3,'color_value':30},
        {'state_full':'Utah','state_postal':'UT','row':3,'column':1,'color_value':0},
        {'state_full':'Vermont','state_postal':'VT','row':0,'column':9,'color_value':0},
        {'state_full':'Virginia','state_postal':'VA','row':3,'column':7,'color_value':31},
        {'state_full':'Washington','state_postal':'WA','row':0,'column':0,'color_value':0},
        {'state_full':'West Virginia','state_postal':'WV','row':3,'column':6,'color_value':32},
        {'state_full':'Wisconsin','state_postal':'WI','row':1,'column':5,'color_value':0},
        {'state_full':'Wyoming','state_postal':'WY','row':2,'column':2,'color_value':33}]
};

jQuery(document).ready(function() {
    cartogram5.init();
});

           // });

 });


</script>

<script>
//MNLEG LIVE MAPS
jQuery.getJSON('http://data-layer-elections.startribune.com/api/v1/cached/summary/mn-state-house/', function(json2) {           

jQuery( "#target-leg" ).empty();
jQuery( "#target-leg2" ).empty();

//LOAD DATA AND COLOR VARIABLES
var district_mnleg = [];
var precinct_mnleg = [];
var total_prec_mnleg = [];
var percent_prec_mnleg = [];
var candidate1_mnleg = [];
var candidate2_mnleg = [];
var party1_mnleg = [];
var party2_mnleg = [];
var votes_count1_mnleg = [];
var votes_count2_mnleg = [];
var votes_percent1_mnleg = [];
var votes_percent2_mnleg = [];
var in_status1_mnleg = [];
var in_status2_mnleg = [];
var is_winner1_mnleg = [];
var is_winner2_mnleg = [];
var d_safe_count_mnleg = 1;
var r_safe_count_mnleg = 8;
var d_lean_count_mnleg = 0;
var r_lean_count_mnleg = 0;
var toss_count_mnleg = 0;

dfl_safe = "#506fb3";
gop_safe = "#d46354";
dfl_lean = "#8493c8";
gop_lean = "#f48072";
basecolor = "#ddd";

           for ( var i = 0; i < 125; i++ ) {
district_mnleg[i+1] = json2.results[i]['header'];
precinct_mnleg[i+1] = Number(json2.results[i]['items'][0]['items'][0]['precincts_reporting']);
total_prec_mnleg[i+1] = Number(json2.results[i]['items'][0]['items'][0]['total_precincts']);
percent_prec_mnleg[i+1] = Number(json2.results[i]['items'][0]['items'][0]['percent_of_precincts']);
candidate1_mnleg[i+1] = json2.results[i]['items'][0]['items'][0]['items'][0]['first_name']+ ' ' + json2.results[i]['items'][0]['items'][0]['items'][0]['last_name']; //GOT IT
candidate2_mnleg[i+1] = json2.results[i]['items'][0]['items'][0]['items'][1]['first_name']+ ' ' + json2.results[i]['items'][0]['items'][0]['items'][1]['last_name']; //GOT IT
party1_mnleg[i+1] = json2.results[i]['items'][0]['items'][0]['items'][0]['party_abbreviation'];
party2_mnleg[i+1] = json2.results[i]['items'][0]['items'][0]['items'][1]['party_abbreviation'];
votes_count1_mnleg[i+1] = Number(json2.results[i]['items'][0]['items'][0]['items'][0]['votes']);
votes_count2_mnleg[i+1] = Number(json2.results[i]['items'][0]['items'][0]['items'][1]['votes']);
votes_percent1_mnleg[i+1] = Number(json2.results[i]['items'][0]['items'][0]['items'][0]['percent_of_votes']);
votes_percent2_mnleg[i+1] = Number(json2.results[i]['items'][0]['items'][0]['items'][1]['percent_of_votes']);
in_status1_mnleg[i+1] = json2.results[i]['items'][0]['items'][0]['items'][0]['is_incumbent'];
in_status2_mnleg[i+1] = json2.results[i]['items'][0]['items'][0]['items'][1]['is_incumbent'];
is_winner1_mnleg[i+1] = Boolean(json2.results[i]['items'][0]['items'][0]['items'][0]['is_winner']);
is_winner2_mnleg[i+1] = Boolean(json2.results[i]['items'][0]['items'][0]['items'][0]['is_winner']);
  if (votes_percent1_mnleg[i+1] > votes_percent2_mnleg[i+1] && percent_prec_mnleg[i+1] == 100 || (votes_percent1_mnleg[i+1] > votes_percent2_mnleg[i+1]) > 20){
              if  (party1_mnleg[i+1] == 'D'){
    d_safe_count_mnleg++;
                  }
              else if (party1_mnleg[i+1] == 'R'){
    r_safe_count_mnleg++;
                  }
             }
  else if (votes_percent2_mnleg[i+1] > votes_percent1_mnleg[i+1] && percent_prec_mnleg[i+1] == 100 || (votes_percent2_mnleg[i+1] > votes_percent1_mnleg[i+1]) > 20){
        if  (party2_mnleg[i+1] == 'D'){
    d_safe_count_mnleg++;
                  }
              else if (party2_mnleg[i+1] == 'R'){
    r_safe_count_mnleg++;
                  }
             }
  else if (votes_percent1_mnleg[i+1] > votes_percent2_mnleg[i+1] && percent_prec_mnleg[i+1] < 85){
              if  (party1_mnleg[i+1] == 'D'){
    d_lean_count_mnleg++;
                  }
              else if (party1_mnleg[i+1] == 'R'){
    r_lean_count_mnleg++;
                  }
             }
  else if (votes_percent1_mnleg[i+1] < votes_percent2_mnleg[i+1] && percent_prec_mnleg[i+1] < 85){
        if  (party2_mnleg[i+1] == 'D'){
    d_lean_count_mnleg++;
                  }
              else if (party2_mnleg[i+1] == 'R'){
    r_lean_count_mnleg++;
                  }
             }
        else {toss_count_mnleg++;}
}

var results_mnleg = [];

results_mnleg[0] = d_safe_count_mnleg;
results_mnleg[1] = d_lean_count_mnleg;
results_mnleg[2] = toss_count_mnleg;
results_mnleg[3] = r_lean_count_mnleg;
results_mnleg[4] = r_safe_count_mnleg;

var results_json_mnleg = JSON.stringify(results_mnleg);
var projection2 = d3.geo.mercator().scale([9200]).center([-78.4500,42.6000]);
// var projection2 = d3.geo.mercator().scale([17000]).center([-87.9565,45.6524]);
var path2 = d3.geo.path().projection(projection2);
var svg2 = d3.select("#map-leg svg");

var projection = d3.geo.mercator().scale([53000]).center([-90.5400,44.410]);
// var projection = d3.geo.mercator().scale([80000]).center([-91.9995,44.8637]);
var path = d3.geo.path().projection(projection);
var svg = d3.select("#map-leg2 svg");

//MNLEG STATE MAP
d3.json("http://www.startribune.com/includes/mnleg.json", function(json) {
        svg2.selectAll("path")
           .data(json.features)
           .enter()
           .append("path")
           .attr("d", path2)
           .attr("stroke-width", .5)
           .style("stroke", "white")
           .style("fill", function(d) {

         var j = Number(d.properties.DATA);

         if (d.properties.DISTRICT == "25B") {
                   return dfl_safe;
              }
         else if (d.properties.DISTRICT == "23B") {
                   return gop_safe;
              }
         else if (d.properties.DISTRICT == "13B") {
                   return gop_safe;
              }
         else if (d.properties.DISTRICT == "34A") {
                   return gop_safe;
              }
         else if (d.properties.DISTRICT == "47B") {
                   return gop_safe;
              }
         else if (d.properties.DISTRICT == "31A") {
                   return gop_safe;
              }
         else if (d.properties.DISTRICT == "25A") {
                   return gop_safe;
              }
         else if (d.properties.DISTRICT == "29B") {
                   return gop_safe;
              }
         else if (d.properties.DISTRICT == "29A") {
                   return gop_safe;
              }
                if (percent_prec_mnleg[j] > 20){
                     if (votes_percent1_mnleg[j] > votes_percent2_mnleg[j] && percent_prec_mnleg[j] == 100 || (votes_percent1_mnleg[j] - votes_percent2_mnleg[j]) > 20) {
                                  if (party1_mnleg[j] == 'D' ) {
                                     return dfl_safe;
                                      }
                                  else if (party1_mnleg[j] == 'R') {
                                     return gop_safe;
                                      }
                                }
                     else  if (votes_percent2_mnleg[j] > votes_percent1_mnleg[j] && percent_prec_mnleg[j] == 100 || (votes_percent2_mnleg[j] - votes_percent1_mnleg[j]) > 20) {
                                  if (party2_mnleg[j] == 'D' ) {
                                     return dfl_safe;
                                      }
                                  else if (party2_mnleg[j] == 'R' ) {
                                     return gop_safe;
                                      }
                                }
                     else if (votes_percent1_mnleg[j] > votes_percent2_mnleg[j]) {
                                  if (party1_mnleg[j] == 'D' ) {
                                     return dfl_lean;
                                      }
                                  else if (party1_mnleg[j] == 'R') {
                                     return gop_lean;
                                      }
                                }
                     else  if (votes_percent1_mnleg[j] < votes_percent2_mnleg[j]) {
                                  if (party2_mnleg[j] == 'D' ) {
                                     return dfl_lean;
                                      }
                                  else if (party2_mnleg[j] == 'R' ) {
                                     return gop_lean;
                                      }
                                }
                      else {
                                 return basecolor;
                                }
}
                      else {
                                 return basecolor;
                                }

          })
             .call(d3.helper.tooltip(
        function(d){
          var j = Number(d.properties.DATA);

         if (d.properties.DISTRICT == "25B") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Kim Norton (D)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "23B") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Tony Cornish (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "13B") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Tim O'Driscoll (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "34A") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Joyce Peppin (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "47B") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Joe Hoppe (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "31A") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Kurt Daudt (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "25A") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Duane Quam (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "29B") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Marion O'Neill (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "29A") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Joe McDonald (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
          else if (in_status1_mnleg[j] == true && is_winner1_mnleg[j] == true){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate1_mnleg[j] + "</b> (" + party1_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status2_mnleg[j] == true && is_winner2_mnleg[j] == true){ 
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate2_mnleg[j] + "</b> (" + party2_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status1_mnleg[j] == true && is_winner1_mnleg[j] == false){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'><b>" + candidate1_mnleg[j] + "</b> (" + party1_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status2_mnleg[j] == true && is_winner2_mnleg[j] == false){ 
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'><b>" + candidate2_mnleg[j] + "</b> (" + party2_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status1_mnleg[j] == false && is_winner1_mnleg[j] == true){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>&#10004;" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
                }
          else if (in_status2_mnleg[j] == false && is_winner2_mnleg[j] == true){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>&#10004;" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
                }
          else  {
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
                }
                      }
        ));
 });

//MNLEG METRO MAP
d3.json("http://www.startribune.com/includes/mnleg22014.json", function(json) {
        svg.selectAll("path")
           .data(json.features)
           .enter()
           .append("path")
           .attr("d", path)
           .attr("stroke-width", .5)
           .style("stroke", "white")
           .style("fill", function(d) {

         var j = Number(d.properties.DATA);

         if (d.properties.DISTRICT == "25B") {
                   return dfl_safe;
              }
         else if (d.properties.DISTRICT == "23B") {
                   return gop_safe;
              }
         else if (d.properties.DISTRICT == "13B") {
                   return gop_safe;
              }
         else if (d.properties.DISTRICT == "34A") {
                   return gop_safe;
              }
         else if (d.properties.DISTRICT == "47B") {
                   return gop_safe;
              }
         else if (d.properties.DISTRICT == "31A") {
                   return gop_safe;
              }
         else if (d.properties.DISTRICT == "25A") {
                   return gop_safe;
              }
         else if (d.properties.DISTRICT == "29B") {
                   return gop_safe;
              }
         else if (d.properties.DISTRICT == "29A") {
                   return gop_safe;
              }
                if (percent_prec_mnleg[j] > 20){
                     if (votes_percent1_mnleg[j] > votes_percent2_mnleg[j] && percent_prec_mnleg[j] == 100 || (votes_percent1_mnleg[j] - votes_percent2_mnleg[j]) > 20) {
                                  if (party1_mnleg[j] == 'D' ) {
                                     return dfl_safe;
                                      }
                                  else if (party1_mnleg[j] == 'R') {
                                     return gop_safe;
                                      }
                                }
                     else  if (votes_percent2_mnleg[j] > votes_percent1_mnleg[j] && percent_prec_mnleg[j] == 100 || (votes_percent2_mnleg[j] - votes_percent1_mnleg[j]) > 20) {
                                  if (party2_mnleg[j] == 'D' ) {
                                     return dfl_safe;
                                      }
                                  else if (party2_mnleg[j] == 'R' ) {
                                     return gop_safe;
                                      }
                                }
                     else if (votes_percent1_mnleg[j] > votes_percent2_mnleg[j]) {
                                  if (party1_mnleg[j] == 'D' ) {
                                     return dfl_lean;
                                      }
                                  else if (party1_mnleg[j] == 'R') {
                                     return gop_lean;
                                      }
                                }
                     else  if (votes_percent1_mnleg[j] < votes_percent2_mnleg[j]) {
                                  if (party2_mnleg[j] == 'D' ) {
                                     return dfl_lean;
                                      }
                                  else if (party2_mnleg[j] == 'R' ) {
                                     return gop_lean;
                                      }
                                }
                      else {
                                 return basecolor;
                                }
}
                      else {
                                 return basecolor;
                                }

          })
             .call(d3.helper.tooltip(
        function(d){
          var j = Number(d.properties.DATA);

         if (d.properties.DISTRICT == "25B") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Kim Norton (D)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "23B") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Tony Cornish (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "13B") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Tim O'Driscoll (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "34A") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Joyce Peppin (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "47B") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Joe Hoppe (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "31A") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Kurt Daudt (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "25A") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Duane Quam (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "29B") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Marion O'Neill (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.properties.DISTRICT == "29A") {
                   return "<div class='district'><b>"+ d.properties.DISTRICT + "</b></div><hr><div class='candidates'>&#10004;<b>Joe McDonald (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
          else if (in_status1_mnleg[j] == true && is_winner1_mnleg[j] == true){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate1_mnleg[j] + "</b> (" + party1_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status2_mnleg[j] == true && is_winner2_mnleg[j] == true){ 
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate2_mnleg[j] + "</b> (" + party2_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status1_mnleg[j] == true && is_winner1_mnleg[j] == false){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'><b>" + candidate1_mnleg[j] + "</b> (" + party1_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status2_mnleg[j] == true && is_winner2_mnleg[j] == false){ 
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'><b>" + candidate2_mnleg[j] + "</b> (" + party2_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status1_mnleg[j] == false && is_winner1_mnleg[j] == true){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>&#10004;" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
                }
          else if (in_status2_mnleg[j] == false && is_winner2_mnleg[j] == true){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>&#10004;" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
                }
          else  {
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
                }
                      }
        ));
 });

//MNLEG CARTOGRAM DON'T CHANGE
var cartogram = {
    margin: {
        top: 25,
        right: 0,
        bottom: 0,
        left: 10
    },

    selector: '#target-leg',

    init: function() {
        var self = this;

        self.jQueryel = jQuery(self.selector);

        self.width = 200 - self.margin.left - self.margin.right;
        self.height = 175 - self.margin.top - self.margin.bottom;

        self.svg = d3.select(self.selector).append('svg')
            .attr('height', self.height + self.margin.top + self.margin.bottom)
            .attr('width', self.width + self.margin.left + self.margin.right)

        self.state_size = self.width / 12;
        self.state_padding = 2;

        self.map = self.svg.append('g')
            .attr('transform', 'translate(' + self.margin.left + ','
                  + self.margin.top + ')')

        self.drawMap();
    },

    drawMap: function() {
        var self = this;

        var states = self.map.selectAll('.states')
            .data(self.state_pos)
            .enter().append('g')
            .attr('class', 'state-groups');

        var state = states.append('rect')
            .attr('id', function(d) {
                return d.state_postal + "-mnleg";
            })
            .attr('class', 'state')
            .attr('rx', 2)
            .attr('ry', 2)
            .attr('x', function(d) {
                return d.column * (self.state_size + self.state_padding);
            })
            .attr('y', function(d) {
                return d.row * (self.state_size + self.state_padding);
            })
            .attr('width', self.state_size)
            .attr('height', self.state_size)
            .attr('class', function(d) {
                    var j = d.color_value;
         if (d.state_postal == "25B") {
                                     return 'dfl_safe';
              }
         else if (d.state_postal == "23B") {
                                     return 'gop_safe';
              }
         else if (d.state_postal == "13B") {
                                     return 'gop_safe';
              }
         else if (d.state_postal == "34A") {
                                     return 'gop_safe';
              }
         else if (d.state_postal == "47B") {
                                     return 'gop_safe';
              }
         else if (d.state_postal == "31A") {
                                     return 'gop_safe';
              }
         else if (d.state_postal == "25A") {
                                     return 'gop_safe';
              }
         else if (d.state_postal == "29B") {
                                     return 'gop_safe';
              }
         else if (d.state_postal == "29A") {
                   return 'gop_safe';
              }
                if (percent_prec_mnleg[j] > 20){
                     if (votes_percent1_mnleg[j] > votes_percent2_mnleg[j] && percent_prec_mnleg[j] == 100) {
                                  if (party1_mnleg[j] == 'D' ) {
                                     return 'dfl_safe';
                                      }
                                  else if (party1_mnleg[j] == 'R') {
                                     return 'gop_safe';
                                      }
                                }
                     else if (votes_percent1_mnleg[j] < votes_percent2_mnleg[j] && percent_prec_mnleg[j] == 100) {
                                  if (party2_mnleg[j] == 'D' ) {
                                     return 'dfl_safe';
                                      }
                                  else if (party2_mnleg[j] == 'R' ) {
                                     return 'gop_safe';
                                      }
                                }
                     else if (votes_percent1_mnleg[j] > votes_percent2_mnleg[j] && percent_prec_mnleg[j] < 100) {
                                  if (party1_mnleg[j] == 'D' ) {
                                     return 'dfl_lean';
                                      }
                                  else if (party1_mnleg[j] == 'R') {
                                     return 'gop_lean';
                                      }
                                }
                     else if (votes_percent1_mnleg[j] < votes_percent2_mnleg[j] && percent_prec_mnleg[j] < 100) {
                                  if (party2_mnleg[j] == 'D' ) {
                                     return 'dfl_lean';
                                      }
                                  else if (party2_mnleg[j] == 'R' ) {
                                     return 'gop_lean';
                                      }
                                }
}
                     else {
                                 return 'nothing';
                                }
            })
             .call(d3.helper.tooltip(
        function(d){
          var j = d.color_value;

         if (d.state_postal == "25B") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Kim Norton (D)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "23B") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Tony Cornish (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "13B") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Tim O'Driscoll (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "34A") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Joyce Peppin (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "47B") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Joe Hoppe (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "31A") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Kurt Daudt (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "25A") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Duane Quam (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "29B") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Marion O'Neill (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "29A") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Joe McDonald (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
          else if (in_status1_mnleg[j] == true && is_winner1_mnleg[j] == true){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate1_mnleg[j] + "</b> (" + party1_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status2_mnleg[j] == true && is_winner2_mnleg[j] == true){ 
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate2_mnleg[j] + "</b> (" + party2_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status1_mnleg[j] == true && is_winner1_mnleg[j] == false){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'><b>" + candidate1_mnleg[j] + "</b> (" + party1_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status2_mnleg[j] == true && is_winner2_mnleg[j] == false){ 
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'><b>" + candidate2_mnleg[j] + "</b> (" + party2_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status1_mnleg[j] == false && is_winner1_mnleg[j] == true){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>&#10004;" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
                }
          else if (in_status2_mnleg[j] == false && is_winner2_mnleg[j] == true){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>&#10004;" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
                }
          else  {
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
                }
                      }
        ));

        var text = states.append('text')
            .attr('class', 'state-label')
            .attr('dominant-baseline', 'central')
            .attr('x', function(d) {
                return (d.column * (self.state_size + self.state_padding))
                        + self.state_size / 2; })
            .attr('y', function(d) {
                return (d.row * (self.state_size + self.state_padding))
                    + self.state_size / 2; })
            .style('text-anchor', 'middle')
            //.text(function(d) {
           //     return d.state_postal;
           // });
    },

    state_pos: [{'state_full':'District 1A','state_postal':'1A','row':0,'column':0,'color_value':1},
        {'state_full':'District 2A','state_postal':'2A','row':-1,'column':1,'color_value':3},
        {'state_full':'District 1B','state_postal':'1B','row':0,'column':1,'color_value':2},
        {'state_full':'District 2B','state_postal':'2B','row':0,'column':2,'color_value':4},
        {'state_full':'District 6A','state_postal':'6A','row':0,'column':3,'color_value':11},
        {'state_full':'District 6B','state_postal':'6B','row':0,'column':4,'color_value':12},
        {'state_full':'District 3B','state_postal':'3B','row':0,'column':5,'color_value':6},
        {'state_full':'District 3A','state_postal':'3A','row':0,'column':6,'color_value':5},
        {'state_full':'District 4A','state_postal':'4A','row':1,'column':0,'color_value':7},
        {'state_full':'District 4B','state_postal':'4B','row':1,'column':1,'color_value':8},
        {'state_full':'District 5A','state_postal':'5A','row':1,'column':2,'color_value':9},
        {'state_full':'District 5B','state_postal':'5B','row':1,'column':3,'color_value':10},
        {'state_full':'District 7B','state_postal':'7B','row':1,'column':4,'color_value':14},
        {'state_full':'District 7A','state_postal':'7A','row':1,'column':5,'color_value':13},
        {'state_full':'District 8A','state_postal':'8A','row':2,'column':0,'color_value':15},
        {'state_full':'District 8B','state_postal':'8B','row':2,'column':1,'color_value':16},
        {'state_full':'District 10A','state_postal':'10A','row':2,'column':2,'color_value':19},
        {'state_full':'District 10B','state_postal':'10B','row':2,'column':3,'color_value':20},
        {'state_full':'District 11A','state_postal':'11A','row':2,'column':4,'color_value':21},
        {'state_full':'District 12A','state_postal':'12A','row':3,'column':0,'color_value':23},
        {'state_full':'District 9A','state_postal':'9A','row':3,'column':1,'color_value':17},
        {'state_full':'District 9B','state_postal':'9B','row':3,'column':2,'color_value':18},
        {'state_full':'District 15B','state_postal':'15B','row':3,'column':3,'color_value':29},
        {'state_full':'District 11B','state_postal':'11B','row':3,'column':4,'color_value':22},
        {'state_full':'District 12B','state_postal':'12B','row':4,'column':0,'color_value':24},
        {'state_full':'District 13A','state_postal':'13A','row':4,'column':1,'color_value':25},
        {'state_full':'District 13B','state_postal':'13B','row':4,'column':2,'color_value':0},
        {'state_full':'District 15A','state_postal':'15A','row':4,'column':3,'color_value':28},
        {'state_full':'District 32A','state_postal':'32A','row':4,'column':4,'color_value':56},
        {'state_full':'District 17A','state_postal':'17A','row':5,'column':0,'color_value':32},
        {'state_full':'District 17B','state_postal':'17B','row':5,'column':1,'color_value':33},
        {'state_full':'District 14A','state_postal':'14A','row':5,'column':2,'color_value':26},
        {'state_full':'District 14B','state_postal':'14B','row':5,'column':3,'color_value':27},
        {'state_full':'District 31A','state_postal':'31A','row':5,'column':4,'color_value':0},
        {'state_full':'District 15A','state_postal':'15A','row':6,'column':0,'color_value':28},
        {'state_full':'District 18A','state_postal':'18A','row':6,'column':1,'color_value':34},
        {'state_full':'District 29A','state_postal':'29A','row':6,'column':2,'color_value':0},
        {'state_full':'District 29B','state_postal':'29B','row':6,'column':3,'color_value':0},
        {'state_full':'District 16B','state_postal':'16B','row':7,'column':0,'color_value':31},
        {'state_full':'District 18B','state_postal':'18B','row':7,'column':1,'color_value':35},
        {'state_full':'District 47A','state_postal':'47A','row':7,'column':2,'color_value':85},
        {'state_full':'District 33A','state_postal':'33A','row':7,'column':3,'color_value':58},
        {'state_full':'District 19A','state_postal':'19A','row':8,'column':0,'color_value':36},
        {'state_full':'District 20A','state_postal':'20A','row':8,'column':1,'color_value':38},
        {'state_full':'District 20B','state_postal':'20B','row':8,'column':2,'color_value':39},
        {'state_full':'District 58B','state_postal':'58B','row':8,'column':3,'color_value':103},
        {'state_full':'District 21A','state_postal':'21A','row':8,'column':4,'color_value':40},
        {'state_full':'District 21B','state_postal':'21B','row':8,'column':5,'color_value':41},
        {'state_full':'District 22B','state_postal':'22B','row':9,'column':0,'color_value':43},
        {'state_full':'District 19B','state_postal':'19B','row':9,'column':1,'color_value':37},
        {'state_full':'District 23B','state_postal':'23B','row':9,'column':2,'color_value':0},
        {'state_full':'District 25B','state_postal':'25B','row':9,'column':3,'color_value':0},
        {'state_full':'District 24B','state_postal':'24B','row':9,'column':4,'color_value':46},
        {'state_full':'District 25A','state_postal':'25A','row':9,'column':5,'color_value':0},
        {'state_full':'District 28A','state_postal':'28A','row':9,'column':6,'color_value':51},
        {'state_full':'District 22A','state_postal':'22A','row':10,'column':0,'color_value':42},
        {'state_full':'District 22B','state_postal':'22B','row':10,'column':1,'color_value':43},
        {'state_full':'District 24A','state_postal':'24A','row':10,'column':2,'color_value':45},
        {'state_full':'District 26B','state_postal':'26B','row':10,'column':3,'color_value':48},
        {'state_full':'District 26A','state_postal':'26A','row':10,'column':4,'color_value':47},
        {'state_full':'District 27A','state_postal':'27A','row':10,'column':5,'color_value':49},
        {'state_full':'District 27B','state_postal':'27B','row':10,'column':6,'color_value':50},
        {'state_full':'District 28B','state_postal':'28B','row':10,'column':7,'color_value':52}
        ]

};

//METRO AREA MNLEG CARTOGRAM
var cartogram2 = {
    margin: {
        top: 25,
        right: 0,
        bottom: 0,
        left: 10
    },

    selector: '#target-leg2',

    init: function() {
        var self = this;

        self.jQueryel = jQuery(self.selector);

        self.width = 200 - self.margin.left - self.margin.right;
        self.height = 175 - self.margin.top - self.margin.bottom;

        self.svg = d3.select(self.selector).append('svg')
            .attr('height', self.height + self.margin.top + self.margin.bottom)
            .attr('width', self.width + self.margin.left + self.margin.right)

        self.state_size = self.width / 12;
        self.state_padding = 2;

        self.map = self.svg.append('g')
            .attr('transform', 'translate(' + self.margin.left + ','
                  + self.margin.top + ')')

        self.drawMap();
    },

    drawMap: function() {
        var self = this;

        var states = self.map.selectAll('.states')
            .data(self.state_pos2)
            .enter().append('g')
            .attr('class', 'state-groups');

        var state = states.append('rect')
            .attr('id', function(d) {
                return d.state_postal + "-metleg";
            })
            .attr('class', 'state')
            .attr('rx', 2)
            .attr('ry', 2)
            .attr('x', function(d) {
                return d.column * (self.state_size + self.state_padding);
            })
            .attr('y', function(d) {
                return d.row * (self.state_size + self.state_padding);
            })
            .attr('width', self.state_size)
            .attr('height', self.state_size)
            .attr('class', function(d) {
                    var j = d.color_value;
         if (d.state_postal == "25B") {
                                     return 'dfl_safe';
              }
         else if (d.state_postal == "23B") {
                                     return 'gop_safe';
              }
         else if (d.state_postal == "13B") {
                                     return 'gop_safe';
              }
         else if (d.state_postal == "34A") {
                                     return 'gop_safe';
              }
         else if (d.state_postal == "47B") {
                                     return 'gop_safe';
              }
         else if (d.state_postal == "31A") {
                                     return 'gop_safe';
              }
         else if (d.state_postal == "25A") {
                                     return 'gop_safe';
              }
         else if (d.state_postal == "29B") {
                                     return 'gop_safe';
              }
         else if (d.state_postal == "29A") {
                   return 'gop_safe';
              }
                if (percent_prec_mnleg[j] > 20){
                     if (votes_percent1_mnleg[j] > votes_percent2_mnleg[j] && percent_prec_mnleg[j] == 100) {
                                  if (party1_mnleg[j] == 'D' ) {
                                     return 'dfl_safe';
                                      }
                                  else if (party1_mnleg[j] == 'R') {
                                     return 'gop_safe';
                                      }
                                }
                     else if (votes_percent1_mnleg[j] < votes_percent2_mnleg[j] && percent_prec_mnleg[j] == 100) {
                                  if (party2_mnleg[j] == 'D' ) {
                                     return 'dfl_safe';
                                      }
                                  else if (party2_mnleg[j] == 'R' ) {
                                     return 'gop_safe';
                                      }
                                }
                     else if (votes_percent1_mnleg[j] > votes_percent2_mnleg[j] && percent_prec_mnleg[j] < 100) {
                                  if (party1_mnleg[j] == 'D' ) {
                                     return 'dfl_lean';
                                      }
                                  else if (party1_mnleg[j] == 'R') {
                                     return 'gop_lean';
                                      }
                                }
                     else if (votes_percent1_mnleg[j] < votes_percent2_mnleg[j] && percent_prec_mnleg[j] < 100) {
                                  if (party2_mnleg[j] == 'D' ) {
                                     return 'dfl_lean';
                                      }
                                  else if (party2_mnleg[j] == 'R' ) {
                                     return 'gop_lean';
                                      }
                                }
}
                     else {
                                 return 'nothing';
                                }
            })
             .call(d3.helper.tooltip(
        function(d){
          var j = d.color_value;

         if (d.state_postal == "25B") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Kim Norton (D)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "23B") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Tony Cornish (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "13B") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Tim O'Driscoll (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "34A") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Joyce Peppin (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "47B") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Joe Hoppe (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "31A") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Kurt Daudt (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "25A") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Duane Quam (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "29B") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Marion O'Neill (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
         else if (d.state_postal == "29A") {
                   return "<div class='district'><b>"+ d.state_full + "</b></div><hr><div class='candidates'>&#10004;<b>Joe McDonald (R)*</b></div><div class='percentages' >Unopposed</div>";
              }
          else if (in_status1_mnleg[j] == true && is_winner1_mnleg[j] == true){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate1_mnleg[j] + "</b> (" + party1_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status2_mnleg[j] == true && is_winner2_mnleg[j] == true){ 
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>&#10004;<b>" + candidate2_mnleg[j] + "</b> (" + party2_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status1_mnleg[j] == true && is_winner1_mnleg[j] == false){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'><b>" + candidate1_mnleg[j] + "</b> (" + party1_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status2_mnleg[j] == true && is_winner2_mnleg[j] == false){ 
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'><b>" + candidate2_mnleg[j] + "</b> (" + party2_mnleg[j] + ")*</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
    }
          else if (in_status1_mnleg[j] == false && is_winner1_mnleg[j] == true){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>&#10004;" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
                }
          else if (in_status2_mnleg[j] == false && is_winner2_mnleg[j] == true){
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>&#10004;" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
                }
          else  {
          return "<div class='district'><b>"+ district_mnleg[j] + "</b></div><hr><div class='candidates'>" + candidate1_mnleg[j] + " (" + party1_mnleg[j] + ")</div><div class='percentages'>" + votes_percent1_mnleg[j] + "%</div><br /><div class='candidates'>" + candidate2_mnleg[j] + " (" + party2_mnleg[j] + ")</div><div class='percentages'>" + votes_percent2_mnleg[j] + "%</div><hr style='clear:both'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + Math.floor((precinct_mnleg[j] / total_prec_mnleg[j]) * 100) + "%</div>";
                }
                      }
        ));

        var text = states.append('text')
            .attr('class', 'state-label')
            .attr('dominant-baseline', 'central')
            .attr('x', function(d) {
                return (d.column * (self.state_size + self.state_padding))
                        + self.state_size / 2; })
            .attr('y', function(d) {
                return (d.row * (self.state_size + self.state_padding))
                    + self.state_size / 2; })
            .style('text-anchor', 'middle')
            //.text(function(d) {
            //    return d.state_postal;
           // });
    },

    state_pos2: [{'state_full':'30A','state_postal':'30A','row':0,'column':2,'color_value':53},
        {'state_full':'District 30B','state_postal':'30B','row':0,'column':3,'color_value':54},
        {'state_full':'District 35A','state_postal':'35A','row':0,'column':4,'color_value':61},
        {'state_full':'District 35B','state_postal':'35B','row':0,'column':5,'color_value':62},
        {'state_full':'District 31B','state_postal':'31B','row':0,'column':6,'color_value':55},
        {'state_full':'District 32B','state_postal':'32B','row':0,'column':7,'color_value':57},
        {'state_full':'District 34A','state_postal':'34A','row':1,'column':1,'color_value':0},
        {'state_full':'District 36A','state_postal':'36A','row':1,'column':2,'color_value':63},
        {'state_full':'District 36B','state_postal':'36B','row':1,'column':3,'color_value':64},
        {'state_full':'District 37A','state_postal':'37A','row':1,'column':4,'color_value':65},
        {'state_full':'District 37B','state_postal':'37B','row':1,'column':5,'color_value':66},
        {'state_full':'District 38A','state_postal':'38A','row':1,'column':6,'color_value':67},
        {'state_full':'District 38B','state_postal':'38B','row':1,'column':7,'color_value':68},
        {'state_full':'District 39A','state_postal':'39A','row':1,'column':8,'color_value':69},
        {'state_full':'District 34B','state_postal':'34B','row':2,'column':1,'color_value':60},
        {'state_full':'District 40A','state_postal':'40A','row':2,'column':2,'color_value':71},
        {'state_full':'District 40B','state_postal':'40B','row':2,'column':3,'color_value':72},
        {'state_full':'District 41A','state_postal':'41A','row':2,'column':4,'color_value':73},
        {'state_full':'District 41B','state_postal':'41B','row':2,'column':5,'color_value':74},
        {'state_full':'District 42A','state_postal':'42A','row':2,'column':6,'color_value':75},
        {'state_full':'District 42B','state_postal':'42B','row':2,'column':7,'color_value':76},
        {'state_full':'District 43A','state_postal':'43A','row':2,'column':8,'color_value':77},
        {'state_full':'District 44A','state_postal':'44A','row':3,'column':0,'color_value':79},
        {'state_full':'District 45A','state_postal':'45A','row':3,'column':1,'color_value':81},
        {'state_full':'District 45B','state_postal':'45B','row':3,'column':2,'color_value':82},
        {'state_full':'District 59A','state_postal':'59A','row':3,'column':3,'color_value':108},
        {'state_full':'District 60A','state_postal':'60A','row':3,'column':4,'color_value':110},
        {'state_full':'District 66A','state_postal':'66A','row':3,'column':5,'color_value':122},
        {'state_full':'District 66B','state_postal':'66B','row':3,'column':6,'color_value':123},
        {'state_full':'District 67A','state_postal':'67A','row':3,'column':7,'color_value':124},
        {'state_full':'District 43B','state_postal':'43B','row':3,'column':8,'color_value':78},
        {'state_full':'District 39B','state_postal':'39B','row':3,'column':9,'color_value':70},
        {'state_full':'District 44B','state_postal':'44B','row':4,'column':1,'color_value':80},
        {'state_full':'District 46A','state_postal':'46A','row':4,'column':2,'color_value':83},
        {'state_full':'District 59B','state_postal':'59B','row':4,'column':3,'color_value':109},
        {'state_full':'District 60B','state_postal':'60B','row':4,'column':4,'color_value':111},
        {'state_full':'District 64A','state_postal':'64A','row':4,'column':5,'color_value':118},
        {'state_full':'District 65A','state_postal':'65A','row':4,'column':6,'color_value':120},
        {'state_full':'District 67B','state_postal':'67B','row':4,'column':7,'color_value':125},
        {'state_full':'District 53A','state_postal':'53A','row':4,'column':8,'color_value':96},
        {'state_full':'District 33B','state_postal':'33B','row':5,'column':1,'color_value':59},
        {'state_full':'District 46B','state_postal':'46B','row':5,'column':2,'color_value':84},
        {'state_full':'District 61A','state_postal':'61A','row':5,'column':3,'color_value':112},
        {'state_full':'District 62A','state_postal':'62A','row':5,'column':4,'color_value':114},
        {'state_full':'District 63A','state_postal':'63A','row':5,'column':5,'color_value':116},
        {'state_full':'District 65B','state_postal':'65B','row':5,'column':6,'color_value':121},
        {'state_full':'District 53B','state_postal':'53B','row':5,'column':7,'color_value':96},
        {'state_full':'District 54B','state_postal':'54B','row':5,'column':8,'color_value':99},
        {'state_full':'District 48A','state_postal':'48A','row':6,'column':1,'color_value':86},
        {'state_full':'District 49A','state_postal':'49A','row':6,'column':2,'color_value':88},
        {'state_full':'District 61B','state_postal':'61B','row':6,'column':3,'color_value':113},
        {'state_full':'District 62B','state_postal':'62B','row':6,'column':4,'color_value':115},
        {'state_full':'District 63B','state_postal':'63B','row':6,'column':5,'color_value':117},
        {'state_full':'District 64B','state_postal':'64B','row':6,'column':6,'color_value':119},
        {'state_full':'District 52A','state_postal':'52A','row':6,'column':7,'color_value':94},
        {'state_full':'District 54A','state_postal':'54A','row':6,'column':8,'color_value':98},
        {'state_full':'District 47B','state_postal':'47B','row':7,'column':1,'color_value':0},
        {'state_full':'District 48B','state_postal':'48B','row':7,'column':2,'color_value':87},
        {'state_full':'District 49B','state_postal':'49B','row':7,'column':3,'color_value':89},
        {'state_full':'District 50A','state_postal':'50A','row':7,'column':4,'color_value':90},
        {'state_full':'District 50B','state_postal':'50B','row':7,'column':5,'color_value':91},
        {'state_full':'District 51A','state_postal':'51A','row':7,'column':6,'color_value':92},
        {'state_full':'District 51B','state_postal':'51B','row':7,'column':7,'color_value':93},
        {'state_full':'District 52B','state_postal':'52B','row':7,'column':8,'color_value':95},
        {'state_full':'District 55A','state_postal':'55A','row':8,'column':2,'color_value':100},
        {'state_full':'District 55B','state_postal':'55B','row':8,'column':3,'color_value':101},
        {'state_full':'District 56A','state_postal':'56A','row':8,'column':4,'color_value':102},
        {'state_full':'District 56B','state_postal':'56B','row':8,'column':5,'color_value':103},
        {'state_full':'District 58A','state_postal':'58A','row':8,'column':6,'color_value':109},
        {'state_full':'District 57A','state_postal':'57A','row':8,'column':7,'color_value':104},
        {'state_full':'District 57B','state_postal':'57B','row':8,'column':8,'color_value':105}
        ]

};

jQuery(document).ready(function() {
    cartogram2.init();
});

jQuery(document).ready(function() {
    cartogram.init();
});

            //});

 });

</script>

<script>
//MN GOV LIVE MAPS

jQuery.getJSON('http://data-layer-elections.startribune.com/api/v1/cached/crosstab/governor-by-county/', function(json2) {             

jQuery( "#target-gov" ).empty();

//LOAD DATA AND COLOR VARIABLES
var county_mngov = [];
var precinct_mngov = [];
var candidate1_mngov = [];
var candidate2_mngov = [];
var votes_count1_mngov = [];
var votes_count2_mngov = [];
var votes_percent1_mngov = [];
var votes_percent2_mngov = [];
var precinct_overall_mngov = 0;
var votes_all1_mngov = 0;
var votes_all2_mngov = 0;
var votes_other = 0;
var votes_all3_mngov = 0;
var votes_all4_mngov = 0;
var votes_all5_mngov = 0;

dfl_safe = "#506fb3";
gop_safe = "#d46354";
dfl_lean = "#8493c8";
gop_lean = "#f48072";
basecolor = "#ddd";

           for ( var i = 0; i < 87; i++ ) {
county_mngov[i] = json2.results[i]['name'];
precinct_mngov[i] = Number(json2.results[i]['percent_of_precincts']);
candidate1_mngov[i] = json2.results[i]['candidates'][0]['name'];
candidate2_mngov[i] = json2.results[i]['candidates'][2]['name'];
votes_count1_mngov[i] = Number(json2.results[i]['candidates'][0]['votes']);
votes_count2_mngov[i] = Number(json2.results[i]['candidates'][2]['votes']);
votes_percent1_mngov[i] = Number(json2.results[i]['candidates'][0]['percent_of_votes']);
votes_percent2_mngov[i] = Number(json2.results[i]['candidates'][2]['percent_of_votes']);
precinct_overall_mngov = precinct_mngov[i] + precinct_overall_mngov;
votes_all1_mngov = votes_count1_mngov[i] + votes_all1_mngov;
votes_all2_mngov = votes_count2_mngov[i] + votes_all2_mngov;
votes_all3_mngov = Number(json2.results[i]['candidates'][1]['votes']) + votes_all3_mngov;
votes_all4_mngov = Number(json2.results[i]['candidates'][3]['votes']) + votes_all4_mngov;
votes_all5_mngov = Number(json2.results[i]['candidates'][4]['votes']) + votes_all5_mngov;
votes_other =  (Number(json2.results[i]['candidates'][1]['votes']) + Number(json2.results[i]['candidates'][3]['votes']) + Number(json2.results[i]['candidates'][4]['votes'])) + votes_other;
                    }

var dayton_percent = votes_all1_mngov / (votes_all1_mngov + votes_all2_mngov + votes_other);
var johnson_percent = votes_all2_mngov / (votes_all1_mngov + votes_all2_mngov + votes_other); 
var holbrook_percent = votes_all3_mngov / (votes_all1_mngov + votes_all2_mngov + votes_other); 
var nicollet_percent = votes_all4_mngov / (votes_all1_mngov + votes_all2_mngov + votes_other); 
var wright_percent = votes_all5_mngov / (votes_all1_mngov + votes_all2_mngov + votes_other); 

var results_mngov = [];

results_mngov[0] = dayton_percent;
results_mngov[1] = nicollet_percent;
results_mngov[2] = wright_percent;
results_mngov[3] = holbrook_percent;
results_mngov[4] = johnson_percent;

var results_json_mngov = JSON.stringify(results_mngov);

var projection8 = d3.geo.mercator().scale([9200]).center([-78.4500,42.6000]);
// var projection8 = d3.geo.mercator().scale([17000]).center([-87.9565,45.6524]);
var path8 = d3.geo.path().projection(projection8);
var svg8 = d3.select("#map-gov svg");

var projection11 = d3.geo.mercator().scale([45000]).center([-90.3400,44.240]);
// var projection8 = d3.geo.mercator().scale([17000]).center([-87.9565,45.6524]);
var path11 = d3.geo.path().projection(projection11);
var svg11 = d3.select("#map-gov3 svg");

//MN GOV MAP
d3.json("http://www.startribune.com/includes/mncounties.json", function(json) {
        svg8.selectAll("path")
           .data(json.features)
           .enter()
           .append("path")
           .attr("d", path8)
           .attr("stroke-width", .5)
           .style("stroke", "white")
           .style("fill", "black")
           .attr('id', function(d) {
                return d.properties.NAME00 + "-mngovmap";
            })
           .text(function(d) { return d.properties.DISTRICT; })
           .style("fill", function(d) {
    var j = Number(d.properties.INDEX);

                    if (votes_count1_mngov[j] > votes_count2_mngov[j] && precinct_mngov[j] == 100) {
                                     return dfl_safe;
                                }
                    else if (votes_count1_mngov[j] < votes_count2_mngov[j] && precinct_mngov[j] == 100) {
                                     return gop_safe;
                                }
                    else if (votes_count1_mngov[j] > votes_count2_mngov[j] && precinct_mngov[j] < 100) {
                                     return dfl_lean;
                                }
                    else if (votes_count1_mngov[j] < votes_count2_mngov[j] && precinct_mngov[j] < 100) {
                                     return gop_lean;
                                }
                     else {
                                 return basecolor;
                                }
                  })
             .call(d3.helper.tooltip(
        function(d){
          var j = Number(d.properties.INDEX);
          return "<div class='districts'><b>"+ county_mngov[j] + "</b></div><hr><div class='candidates'><b>Mark " + candidate1_mngov[j] + " (D)*</b></div><div class='percentages'>" + votes_percent1_mngov[j] + "%</div><br /><div class='candidates'>Jeff " + candidate2_mngov[j] + " (R)</div><div class='percentages'>" + votes_percent2_mngov[j] + "%</div><hr class='secondHR'><div class='candidates'>Precincts reporting:</div> <div class='percentages'>" + precinct_mngov[j] + "%</div>";
                      }
        ));
 });


//METRO MAP
d3.json("http://www.startribune.com/includes/metro.json", function(json) {
        svg11.selectAll("path")
           .data(json.features)
           .enter()
           .append("path")
           .attr("d", path11)
           .attr("stroke-width", .5)
           .style("stroke", "white")
           .style("fill", "black")
           .attr('id', function(d) {
                return d.properties.NAME00 + "-mngovmap";
            })
           .text(function(d) { return d.properties.DISTRICT; })
           .style("fill", function(d) {
    var j = Number(d.properties.INDEX);
if (precinct_mngov[j] > 20){
                    if (votes_count1_mngov[j] > votes_count2_mngov[j] && precinct_mngov[j] == 100) {
                                     return dfl_safe;
                                }
                    else if (votes_count1_mngov[j] < votes_count2_mngov[j] && precinct_mngov[j] == 100) {
                                     return gop_safe;
                                }
                    else if (votes_count1_mngov[j] > votes_count2_mngov[j] && precinct_mngov[j] < 100) {
                                     return dfl_lean;
                                }
                    else if (votes_count1_mngov[j] < votes_count2_mngov[j] && precinct_mngov[j] < 100) {
                                     return gop_lean;
                                }
                      else {
                                 return basecolor;
                                }
}
                     else {
                                 return basecolor;
                                }
                  })
             .call(d3.helper.tooltip(
        function(d){
          var j = Number(d.properties.INDEX);
          return "<div class='districts'><b>"+ county_mngov[j] + "</b></div><hr><div class='candidates'><b>Mark " + candidate1_mngov[j] + " (D)*</b></div><div class='percentages'>" + votes_percent1_mngov[j] + "%</div><br /><div class='candidates'>Jeff " + candidate2_mngov[j] + " (R)</div><div class='percentages'>" + votes_percent2_mngov[j] + "%</div><hr class='secondHR'><div class='candidates'>Precincts reporting:</div> <div class='percentages'>" + precinct_mngov[j] + "%</div>";
                      }
        ));
 });

//MN GOV CARTOGRAM
var cartogram8 = {
    margin: {
        top: 25,
        right: 0,
        bottom: 0,
        left: 10
    },

    selector: '#target-gov',

    init: function() {
        var self = this;

        self.jQueryel = jQuery(self.selector);

        self.width = 175 - self.margin.left - self.margin.right;
        self.height = 130 - self.margin.top - self.margin.bottom;

        self.svg = d3.select(self.selector).append('svg')
            .attr('height', self.height + self.margin.top + self.margin.bottom)
            .attr('width', self.width + self.margin.left + self.margin.right)

        self.state_size = self.width / 12;
        self.state_padding = 2;

        self.map = self.svg.append('g')
            .attr('transform', 'translate(' + self.margin.left + ','
                  + self.margin.top + ')')

        self.drawMap();
    },

    drawMap: function() {
        var self = this;

        var states = self.map.selectAll('.states')
            .data(self.state_pos_co1)
            .enter().append('g')
            .attr('class', 'state-groups');

        var state = states.append('rect')
            .attr('id', function(d) {
                return d.state_postal + "-mngov";
            })
            .attr('class', 'state')
            .attr('rx', 2)
            .attr('ry', 2)
            .attr('x', function(d) {
                return d.column * (self.state_size + self.state_padding);
            })
            .attr('y', function(d) {
                return d.row * (self.state_size + self.state_padding);
            })
            .attr('width', self.state_size)
            .attr('height', self.state_size)
            .attr('class', function(d) {
                     var j = d.color_value;
                     if (votes_count1_mngov[j] > votes_count2_mngov[j] && precinct_mngov[j] == 100) {
                                     return 'dfl_safe';
                                }
                     else if (votes_count1_mngov[j] < votes_count2_mngov[j] && precinct_mngov[j] == 100) {
                                     return 'gop_safe';
                                }
                     else if (votes_count1_mngov[j] > votes_count2_mngov[j] && precinct_mngov[j] < 100) {
                                     return 'dfl_lean';
                                }
                     else if (votes_count1_mngov[j] < votes_count2_mngov[j] && precinct_mngov[j] < 100) {
                                     return 'gop_lean';
                                }
                     else {
                                 return 'nothing';
                                }
            })
             .call(d3.helper.tooltip(
        function(d){
          var j = Number(d.color_value);
          return "<div class='districts'><b>"+ county_mngov[j] + "</b></div><hr><div class='candidates'><b>Mark " + candidate1_mngov[j] + " (D)*</b></div><div class='percentages'>" + votes_percent1_mngov[j] + "%</div><br /><div class='candidates'>Jeff " + candidate2_mngov[j] + " (R)</div><div class='percentages'>" + votes_percent2_mngov[j] + "%</div><hr class='secondHR'><div class='candidates'>Precincts reporting:</div> <div class='percentages'>" + precinct_mngov[j] + "%</div>";
                      }
        ));
        

        var text = states.append('text')
            .attr('class', 'state-label')
            .attr('dominant-baseline', 'central')
            .attr('x', function(d) {
                return (d.column * (self.state_size + self.state_padding))
                        + self.state_size / 2; })
            .attr('y', function(d) {
                return (d.row * (self.state_size + self.state_padding))
                    + self.state_size / 2; })
            .style('text-anchor', 'middle')
          //  .text(function(d) {
          //      return d.state_postal;
          //  });
    },

    state_pos_co1: [{'state_full':'Kittson','state_postal':'KITT','row':0,'column':0,'color_value':46},
        {'state_full':'Lake of the Woods','state_postal':'LW','row':-1,'column':1,'color_value':47},
        {'state_full':'Roseau','state_postal':'ROS','row':0,'column':1,'color_value':54},
        {'state_full':'Koochiching','state_postal':'KOO','row':0,'column':2,'color_value':38},
        {'state_full':'Saint Louis','state_postal':'STL','row':0,'column':3,'color_value':40},
        {'state_full':'Lake','state_postal':'LAKE','row':0,'column':4,'color_value':39},
        {'state_full':'Cook','state_postal':'COOK','row':0,'column':5,'color_value':36},
        {'state_full':'Marshall','state_postal':'MAR','row':1,'column':0,'color_value':49},
        {'state_full':'Beltrami','state_postal':'BEL','row':1,'column':1,'color_value':42},
        {'state_full':'Itasca','state_postal':'ITAS','row':1,'column':2,'color_value':37},
        {'state_full':'Aitkin','state_postal':'AITK','row':1,'column':3,'color_value':7},
        {'state_full':'Carlton','state_postal':'CARL','row':1,'column':4,'color_value':35},
        {'state_full':'Polk','state_postal':'POLK','row':2,'column':0,'color_value':52},
        {'state_full':'Pennington','state_postal':'PENN','row':2,'column':1,'color_value':51},
        {'state_full':'Red Lake','state_postal':'RL','row':2,'column':2,'color_value':53},
        {'state_full':'Clearwater','state_postal':'CW','row':2,'column':3,'color_value':44},
        {'state_full':'Hubbard','state_postal':'HUB','row':2,'column':4,'color_value':45},
        {'state_full':'Norman','state_postal':'NORM','row':3,'column':0,'color_value':50},
        {'state_full':'Mahnomen','state_postal':'MAHN','row':3,'column':1,'color_value':48},
        {'state_full':'Cass','state_postal':'CASS','row':3,'column':2,'color_value':10},
        {'state_full':'Crow Wing','state_postal':'CROW','row':3,'column':3,'color_value':13},
        {'state_full':'Pine','state_postal':'PINE','row':3,'column':4,'color_value':24},
        {'state_full':'Clay','state_postal':'CLAY','row':4,'column':0,'color_value':43},
        {'state_full':'Becker','state_postal':'BECK','row':4,'column':1,'color_value':41},
        {'state_full':'Wadena','state_postal':'WAD','row':4,'column':2,'color_value':32},
        {'state_full':'Mille Lacs','state_postal':'ML','row':4,'column':3,'color_value':21},
        {'state_full':'Kanabec','state_postal':'KANA','row':4,'column':4,'color_value':17},
        {'state_full':'Wilkin','state_postal':'WILK','row':5,'column':0,'color_value':33},
        {'state_full':'Ottertail','state_postal':'OT','row':5,'column':1,'color_value':23},
        {'state_full':'Todd','state_postal':'TODD','row':5,'column':2,'color_value':30},
        {'state_full':'Morrison','state_postal':'MORR','row':5,'column':3,'color_value':22},
        {'state_full':'Benton','state_postal':'BEN','row':5,'column':4,'color_value':8},
        {'state_full':'Traverse','state_postal':'TRAV','row':6,'column':0,'color_value':31},
        {'state_full':'Grant','state_postal':'GRANT','row':6,'column':1,'color_value':15},
        {'state_full':'Douglas','state_postal':'DOUG','row':6,'column':2,'color_value':14},
        {'state_full':'Stearns','state_postal':'STRNS','row':6,'column':3,'color_value':27},
        {'state_full':'Isanti','state_postal':'ISA','row':6,'column':4,'color_value':16},
        {'state_full':'Big Stone','state_postal':'BIG','row':7,'column':0,'color_value':9},
        {'state_full':'Stevens','state_postal':'STEVE','row':7,'column':1,'color_value':28},
        {'state_full':'Pope','state_postal':'POP','row':7,'column':2,'color_value':25},
        {'state_full':'Sherburne','state_postal':'SB','row':7,'column':3,'color_value':26},
        {'state_full':'Anoka','state_postal':'AK','row':7,'column':4,'color_value':0},
        {'state_full':'Chisago','state_postal':'CHIS','row':7,'column':5,'color_value':12},
        {'state_full':'Lac qui Parle','state_postal':'LAC','row':8,'column':0,'color_value':19},
        {'state_full':'Swift','state_postal':'SWIFT','row':8,'column':1,'color_value':29},
        {'state_full':'Kandiyohi','state_postal':'KAN','row':8,'column':2,'color_value':18},
        {'state_full':'Meeker','state_postal':'MEEK','row':8,'column':3,'color_value':20},
        {'state_full':'Wright','state_postal':'WR','row':8,'column':4,'color_value':34},
        {'state_full':'Hennepin','state_postal':'HENN','row':8,'column':5,'color_value':3},
        {'state_full':'Ramsey','state_postal':'RAM','row':8,'column':6,'color_value':4},
        {'state_full':'Washington','state_postal':'WA','row':8,'column':7,'color_value':6},
        {'state_full':'Yellow Medicine','state_postal':'YM','row':9,'column':0,'color_value':86},
        {'state_full':'Chippewa','state_postal':'CHIP','row':9,'column':1,'color_value':11},
        {'state_full':'Renville','state_postal':'REN','row':9,'column':2,'color_value':77},
        {'state_full':'McLeod','state_postal':'MCL','row':9,'column':3,'color_value':69},
        {'state_full':'Sibley','state_postal':'SIB','row':9,'column':4,'color_value':80},
        {'state_full':'Carver','state_postal':'CV','row':9,'column':5,'color_value':1},
        {'state_full':'Scott','state_postal':'SCT','row':9,'column':6,'color_value':5},
        {'state_full':'Dakota','state_postal':'DAK','row':9,'column':7,'color_value':2},
        {'state_full':'Goodhue','state_postal':'GOOD','row':9,'column':8,'color_value':62},
        {'state_full':'Lincoln','state_postal':'LIN','row':10,'column':0,'color_value':66},
        {'state_full':'Lyon','state_postal':'LYON','row':10,'column':1,'color_value':67},
        {'state_full':'Redwood','state_postal':'RW','row':10,'column':2,'color_value':76},
        {'state_full':'Brown','state_postal':'BR','row':10,'column':3,'color_value':56},
        {'state_full':'Nicollet','state_postal':'NIC','row':10,'column':4,'color_value':72},
        {'state_full':'Blue Earth','state_postal':'BLUE','row':10,'column':5,'color_value':55},
        {'state_full':'Le Sueur','state_postal':'LS','row':10,'column':6,'color_value':65},
        {'state_full':'Rice','state_postal':'RICE','row':10,'column':7,'color_value':78},
        {'state_full':'Wabasha','state_postal':'WAB','row':10,'column':8,'color_value':82},
        {'state_full':'Pipestone','state_postal':'PS','row':11,'column':0,'color_value':75},
        {'state_full':'Murray','state_postal':'MURR','row':11,'column':1,'color_value':71},
        {'state_full':'Cottonwood','state_postal':'CW','row':11,'column':2,'color_value':57},
        {'state_full':'Watonwan','state_postal':'WTW','row':11,'column':3,'color_value':84},
        {'state_full':'Waseca','state_postal':'WAS','row':11,'column':4,'color_value':83},
        {'state_full':'Steele','state_postal':'ST','row':11,'column':5,'color_value':81},
        {'state_full':'Dodge','state_postal':'DG','row':11,'column':6,'color_value':58},
        {'state_full':'Olmsted','state_postal':'OLM','row':11,'column':7,'color_value':74},
        {'state_full':'Winona','state_postal':'WIN','row':11,'column':8,'color_value':85},
        {'state_full':'Rock','state_postal':'ROCK','row':12,'column':0,'color_value':79},
        {'state_full':'Nobles','state_postal':'NOB','row':12,'column':1,'color_value':73},
        {'state_full':'Jackson','state_postal':'JACK','row':12,'column':2,'color_value':64},
        {'state_full':'Martin','state_postal':'MART','row':12,'column':3,'color_value':68},
        {'state_full':'Faribault','state_postal':'FB','row':12,'column':4,'color_value':59},
        {'state_full':'Freeborn','state_postal':'FREE','row':12,'column':5,'color_value':61},
        {'state_full':'Mower','state_postal':'MOW','row':12,'column':6,'color_value':70},
        {'state_full':'Fillmore','state_postal':'FILL','row':12,'column':7,'color_value':60},
        {'state_full':'Houston','state_postal':'HOU','row':12,'column':8,'color_value':63}
        ]

};

jQuery(document).ready(function() {
    cartogram8.init();
});

if (!isNaN(dayton_percent)){
jQuery("#voteCounts_mngov_d").html(Math.floor(dayton_percent * 100) + "%");
jQuery("#voteCounts_mngov_j").html(Math.floor(johnson_percent * 100) + "%");
jQuery("#voteCounts_mngov_dv").html("Votes: " + votes_all1_mngov);
jQuery("#voteCounts_mngov_rv").html("Votes: " + votes_all2_mngov);
}
else{
jQuery("#voteCounts_mngov_d").html("0%");
jQuery("#voteCounts_mngov_j").html("0%");
}
jQuery("#voteCounts_mngov_p").html("Precincts Reporting: " + precinct_overall_mngov);

            //});

 });


</script>

<script>
//MN SENATE LIVE MAPS

jQuery.getJSON('http://data-layer-elections.startribune.com/api/v1/cached/crosstab/ussenate-by-county/', function(json2) {
              
jQuery( "#target-sen" ).empty();

//LOAD DATA AND COLOR VARIABLES
var county_mnsen = [];
var precinct_mnsen = [];
var candidate1_mnsen = [];
var candidate2_mnsen = [];
var votes_count1_mnsen = [];
var votes_count2_mnsen = [];
var votes_percent1_mnsen = [];
var votes_percent2_mnsen = [];
var precinct_overall_mnsen = 0;
var votes_all1_mnsen = 0;
var votes_all2_mnsen = 0;
var precinct_overall_mnsen = 0;
var votes_all1_mnsen = 0;
var votes_all2_mnsen = 0;
var votes_other_mnsen = 0;
var votes_all3_mnsen = 0;
var votes_all4_mnsen = 0;

dfl_safe = "#506fb3";
gop_safe = "#d46354";
dfl_lean = "#8493c8";
gop_lean = "#f48072";
basecolor = "#ddd";

           for ( var i = 0; i < 87; i++ ) {
county_mnsen[i] = json2.results[i]['name'];
precinct_mnsen[i] = Number(json2.results[i]['percent_of_precincts']);
candidate1_mnsen[i] = json2.results[i]['candidates'][1]['name'];
candidate2_mnsen[i] = json2.results[i]['candidates'][3]['name'];
votes_count1_mnsen[i] = Number(json2.results[i]['candidates'][1]['votes']);
votes_count2_mnsen[i] = Number(json2.results[i]['candidates'][3]['votes']);
votes_percent1_mnsen[i] = Number(json2.results[i]['candidates'][1]['percent_of_votes']);
votes_percent2_mnsen[i] = Number(json2.results[i]['candidates'][3]['percent_of_votes']);
precinct_overall_mnsen = precinct_mnsen[i] + precinct_overall_mnsen;
votes_all1_mnsen = votes_count1_mnsen[i] + votes_all1_mnsen;
votes_all2_mnsen = votes_count2_mnsen[i] + votes_all2_mnsen;
votes_all3_mnsen = Number(json2.results[i]['candidates'][0]['votes']) + votes_all3_mnsen;
votes_all4_mnsen = Number(json2.results[i]['candidates'][2]['votes']) + votes_all4_mnsen;
votes_other_mnsen = (Number(json2.results[i]['candidates'][0]['votes']) + Number(json2.results[i]['candidates'][2]['votes'])) + votes_other_mnsen; 
                    }

var total_votes_mnsen = votes_all1_mnsen + votes_all2_mnsen + votes_other_mnsen;
var franken_percent = votes_all1_mnsen / total_votes_mnsen;
var mcfadden_percent = votes_all2_mnsen / total_votes_mnsen;
var carlson_percent = votes_all3_mnsen / total_votes_mnsen;
var johnson_percent = votes_all4_mnsen / total_votes_mnsen;

var results_mnsen = [];

results_mnsen[0] = franken_percent;
results_mnsen[1] = carlson_percent;
results_mnsen[2] = johnson_percent;
results_mnsen[3] = mcfadden_percent;

var results_json_mnsen = JSON.stringify(results_mnsen);

var projection7 = d3.geo.mercator().scale([9200]).center([-78.4500,42.6000]);
// var projection7 = d3.geo.mercator().scale([17000]).center([-87.9565,45.6524]);
var path7 = d3.geo.path().projection(projection7);
var svg7 = d3.select("#map-sen svg");

var projection12 = d3.geo.mercator().scale([45000]).center([-90.3400,44.240]);
// var projection7 = d3.geo.mercator().scale([17000]).center([-87.9565,45.6524]);
var path12 = d3.geo.path().projection(projection12);
var svg12 = d3.select("#map-sen3 svg");


//MN SENATE MAP
d3.json("http://www.startribune.com/includes/mncounties.json", function(json) {
        svg7.selectAll("path")
           .data(json.features)
           .enter()
           .append("path")
           .attr("d", path7)
           .attr("stroke-width", .5)
           .style("stroke", "white")
           .style("fill", function(d) {
    var j = Number(d.properties.INDEX);
if (precinct_mnsen[j] > 20){
                    if (votes_count1_mnsen[j] > votes_count2_mnsen[j] && precinct_mnsen[j] == 100) {
                                     return dfl_safe;
                                }
                    else if (votes_count1_mnsen[j] < votes_count2_mnsen[j] && precinct_mnsen[j] == 100) {
                                     return gop_safe;
                                }
                    else if (votes_count1_mnsen[j] > votes_count2_mnsen[j] && precinct_mnsen[j] < 100) {
                                     return dfl_lean;
                                }
                    else if (votes_count1_mnsen[j] < votes_count2_mnsen[j] && precinct_mnsen[j] < 100) {
                                     return gop_lean;
                                }
                      else {
                                 return basecolor;
                                }
}
                     else {
                                 return basecolor;
                                }
                  })
             .call(d3.helper.tooltip(
        function(d){
          var j = Number(d.properties.INDEX);
          return "<div class='districts'><b>"+ county_mnsen[j] + "</b></div><hr><div class='candidates'><b>Al " + candidate1_mnsen[j] + " (D)*</b></div><div class='percentages'>" + votes_percent1_mnsen[j] + "%</div><br /><div class='candidates'>Mike " + candidate2_mnsen[j] + " (R)</div><div class='percentages'>" + votes_percent2_mnsen[j] + "%</div><hr class='secondHR'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + precinct_mnsen[j] + "%</div>";
                      }
        ));
 });

//METRO MAP
d3.json("http://www.startribune.com/includes/metro.json", function(json) {
        svg12.selectAll("path")
           .data(json.features)
           .enter()
           .append("path")
           .attr("d", path12)
           .attr("stroke-width", .5)
           .style("stroke", "white")
           .style("fill", function(d) {
    var j = Number(d.properties.INDEX);
if (precinct_mnsen[j] > 20){
                    if (votes_count1_mnsen[j] > votes_count2_mnsen[j] && precinct_mnsen[j] == 100) {
                                     return dfl_safe;
                                }
                    else if (votes_count1_mnsen[j] < votes_count2_mnsen[j] && precinct_mnsen[j] == 100) {
                                     return gop_safe;
                                }
                    else if (votes_count1_mnsen[j] > votes_count2_mnsen[j] && precinct_mnsen[j] < 100) {
                                     return dfl_lean;
                                }
                    else if (votes_count1_mnsen[j] < votes_count2_mnsen[j] && precinct_mnsen[j] < 100) {
                                     return gop_lean;
                                }
}
                     else {
                                 return basecolor;
                                }
                  })
             .call(d3.helper.tooltip(
        function(d){
          var j = Number(d.properties.INDEX);
          return "<div class='districts'><b>"+ county_mnsen[j] + "</b></div><hr><div class='candidates'><b>Al " + candidate1_mnsen[j] + " (D)*</b></div><div class='percentages'>" + votes_percent1_mnsen[j] + "%</div><br /><div class='candidates'>Mike " + candidate2_mnsen[j] + " (R)</div><div class='percentages'>" + votes_percent2_mnsen[j] + "%</div><hr class='secondHR'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + precinct_mnsen[j] + "%</div>";
                      }
        ));
 });


//MN SENATE CARTOGRAM
var cartogram7 = {
    margin: {
        top: 25,
        right: 0,
        bottom: 0,
        left: 10
    },

    selector: '#target-sen',

    init: function() {
        var self = this;

        self.jQueryel = jQuery(self.selector);

        self.width = 175 - self.margin.left - self.margin.right;
        self.height = 130 - self.margin.top - self.margin.bottom;

        self.svg = d3.select(self.selector).append('svg')
            .attr('height', self.height + self.margin.top + self.margin.bottom)
            .attr('width', self.width + self.margin.left + self.margin.right)

        self.state_size = self.width / 12;
        self.state_padding = 2;

        self.map = self.svg.append('g')
            .attr('transform', 'translate(' + self.margin.left + ','
                  + self.margin.top + ')')

        self.drawMap();
    },

    drawMap: function() {
        var self = this;

        var states = self.map.selectAll('.states')
            .data(self.state_pos_co)
            .enter().append('g')
            .attr('class', 'state-groups');

        var state = states.append('rect')
            .attr('id', function(d) {
                return d.state_postal + "-mnsen";
            })
            .attr('class', 'state')
            .attr('rx', 2)
            .attr('ry', 2)
            .attr('x', function(d) {
                return d.column * (self.state_size + self.state_padding);
            })
            .attr('y', function(d) {
                return d.row * (self.state_size + self.state_padding);
            })
            .attr('width', self.state_size)
            .attr('height', self.state_size)
            .attr('class', function(d) {
                     var j = d.color_value;
                     if (votes_count1_mnsen[j] > votes_count2_mnsen[j] && precinct_mnsen[j] == 100) {
                                     return 'dfl_safe';
                                }
                     else if (votes_count1_mnsen[j] < votes_count2_mnsen[j] && precinct_mnsen[j] == 100) {
                                     return 'gop_safe';
                                }
                     if (votes_count1_mnsen[j] > votes_count2_mnsen[j] && precinct_mnsen[j] < 100) {
                                     return 'dfl_lean';
                                }
                     else if (votes_count1_mnsen[j] < votes_count2_mnsen[j] && precinct_mnsen[j] < 100) {
                                     return 'gop_lean';
                                }
                     else {
                                 return 'nothing';
                                }
            })
             .call(d3.helper.tooltip(
        function(d){
          var j = d.color_value;
          return "<div class='districts'><b>"+ county_mnsen[j] + "</b></div><hr><div class='candidates'><b>Al " + candidate1_mnsen[j] + " (D)*</b></div><div class='percentages'>" + votes_percent1_mnsen[j] + "%</div><br /><div class='candidates'>Mike " + candidate2_mnsen[j] + " (R)</div><div class='percentages'>" + votes_percent2_mnsen[j] + "%</div><hr class='secondHR'>" + "<div class='candidates'>Precincts reporting: </div><div class='percentages'>" + precinct_mnsen[j] + "%</div>";
                      }
        ));

        var text = states.append('text')
            .attr('class', 'state-label')
            .attr('dominant-baseline', 'central')
            .attr('x', function(d) {
                return (d.column * (self.state_size + self.state_padding))
                        + self.state_size / 2; })
            .attr('y', function(d) {
                return (d.row * (self.state_size + self.state_padding))
                    + self.state_size / 2; })
            .style('text-anchor', 'middle')
          //  .text(function(d) {
          //      return d.state_postal;
          //  });
    },

    state_pos_co: [{'state_full':'Kittson','state_postal':'KITT','row':0,'column':0,'color_value':46},
        {'state_full':'Lake of the Woods','state_postal':'LW','row':-1,'column':1,'color_value':47},
        {'state_full':'Roseau','state_postal':'ROS','row':0,'column':1,'color_value':54},
        {'state_full':'Koochiching','state_postal':'KOO','row':0,'column':2,'color_value':38},
        {'state_full':'Saint Louis','state_postal':'STL','row':0,'column':3,'color_value':40},
        {'state_full':'Lake','state_postal':'LAKE','row':0,'column':4,'color_value':39},
        {'state_full':'Cook','state_postal':'COOK','row':0,'column':5,'color_value':36},
        {'state_full':'Marshall','state_postal':'MAR','row':1,'column':0,'color_value':49},
        {'state_full':'Beltrami','state_postal':'BEL','row':1,'column':1,'color_value':42},
        {'state_full':'Itasca','state_postal':'ITAS','row':1,'column':2,'color_value':37},
        {'state_full':'Aitkin','state_postal':'AITK','row':1,'column':3,'color_value':7},
        {'state_full':'Carlton','state_postal':'CARL','row':1,'column':4,'color_value':35},
        {'state_full':'Polk','state_postal':'POLK','row':2,'column':0,'color_value':52},
        {'state_full':'Pennington','state_postal':'PENN','row':2,'column':1,'color_value':51},
        {'state_full':'Red Lake','state_postal':'RL','row':2,'column':2,'color_value':53},
        {'state_full':'Clearwater','state_postal':'CW','row':2,'column':3,'color_value':44},
        {'state_full':'Hubbard','state_postal':'HUB','row':2,'column':4,'color_value':45},
        {'state_full':'Norman','state_postal':'NORM','row':3,'column':0,'color_value':50},
        {'state_full':'Mahnomen','state_postal':'MAHN','row':3,'column':1,'color_value':48},
        {'state_full':'Cass','state_postal':'CASS','row':3,'column':2,'color_value':10},
        {'state_full':'Crow Wing','state_postal':'CROW','row':3,'column':3,'color_value':13},
        {'state_full':'Pine','state_postal':'PINE','row':3,'column':4,'color_value':24},
        {'state_full':'Clay','state_postal':'CLAY','row':4,'column':0,'color_value':43},
        {'state_full':'Becker','state_postal':'BECK','row':4,'column':1,'color_value':41},
        {'state_full':'Wadena','state_postal':'WAD','row':4,'column':2,'color_value':32},
        {'state_full':'Mille Lacs','state_postal':'ML','row':4,'column':3,'color_value':21},
        {'state_full':'Kanabec','state_postal':'KANA','row':4,'column':4,'color_value':17},
        {'state_full':'Wilkin','state_postal':'WILK','row':5,'column':0,'color_value':33},
        {'state_full':'Ottertail','state_postal':'OT','row':5,'column':1,'color_value':23},
        {'state_full':'Todd','state_postal':'TODD','row':5,'column':2,'color_value':30},
        {'state_full':'Morrison','state_postal':'MORR','row':5,'column':3,'color_value':22},
        {'state_full':'Benton','state_postal':'BEN','row':5,'column':4,'color_value':8},
        {'state_full':'Traverse','state_postal':'TRAV','row':6,'column':0,'color_value':31},
        {'state_full':'Grant','state_postal':'GRANT','row':6,'column':1,'color_value':15},
        {'state_full':'Douglas','state_postal':'DOUG','row':6,'column':2,'color_value':14},
        {'state_full':'Stearns','state_postal':'STRNS','row':6,'column':3,'color_value':27},
        {'state_full':'Isanti','state_postal':'ISA','row':6,'column':4,'color_value':16},
        {'state_full':'Big Stone','state_postal':'BIG','row':7,'column':0,'color_value':9},
        {'state_full':'Stevens','state_postal':'STEVE','row':7,'column':1,'color_value':28},
        {'state_full':'Pope','state_postal':'POP','row':7,'column':2,'color_value':25},
        {'state_full':'Sherburne','state_postal':'SB','row':7,'column':3,'color_value':26},
        {'state_full':'Anoka','state_postal':'AK','row':7,'column':4,'color_value':0},
        {'state_full':'Chisago','state_postal':'CHIS','row':7,'column':5,'color_value':12},
        {'state_full':'Lac qui Parle','state_postal':'LAC','row':8,'column':0,'color_value':19},
        {'state_full':'Swift','state_postal':'SWIFT','row':8,'column':1,'color_value':29},
        {'state_full':'Kandiyohi','state_postal':'KAN','row':8,'column':2,'color_value':18},
        {'state_full':'Meeker','state_postal':'MEEK','row':8,'column':3,'color_value':20},
        {'state_full':'Wright','state_postal':'WR','row':8,'column':4,'color_value':34},
        {'state_full':'Hennepin','state_postal':'HENN','row':8,'column':5,'color_value':3},
        {'state_full':'Ramsey','state_postal':'RAM','row':8,'column':6,'color_value':4},
        {'state_full':'Washington','state_postal':'WA','row':8,'column':7,'color_value':6},
        {'state_full':'Yellow Medicine','state_postal':'YM','row':9,'column':0,'color_value':86},
        {'state_full':'Chippewa','state_postal':'CHIP','row':9,'column':1,'color_value':11},
        {'state_full':'Renville','state_postal':'REN','row':9,'column':2,'color_value':77},
        {'state_full':'McLeod','state_postal':'MCL','row':9,'column':3,'color_value':69},
        {'state_full':'Sibley','state_postal':'SIB','row':9,'column':4,'color_value':80},
        {'state_full':'Carver','state_postal':'CV','row':9,'column':5,'color_value':1},
        {'state_full':'Scott','state_postal':'SCT','row':9,'column':6,'color_value':5},
        {'state_full':'Dakota','state_postal':'DAK','row':9,'column':7,'color_value':2},
        {'state_full':'Goodhue','state_postal':'GOOD','row':9,'column':8,'color_value':62},
        {'state_full':'Lincoln','state_postal':'LIN','row':10,'column':0,'color_value':66},
        {'state_full':'Lyon','state_postal':'LYON','row':10,'column':1,'color_value':67},
        {'state_full':'Redwood','state_postal':'RW','row':10,'column':2,'color_value':76},
        {'state_full':'Brown','state_postal':'BR','row':10,'column':3,'color_value':56},
        {'state_full':'Nicollet','state_postal':'NIC','row':10,'column':4,'color_value':72},
        {'state_full':'Blue Earth','state_postal':'BLUE','row':10,'column':5,'color_value':55},
        {'state_full':'Le Sueur','state_postal':'LS','row':10,'column':6,'color_value':65},
        {'state_full':'Rice','state_postal':'RICE','row':10,'column':7,'color_value':78},
        {'state_full':'Wabasha','state_postal':'WAB','row':10,'column':8,'color_value':82},
        {'state_full':'Pipestone','state_postal':'PS','row':11,'column':0,'color_value':75},
        {'state_full':'Murray','state_postal':'MURR','row':11,'column':1,'color_value':71},
        {'state_full':'Cottonwood','state_postal':'CW','row':11,'column':2,'color_value':57},
        {'state_full':'Watonwan','state_postal':'WTW','row':11,'column':3,'color_value':84},
        {'state_full':'Waseca','state_postal':'WAS','row':11,'column':4,'color_value':83},
        {'state_full':'Steele','state_postal':'ST','row':11,'column':5,'color_value':81},
        {'state_full':'Dodge','state_postal':'DG','row':11,'column':6,'color_value':58},
        {'state_full':'Olmsted','state_postal':'OLM','row':11,'column':7,'color_value':74},
        {'state_full':'Winona','state_postal':'WIN','row':11,'column':8,'color_value':85},
        {'state_full':'Rock','state_postal':'ROCK','row':12,'column':0,'color_value':79},
        {'state_full':'Nobles','state_postal':'NOB','row':12,'column':1,'color_value':73},
        {'state_full':'Jackson','state_postal':'JACK','row':12,'column':2,'color_value':64},
        {'state_full':'Martin','state_postal':'MART','row':12,'column':3,'color_value':68},
        {'state_full':'Faribault','state_postal':'FB','row':12,'column':4,'color_value':59},
        {'state_full':'Freeborn','state_postal':'FREE','row':12,'column':5,'color_value':61},
        {'state_full':'Mower','state_postal':'MOW','row':12,'column':6,'color_value':70},
        {'state_full':'Fillmore','state_postal':'FILL','row':12,'column':7,'color_value':60},
        {'state_full':'Houston','state_postal':'HOU','row':12,'column':8,'color_value':63}
        ]

};

jQuery(document).ready(function() {
   cartogram7.init();
});

if (!isNaN(franken_percent)){
jQuery("#voteCounts_mnsen_f").html(Math.floor(franken_percent * 100) + "%");
jQuery("#voteCounts_mnsen_m").html(Math.floor(mcfadden_percent * 100) + "%");
jQuery("#voteCounts_mnsen_d").html("Votes: " + votes_all1_mnsen);
jQuery("#voteCounts_mnsen_r").html("Votes: " + votes_all2_mnsen);
}
else{
jQuery("#voteCounts_mnsen_f").html("0%");
jQuery("#voteCounts_mnsen_m").html("0%");
}
jQuery("#voteCounts_mnsen_p").html("Precincts Reporting: " + precinct_overall_mnsen);

console.log("HALP");
            //});

 });
</script>

<script>
jQuery.getJSON('http://www.startribune.com/templates/HouseBalance.json', function(json2) {

var d_safe_count_mnleg = json2[0]['value'];
var r_safe_count_mnleg = json2[4]['value'];

jQuery("#voteCounts_mnleg_d").html(d_safe_count_mnleg);
jQuery("#voteCounts_mnleg_r").html(r_safe_count_mnleg);

 });

jQuery.getJSON('http://www.startribune.com/templates/SenateBalance.json', function(json2) {

var d_safe_count_ussen = json2[0]['value'];
var r_safe_count_ussen = json2[4]['value'];

jQuery("#voteCounts_ussen_d").html(d_safe_count_ussen);
jQuery("#voteCounts_ussen_r").html(r_safe_count_ussen);

 });

jQuery.getJSON('http://www.startribune.com/includes/usgov2014.json', function(json2) {

var d_safe_count_usgov = json2[0]['value'];
var r_safe_count_usgov = json2[4]['value'];

jQuery("#voteCounts_usgov_d").html(d_safe_count_usgov);
jQuery("#voteCounts_usgov_r").html(r_safe_count_usgov);

 });

jQuery.getJSON('http://www.startribune.com/includes/ushouse2014.json', function(json2) {

var d_safe_count_ushouse = json2[0]['value'];
var r_safe_count_ushouse = json2[4]['value'];

jQuery("#voteCounts_ushouse_d").html(d_safe_count_ushouse);
jQuery("#voteCounts_ushouse_r").html(r_safe_count_ushouse);

 });


</script>

<script>
//TOOLTIP STUFF
d3.helper = {};

d3.helper.tooltip2 = function(accessor){
    return function(selection){
        var tooltipDiv;
        var bodyNode = d3.select('body').node();
        selection.on("click", function(d, i){
            selection.style('opacity', '0.5');
            // Clean up lost tooltips
            d3.select('body').selectAll('div.tooltip').remove();
            // Append tooltip
            tooltipDiv = d3.select('body').append('div').attr('class', 'tooltip');
            var absoluteMousePos = d3.mouse(bodyNode);
            tooltipDiv.style('left', '377px')
                .style('top', '20px')
                .style('position', 'absolute') 
                .style('z-index', 1001);
            // Add text using the accessor function
            var tooltipText = accessor(d, i) || '';
            // Crop text arbitrarily
            //tooltipDiv.style('width', function(d, i){return (tooltipText.length > 80) ? '300px' : null;})
            //    .html(tooltipText);            
        })
        .on('mousemove', function(d, i) {
            // Move tooltip
            var absoluteMousePos = d3.mouse(bodyNode);
            tooltipDiv.style('left', '377px')
                .style('top', '20px')
            var tooltipText = accessor(d, i) || '';
            tooltipDiv.html(tooltipText);
        })
        .on("mouseout", function(d, i){
            // Remove tooltip
           // tooltipDiv.remove();
        });
    };
};

d3.helper.tooltip = function(accessor){
    return function(selection){
        var tooltipDiv;
        var bodyNode = d3.select('body').node();
        selection.on("mouseover", function(d, i){
            // Clean up lost tooltips
            d3.select('body').selectAll('div.tooltip').remove();
            // Append tooltip
            tooltipDiv = d3.select('body').append('div').attr('class', 'tooltip');
            var absoluteMousePos = d3.mouse(bodyNode);
            tooltipDiv.style('left', (absoluteMousePos[0] + 10)+'px')
                .style('top', (absoluteMousePos[1] - 15)+'px')
                .style('position', 'absolute') 
                .style('z-index', 1001);
            // Add text using the accessor function
            var tooltipText = accessor(d, i) || '';
            // Crop text arbitrarily
            //tooltipDiv.style('width', function(d, i){return (tooltipText.length > 80) ? '300px' : null;})
            //    .html(tooltipText);
        })
        .on('mousemove', function(d, i) {
            // Move tooltip
            var absoluteMousePos = d3.mouse(bodyNode);
            tooltipDiv.style('left', (absoluteMousePos[0] + 10)+'px')
                .style('top', (absoluteMousePos[1] - 15)+'px')
            var tooltipText = accessor(d, i) || '';
            tooltipDiv.html(tooltipText);
        })
        .on("mouseout", function(d, i){
            // Remove tooltip
            tooltipDiv.remove();
        });
    };
};

function update(stuff){
 
var factor3 = stuff;

return factor3;
                               
}
</script>

<script>
var redrawGraph = function(data2, theline) {

  var d1Text= [
   'DAYTON - D',
   'FRANKEN - D',
   'DEM',
   'DEMOCRAT',
   'DEMOCRAT',
   'DEMOCRAT'
  ];

  jQuery("#can1").text(d1Text[theline]);
  jQuery("#d-can").html(d1Text[theline]);

  var d2Text= [
   "JOHNSON - R",
   "McFADDEN - R",
   "GOP",
   "REPUBLICAN",
   "REPUBLICAN",
   "REPUBLICAN"
  ];

  jQuery("#can2").text(d2Text[theline]);
  jQuery("#r-can").text(d2Text[theline]);

  var titleText= [
   'GOVERNOR OF MINNESOTA',
   'U.S. SENATOR FROM MINNESOTA',
   'MINNESOTA HOUSE OF REPRESENTATIVES',
   'U.S. HOUSE OF REPRESENTATIVES - MINNESOTA',
   'U.S. SENATE - NATIONWIDE',
   'STATE GOVERNORS - NATIONWIDE'
  ];

  jQuery("#title").text(titleText[theline]);
  jQuery("#d-can").html(d1Text[theline]);

};
</script>

<script>
var mngovData = "http://www.startribune.com/includes/mngov2014.json";
var mnsenData = "http://www.startribune.com/includes/mnsen2014.json";
var mnlegData = "http://www.startribune.com/templates/HouseBalance.json";
var usgovData = "http://www.startribune.com/includes/usgov2014.json";
var ussenData = "http://www.startribune.com/templates/SenateBalance.json";
var ushouseData = "http://www.startribune.com/includes/ushouse2014.json";

updateIt(mngovData);

function updateIt(results){
//POWER BAR
d3.json(results, function(json) {

nv.addGraph(function() {
  var chart0 = nv.models.pieChart()
      .x(function(d) { return d.label })
      .y(function(d) { return d.value })
      .showLegend(false)
      .valueFormat(d3.format('d'))
      .showLabels(false)     //Display pie labels
      .labelThreshold(.05)  //Configure the minimum slice size for labels to show up
      .labelType("key") //Configure what type of data to show in the label. Can be "key", "value" or "percent"
      .donut(true)          //Turn on Donut mode. Makes pie chart look tasty!
      .donutRatio(0.35)     //Configure how big you want the donut hole size to be.
      .tooltipContent(function(key, y, e, graph) { if (key == 'Dayton' || key == 'Johnson' || key == 'Franken' || key == 'McFadden') { return  '<strong>' + key + ': ' + y + '%</strong>'; } else {  return  '<strong>' + key + ': ' + y + '</strong>'; } })
      .color(['#506fb3', '#8493c8','#ddd','#f48072', '#d46354', '#666'])
      .width(210)
      .height(210)
      .margin({top:-5,right:5,bottom:10,left:-25})
      ;

chart0.pie
    .startAngle(function(d) { return d.startAngle/2 -Math.PI/2; })
    .endAngle(function(d) { return d.endAngle/2 -Math.PI/2 ;});

    d3.select("#tracker svg")
        .datum(json)
        .transition().duration(350)
        .call(chart0);

nv.utils.windowResize(chart0.update)

  return chart0;
});
});
}

</script>

<script>
function setVisibility(id, visibility) {
document.getElementById(id).style.display = visibility;
}
            function set2(){
function setVisibility(id, visibility) {
document.getElementById(id).style.display = visibility;
}
setVisibility('target-leg', 'none');setVisibility('map-leg', 'none');setVisibility('target-leg2', 'none');setVisibility('map-leg2', 'none');setVisibility('target-rep', 'none');setVisibility('map-rep', 'none');setVisibility('target-rep2', 'none');setVisibility('map-rep2', 'none');setVisibility('target-sen', 'block');setVisibility('map-sen', 'block');setVisibility('target-sen2', 'none');setVisibility('map-sen2', 'none');setVisibility('target-gov', 'none');setVisibility('map-gov', 'none');setVisibility('target-gov2', 'none');setVisibility('map-gov2', 'none');setVisibility('voteCounts_mnsen_f', 'block');setVisibility('voteCounts_mnsen_m', 'block');setVisibility('voteCounts_mnsen_d', 'block');setVisibility('voteCounts_mnsen_r', 'block');setVisibility('voteCounts_mngov_d', 'none');setVisibility('voteCounts_mngov_j', 'none');setVisibility('voteCounts_mngov_dv', 'none');setVisibility('voteCounts_mngov_rv', 'none');setVisibility('voteCounts_ussen_d', 'none');setVisibility('voteCounts_ussen_r', 'none');setVisibility('voteCounts_mnleg_d', 'none');setVisibility('voteCounts_mnleg_r', 'none');setVisibility('voteCounts_usgov_d', 'none');setVisibility('voteCounts_usgov_r', 'none');setVisibility('voteCounts_mnsen_p', 'block');setVisibility('voteCounts_mngov_p', 'none');setVisibility('voteCounts_ushouse_d', 'none');setVisibility('voteCounts_ushouse_r', 'none');setVisibility('map-sen3', 'block');setVisibility('map-gov3', 'none');setVisibility('daytonImg', 'none');setVisibility('frankenImg', 'block');setVisibility('mcfaddenImg', 'block');setVisibility('johnsonImg', 'none');setVisibility('balanceOfPower', 'none');redrawGraph(mnsenData,1);updateIt(mnsenData);
            }
            function set3(){
function setVisibility(id, visibility) {
document.getElementById(id).style.display = visibility;
}
setVisibility('target-leg', 'block');setVisibility('map-leg', 'block');setVisibility('target-leg2', 'block');setVisibility('map-leg2', 'block');setVisibility('target-rep', 'none');setVisibility('map-rep', 'none');setVisibility('target-rep2', 'none');setVisibility('map-rep2', 'none');setVisibility('target-sen', 'none');setVisibility('map-sen', 'none');setVisibility('target-sen2', 'none');setVisibility('map-sen2', 'none');setVisibility('target-gov', 'none');setVisibility('map-gov', 'none');setVisibility('target-gov2', 'none');setVisibility('map-gov2', 'none');setVisibility('voteCounts_mnsen_f', 'none');setVisibility('voteCounts_mnsen_m', 'none');setVisibility('voteCounts_mnsen_d', 'none');setVisibility('voteCounts_mnsen_r', 'none');setVisibility('voteCounts_mngov_d', 'none');setVisibility('voteCounts_mngov_j', 'none');setVisibility('voteCounts_mngov_dv', 'none');setVisibility('voteCounts_mngov_rv', 'none');setVisibility('voteCounts_ussen_d', 'none');setVisibility('voteCounts_ussen_r', 'none');setVisibility('voteCounts_mnleg_d', 'block');setVisibility('voteCounts_mnleg_r', 'block');setVisibility('voteCounts_usgov_d', 'none');setVisibility('voteCounts_usgov_r', 'none');setVisibility('voteCounts_mnsen_p', 'none');setVisibility('voteCounts_mngov_p', 'none');setVisibility('voteCounts_ushouse_d', 'none');setVisibility('voteCounts_ushouse_r', 'none');setVisibility('map-sen3', 'none');setVisibility('map-gov3', 'none');setVisibility('daytonImg', 'none');setVisibility('frankenImg', 'none');setVisibility('mcfaddenImg', 'none');setVisibility('johnsonImg', 'none');setVisibility('balanceOfPower', 'block');redrawGraph(mnlegData,2);updateIt(mnlegData);
            }
            function set4(){
function setVisibility(id, visibility) {
document.getElementById(id).style.display = visibility;
}
setVisibility('target-leg', 'none');setVisibility('map-leg', 'none');setVisibility('target-leg2', 'none');setVisibility('map-leg2', 'none');setVisibility('target-rep', 'block');setVisibility('map-rep', 'block');setVisibility('target-rep2', 'none');setVisibility('map-rep2', 'none');setVisibility('target-sen', 'none');setVisibility('map-sen', 'none');setVisibility('target-sen2', 'none');setVisibility('map-sen2', 'none');setVisibility('target-gov', 'none');setVisibility('map-gov', 'none');setVisibility('target-gov2', 'none');setVisibility('map-gov2', 'none');setVisibility('voteCounts_mnsen_f', 'none');setVisibility('voteCounts_mnsen_m', 'none');setVisibility('voteCounts_mnsen_d', 'none');setVisibility('voteCounts_mnsen_r', 'none');setVisibility('voteCounts_mngov_d', 'none');setVisibility('voteCounts_mngov_j', 'none');setVisibility('voteCounts_mngov_dv', 'none');setVisibility('voteCounts_mngov_rv', 'none');setVisibility('voteCounts_ussen_d', 'none');setVisibility('voteCounts_ussen_r', 'none');setVisibility('voteCounts_mnleg_d', 'none');setVisibility('voteCounts_mnleg_r', 'none');setVisibility('voteCounts_usgov_d', 'none');setVisibility('voteCounts_usgov_r', 'none');setVisibility('voteCounts_mnsen_p', 'none');setVisibility('voteCounts_mngov_p', 'none');setVisibility('voteCounts_ushouse_d', 'block');setVisibility('voteCounts_ushouse_r', 'block');setVisibility('map-sen3', 'none');setVisibility('map-gov3', 'none');setVisibility('daytonImg', 'none');setVisibility('frankenImg', 'none');setVisibility('mcfaddenImg', 'none');setVisibility('johnsonImg', 'none');setVisibility('balanceOfPower', 'block');redrawGraph(ushouseData,3);updateIt(ushouseData);
            }
            function set5(){
function setVisibility(id, visibility) {
document.getElementById(id).style.display = visibility;
}
setVisibility('target-leg', 'none');setVisibility('map-leg', 'none');setVisibility('target-leg2', 'none');setVisibility('map-leg2', 'none');setVisibility('target-rep', 'none');setVisibility('map-rep', 'none');setVisibility('target-rep2', 'none');setVisibility('map-rep2', 'none');setVisibility('target-sen', 'none');setVisibility('map-sen', 'none');setVisibility('target-sen2', 'block');setVisibility('map-sen2', 'block');setVisibility('target-gov', 'none');setVisibility('map-gov', 'none');setVisibility('target-gov2', 'none');setVisibility('map-gov2', 'none');setVisibility('voteCounts_mnsen_f', 'none');setVisibility('voteCounts_mnsen_m', 'none');setVisibility('voteCounts_mnsen_d', 'none');setVisibility('voteCounts_mnsen_r', 'none');setVisibility('voteCounts_mngov_d', 'none');setVisibility('voteCounts_mngov_j', 'none');setVisibility('voteCounts_mngov_dv', 'none');setVisibility('voteCounts_mngov_rv', 'none');setVisibility('voteCounts_ussen_d', 'block');setVisibility('voteCounts_ussen_r', 'block');setVisibility('voteCounts_mnleg_d', 'none');setVisibility('voteCounts_mnleg_r', 'none');setVisibility('voteCounts_usgov_d', 'none');setVisibility('voteCounts_usgov_r', 'none');setVisibility('voteCounts_mnsen_p', 'none');setVisibility('voteCounts_mngov_p', 'none');setVisibility('voteCounts_ushouse_d', 'none');setVisibility('voteCounts_ushouse_r', 'none');setVisibility('map-sen3', 'none');setVisibility('map-gov3', 'none');setVisibility('daytonImg', 'none');setVisibility('frankenImg', 'none');setVisibility('mcfaddenImg', 'none');setVisibility('johnsonImg', 'none');setVisibility('balanceOfPower', 'block');redrawGraph(ussenData,4);updateIt(ussenData);
            }
            function set6(){
function setVisibility(id, visibility) {
document.getElementById(id).style.display = visibility;
}
setVisibility('target-leg', 'none');setVisibility('map-leg', 'none');setVisibility('target-leg2', 'none');setVisibility('map-leg2', 'none');setVisibility('target-rep', 'none');setVisibility('map-rep', 'none');setVisibility('target-rep2', 'none');setVisibility('map-rep2', 'none');setVisibility('target-sen', 'none');setVisibility('map-sen', 'none');setVisibility('target-sen2', 'none');setVisibility('map-sen2', 'none');setVisibility('target-gov', 'none');setVisibility('map-gov', 'none');setVisibility('target-gov2', 'block');setVisibility('map-gov2', 'block');setVisibility('voteCounts_mnsen_f', 'none');setVisibility('voteCounts_mnsen_m', 'none');setVisibility('voteCounts_mnsen_d', 'none');setVisibility('voteCounts_mnsen_r', 'none');setVisibility('voteCounts_mngov_d', 'none');setVisibility('voteCounts_mngov_j', 'none');setVisibility('voteCounts_mngov_dv', 'none');setVisibility('voteCounts_mngov_rv', 'none');setVisibility('voteCounts_ussen_d', 'none');setVisibility('voteCounts_ussen_r', 'none');setVisibility('voteCounts_mnleg_d', 'none');setVisibility('voteCounts_mnleg_r', 'none');setVisibility('voteCounts_usgov_d', 'block');setVisibility('voteCounts_usgov_r', 'block');setVisibility('voteCounts_mnsen_p', 'none');setVisibility('voteCounts_mngov_p', 'none');setVisibility('voteCounts_ushouse_d', 'none');setVisibility('voteCounts_ushouse_r', 'none');setVisibility('map-sen3', 'none');setVisibility('map-gov3', 'none');setVisibility('daytonImg', 'none');setVisibility('frankenImg', 'none');setVisibility('mcfaddenImg', 'none');setVisibility('johnsonImg', 'none');setVisibility('balanceOfPower', 'block');redrawGraph(usgovData,5);updateIt(usgovData);
            }
            </script>

            #if($paneNum == "2")
            <script>
            set2();
            </script>
            #elseif($paneNum == "3")
            <script>
            set3();
            </script>
            #elseif($paneNum == "4")
            <script>
            set4();
            </script>
            #elseif($paneNum == "5")
            <script>
            set5();
            </script>
            #elseif($paneNum == "6")
            <script>
            set6();
            </script>
            #end
</script>

