<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Battleground 2016</title>
  <meta name="description" content="Battleground 2016">
  <meta name="author" content="Frey Hargarten - StarTribune">

  <link rel="stylesheet" href="./css/startribune_dataviz_styles.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" />
  
  <!-- ARIANA GRANDE IS NEITHER A FONT NOR A LATTE -->
  <style>
    /* PAGE BASE */
    body { font-family:"Benton Sans",Helvetica,Arial,sans-serif !important; overflow-x:hidden !important; }
    p { font-family:"Benton Sans",Helvetica,Arial,sans-serif !important; }
    a { color:#000; }
    a:link { webkit-tap-highlight-color:#1d78af; }
    #wrapper { display:none; height:auto; margin-left:auto; margin-right:auto; text-align:center; width:1080px; }
    .l-elections-wrapper { font-size:1.5em; }
    .l-election-results-header { border-bottom:1px solid #e7e7e7; margin-bottom:2em; padding-bottom:1.5em; padding-top:1em; text-align:center; }
    .group { zoom:1; }
    .section { clear:both; margin:0px; padding:0px; }
    .group:before, .group:after { content:""; display:table; }
    .col { background:#fff; padding:1em 0; text-align:center; }
    .col:first-child { margin-left:0; }
    .span_1_of_3 { width:32.26%; }
    .col { display:block; float:left; margin:1% 0 1% 1.6%; }
    .span_2_of_3 { width:66.13%; }
    .col { display:block; float:left; margin:0 0 0 1.6%; }

    /* SECTION HEADER */
    .resultsBanner { border-bottom:1px solid #e7e7e7; float:left; font-family:"Benton Sans",Helvetica,Arial,sans-serif!important; font-size:.65em; font-weight:700; line-height:100%; margin:0 auto 24px; padding:10px 0 0 0; width:100%; }
    .resultsLogo { float:left; margin:0 18px 0 10px; }
    .resultsLogo h4 { float:left; margin:0; padding:0; }
    h4 { font-weight:bold; }
    .resultsLogoSVG { background:url(http://static.startribune.com/preview/elections-2016/homepage/elex-logo-40.svg),none; background:url(http://stmedia.startribune.com/images/elex-logo-fallback-100.png); background-repeat:no-repeat; background-size:35px 35px; float:right; height:35px; margin:-12px 12px 0 6px; width:35px; }
    .coverageLinks { float:right; margin-right:10px; text-transform:uppercase; }
    .coverageLinks a:hover { color:#999; }

    /* SWITCHES */
    #bottomSwitches { margin-left:auto; margin-right:auto; text-align:center; width:100%; }
    #viewSwitches { border-right:1px solid #ddd; display:inline-block; }
    .switch { background-color:#fff; border:1px solid black; display:inline-block; font-family:"Benton Sans",Helvetica,Arial,sans-serif; font-weight:900; padding:10px; text-align:center; width:24.5%; }
    .switch:hover, .selected2, .mapSwitch:hover, .typeSwitch:hover, .layerSwitch:hover { background-color:#cccccc !important; color:#000 !important; cursor:pointer; opacity:1 !important; }
    .selected3 { color:#000 !important; }
    .typeSwitch, .layerSwitch, .stateSwitch { display:inline-block; margin:5px; opacity:.4; width:60px; }
    .switch img { width:40px; }
    .mapSwitch img, .typeSwitch img, .layerSwitch img, .stateSwitch img { width:100%; }
    #raceSwitcher { float:left; font-size:0.9em; width:20%; }
    .raceSwitch { background:transparent; }

    /* PANES */
    #datavizPane { float:right; width:78%; }
    .dataviz { width:100%; }
    #rightSide { font-size:.8em; width:100%; }
    div#fulldataviz { position:relative; width:100%; }

    /* MAPS */
    .map, .carto { margin-left:auto; margin-right:auto; text-align:center; width:800px; }
    .noclicky { opacity:0.7; pointer-events:none !important; }
    .gone { opacity:0; pointer-events:none !important; }
    rect:hover, text:hover { background-color:#333 !important; cursor:pointer; opacity:.5; }
    #mnhouse .map, #mnhouse .carto, #mnsenate .map, #mnsenate .carto, #mnhouse .map svg, #mnhouse .carto svg, #mnsenate .map svg, #mnsenate .carto svg { display:inline-block; height:600px !important; width:375px !important; }
    .carto, #mnhouse .carto, #mnsenate .carto { display:none; }
    .tooltip { min-width:150px; width:auto !important; }
    .passthrough { font-family:Arial !important; pointer-events:none !important; }
    .sideStates { position:absolute; right:2%; top:240px; }
    .sideStates .block { color:#fff; font-size:0.8em; font-weight:900; height:30px; padding-top:7px; width:30px; }
    .sideStates .block:hover { border:2px solid #333 !important; cursor:pointer; }
    .stateSelect { background-color:#333 !important; }
    .blockSelect { border:2px solid #333 !important; }
    .mapBox { height:600px !important; }
    .zoom { float:right !important; }
    path { stroke-opacity:0.7 !important; }

    /* POWER BAR */
    #partyLabels, #partyBar, #partyCount { width:100%; }
    .bar, .count, .label { display:inline-block; }
    .dlabel, .rlabel { font-size:1.5em; }
    .count { font-size:1.5em; font-weight:900; }
    .backbar { background-color:#cccccc; height:24px; margin:0!important; padding:0 !important; }
    .label { width:48%; }
    .count { width:17%; }
    .bar { height:24px; width:0; }
    .gopLabel, .gopCount, .gopVotes { text-align:right !important; }
    .demsLabel, .demsCount, .demsVotes { text-align:left !important; }
    #demsBar { background-color:#0D4773; }
    #gopBar { background-color:#9C0004; }
    #undBar { background-color:#ddd; }
    #indBar { background-color:#E07242; }
    #dWin { float:left; }
    #rWin { float:right; }
    #indLabel, #undLabel, #indCount, #undCount { text-align:center; }
    #remaining { width:100%; }
    .check { font-size:1.5em; height:20px; width:20px; }
    .demWin { float:left; }
    .gopWin { float:right; }

    /* SWATCHES */
    .republican { background-color:#d34A44; fill:#d34A44 !important; font-weight:bold; pointer-events:all; stroke:#8C1B17 !important; }
    .rlikely { background-color:#A5484D; fill:#A5484D !important; font-weight:bold; pointer-events:all; }
    .rlean { background-color:#f7816E; fill:#f7816E !important; font-weight:bold; pointer-events:all; }
    .democrat { background-color:#3585BC; fill:#3585BC !important; font-weight:bold; pointer-events:all; stroke:#3F88C5 !important; }
    .dlikely { background-color:#5ca5c3; fill:#5ca5c3 !important; font-weight:bold; pointer-events:all; }
    .dlean { background-color:#72A9D6; fill:#72A9D6 !important; font-weight:bold; pointer-events:all; }
    .r1 { background-color:#eca795; color:black !important; fill:#eca795 !important; font-weight:bold; pointer-events:all; }
    .r2 { background-color:#e58970; color:white !important; fill:#e58970 !important; font-weight:bold; pointer-events:all; }
    .r3 { background-color:#df6a4c; color:white !important; fill:#df6a4c !important; font-weight:bold; pointer-events:all; }
    .r4 { background-color:#d84c27; color:white !important; fill:#d84c27 !important; font-weight:bold; pointer-events:all; }
    .r1b { border:1px solid #eca795; color:black !important; fill:#eca795 !important; font-weight:bold; pointer-events:all; }
    .r2b { border:1px solid #e58970; color:black !important; fill:#e58970 !important; font-weight:bold; pointer-events:all; }
    .r3b { border:1px solid #df6a4c; color:black !important; fill:#df6a4c !important; font-weight:bold; pointer-events:all; }
    .r4b { border:1px solid #d84c27; color:black !important; fill:#d84c27 !important; font-weight:bold; pointer-events:all; }
    .mid { background-color:#fff !important; color:#bbb !important; fill:#ddd !important; font-weight:bold; pointer-events:all; }
    .gray3 { color:black !important; }
    .d1 { background-color:#97bedb; color:black !important; fill:#97bedb !important; font-weight:bold; pointer-events:all; }
    .d2 { background-color:#73a7ce; color:black !important; fill:#73a7ce !important; font-weight:bold; pointer-events:all; }
    .d3 { background-color:#4f90c1; color:black !important; fill:#4f90c1 !important; font-weight:bold; pointer-events:all; }
    .d4 { background-color:#2b7ab5; color:black !important; fill:#2b7ab5 !important; font-weight:bold; pointer-events:all; }
    .d1b { border:1px solid #97bedb; color:black !important; fill:#97bedb !important; font-weight:bold; pointer-events:all; }
    .d2b { border:1px solid #73a7ce; color:black !important; fill:#73a7ce !important; font-weight:bold; pointer-events:all; }
    .d3b { border:1px solid #4f90c1; color:black !important; fill:#4f90c1 !important; font-weight:bold; pointer-events:all; }
    .d4b { border:1px solid #2b7ab5; color:black !important; fill:#2b7ab5 !important; font-weight:bold; pointer-events:all; }
    .independent { border:1px solid #66AF50; color:#333 !important; fill:#66AF50; }
    .none { background-color:#cccccc !important; fill:#cccccc !important; }

    /* LEGENDS */
    #legends { float:left; }
    #legendMain { font-size:0.75em; }
    .legendLabel { display:inline-block; height:15px; width:50px; }
    .brick { color:#bbb; display:inline-block; height:10px; width:26px; }
    .partyBlock { display:inline-block; }
    .tinybreak { clear:both; display:block; }
    #legendMargins { display:none; }
    .legendBlock { text-align:left; }
    .smallLabel { font-size:0.8em; text-align:center; }
    .legendLabel { color:#333; font-weight:900; text-align:center; }
    .footnote { clear:both; color:#bbbbbb; display:block; display:none; font-size:0.7em; }

    /* CARTOGRAMS */
    .dem rect { fill:#3F88C5 !important; }
    .rep rect { fill:#D90429 !important; }
    .battleground rect { fill:#cccccc !important; }
    .cartoState:hover { cursor:pointer; opacity:0.5; }
    .cartoState rect { stroke:#fff !important; stroke-width:0.8px; }
    #cartogram { height:600px; text-align:center; width:800px; }
    #cartogram text { fill:#fff !important; font-family:Arial !important; font-size:0.9em; font-weight:900; pointer-events:none !important; }
    polygon { stroke:#fff !important; stroke-width:1px; }
    .stateLabel { background-color:transparent !important; display:inline-block; text-align:left; width:68%; }
    .votes { background-color:transparent !important; display:inline-block; font-family:"Benton Sans",Helvetica,Arial,sans-serif !important; text-align:left; width:30%; }
    .stateLabel { font-family:"Benton Sans",Helvetica,Arial,sans-serif !important; font-weight:400; }
    .num:hover { opacity:0.5; }
    .thisThing { opacity:0.5; }
    .totalNum { font-size:1.4em; font-weight:900; }
    .slide { display:none; }
    .cd { stroke:#fff !important; stroke-width:1px !important; }
    .cd:hover { cursor:pointer; opacity:0.5 !important; }
    .cd.active { opacity:0.5 !important; }

    /* TABLES */
    #table { height:auto; padding:10px; vertical-align:top; }
    #allResults { border-right:2px solid #ddd; height:1100px; overflow-x:hidden; overflow-y:auto; }
    .column { display:inline-block; vertical-align:top; width:48%; }
    .tableHead { border-bottom:1px solid #ddd; display:inline-block; font-family:"Poynter Serif RE"; font-weight:900; padding:10px; width:24%; }
    .tableCell { border-bottom:1px solid #ddd; display:inline-block; font-family:"Benton Sans"; padding:10px; width:24%; }
    .tableBreak { clear:both; display:block; }
    input { border-radius:0 !important; margin-bottom:15px !important; padding:0 12px; }
    input:focus { border:1px solid #bbbbbb; box-shadow:0 0 5px #bbbbbb; padding:3px 0px 3px 3px; }
    .district { display:inline-block; }
    .box { border:1px solid #000; font-size:.7em; height:40px; margin:2px; padding:3px; vertical-align:middle; width:60px; }
    .box:hover { background-color:#333; cursor:pointer; }
    .tableCol { display:inline-block; text-align:left; vertical-align:top; width:32%; }
    .dColumn { border-top:2px solid #72A9D6; font-size:0.7em; }
    .rColumn { border-top:2px solid #d34A44; font-size:0.7em; }
    .mColumn { border-top:2px solid #cccccc; font-size:0.7em; }
    .bigBoard { display:none; vertical-align:top; }
    .th { font-weight:900; }
    .tableRow { border-right:1px solid #ddd; display:inline-block; margin:3px; text-align:left !important; vertical-align:top; width:32%; }
    .searchTerms { display:none !important; }
    .bigBoard { text-align:left; }
    .tableRow div { display:inline-block; text-align:center; width:24%; }
    .tableRow:hover { cursor:pointer; opacity:0.5; }
    .selectedBox { opacity:0.5 !important; }
    .president .tableRow div { display:inline-block; text-align:center; width:19%; }
    .stateBlock, .stateBlockR { color:#fff; font-weight:900; }
    .reporting { color:#bbbbbb !important; }
    .tableRow { background-color:white; border:1px solid #ccc; border-radius:2px; display:inline-block; font-size:.8em; margin:3px; padding:5px 0px; text-align:left !important; vertical-align:top; width:32%; }
    .tableRow .d1 { border-radius:2px; color:black !important; fill:#97bedb !important; font-weight:bold; padding:4px; pointer-events:all; }
    .tableRow .pctBox { border-radius:2px; color:#000 !important; font-weight:bold; padding:6px 0px; pointer-events:all; }
    .stateBlockR { color:#000; font-weight:900; }
    .tableRow .democrat, #infobox .democrat { color:#fff !important; fill:#3585BC !important; font-weight:bold; pointer-events:all; stroke:none; }
    .tableRow .republican, #infobox .republican { color:#fff !important; fill:#d34A44 !important; font-weight:bold; pointer-events:all; stroke:none; }

    /* INFOBOXES */
    .smallbreak { clear:both; }
    #infobox { height:122px; text-align:left; width:100%; }
    .districtName { font-size:1.2em; font-weight:900; }
    .name { font-weight:900 !important; }
    .statRow { width:100%; }
    .cell { display:inline-block; text-align:center; }
    .stats .label { font-family:"Benton Sans",Helvetica,Arial,sans-serif; font-size:.5em; text-align:center; width:66% !important; }
    .pct path { stroke-width:.02px !important; }
    h2 { padding:10px; text-align:center; }
    .candidate { float:left; width:78%; }
    .pct { float:right; width:20%; }
    .tooltip { width:150px; }
    .resultsRow div { display:inline-block; text-align:left; width:33%; }
    .resultsRow { border-bottom:1px solid #e8e8e8; padding:3px 0; clear:both; }
    .resultsHead { color:#bbbbbb; display:none !important; font-size:0.9em; font-weight:bold; }
    .reportingRow { color:#aaa; float:right; font-size:0.8em; margin-top:5px; }
    .hideIT { display:none; }
    #infobox { float:right; height:133px; margin-bottom:15px; text-align:left; width:100%; }
    #infobox .resultsRow:nth-child(2) { border-bottom:0px; }
    #infobox .resultsRow:nth-child(5) { border-bottom:0px; }

    /* DESKTOP NAV */
    #cssmenu, #cssmenu ul, #cssmenu ul li, #cssmenu ul li a { border:0; box-sizing:border-box; display:block; line-height:1; list-style:none; margin:0; moz-box-sizing:border-box; padding:0; position:relative; webkit-box-sizing:border-box; }
    #raceSwitcher { float:left; font-family:"Benton Sans",Helvetica,Arial,sans-serif!important; font-size:.65em; line-height:100%; margin:64px auto 14px; max-width:238px; padding:10px 0 0 0; position:absolute; width:100%; }
    #cssmenu li, #mobmenu li { background-color:#fff !important; text-align:left; }
    #cssmenu ul ul { display:none; }
    #cssmenu > ul > li.active > ul { display:block; }
    .align-right { float:right; }
    #cssmenu > ul > li > a { background:#ffffff; color:#757575; cursor:pointer; font-size:16px; o-transition:color .2s ease; padding:16px 22px; text-decoration:none; transition:color .2s ease; webkit-transition:color .2s ease; z-index:2; }
    #cssmenu > ul > li > a:hover { color:#000; }
    #cssmenu > ul > li.has-sub a:active { background:#d8d8d8; color:#fff; moz-transition:all 0.1s ease-out; ms-transition:all 0.1s ease-out; o-transition:all 0.1s ease-out; transition:all 0.1s ease-out; webkit-transition:all 0.1s ease-out; }
    #cssmenu ul > li.has-sub > a i.fa.fa-chevron-down { display:block; moz-transition:all 0.1s ease-out; ms-transition:all 0.1s ease-out; o-transition:all 0.1s ease-out; position:absolute; right:26px; top:15px; transition:all 0.1s ease-out; webkit-transition:all 0.1s ease-out; z-index:5; }
    #cssmenu ul > li.has-sub > a i.fa.fa-chevron-down { display:block; moz-transition:all 0.1s ease-out; ms-transition:all 0.1s ease-out; o-transition:all 0.1s ease-out; position:absolute; right:22px; top:15px; transition:all 0.1s ease-out; webkit-transition:all 0.1s ease-out; }
    #cssmenu ul > li.has-sub.open > a i.fa.fa-chevron-down { moz-transform:rotate(180deg); ms-transform:rotate(180deg); o-transform:rotate(180deg); transform:rotate(180deg); webkit-transform:rotate(180deg); }
    #cssmenu ul ul li a { background:#efefef; color:#989898; cursor:pointer; font-size:14px; o-transition:color .2s ease; padding:14px 22px; text-decoration:none; transition:color .2s ease; webkit-transition:color .2s ease; z-index:2; }
    #cssmenu ul ul ul li a { padding-left:32px; }
    #cssmenu ul ul li a:hover { color:#000; }
    #cssmenu ul ul > li.has-sub > a:after { background:#dddddd; right:26px; top:16px; }
    #cssmenu ul ul > li.has-sub > a:before { background:#dddddd; top:20px; }
    #cssmenu > ul > li > a:hover { color:#000; }
    #cssmenu { display:block; }

    /* MOBILE NAV */
    .drop { display:none; float:left; position:relative; }
    .switch { margin:0 !important; width:auto !important; }
    .switch:hover { margin:0 !important; }
    #mobmenu { display:none; }
    #mobmenu, #mobmenu ul, #mobmenu ul li, #mobmenu ul li a { border:0; box-sizing:border-box; display:block; line-height:1; list-style:none; margin:0; moz-box-sizing:border-box; padding:0; position:relative; webkit-box-sizing:border-box; }
    #mobmenu { background:white; border-right:1px solid #c5c5c5; bottom:0; color:#ffffff; display:none; font-family:"Benton Sans", sans-serif; left:0; position:absolute; top:0; width:220px; }
    #mobmenu ul ul { display:none; }
    #mobmenu > ul > li.active > ul { display:block; }
    #mobmenu > ul > li > a { background:#ffffff; color:#757575; cursor:pointer; font-size:16px; o-transition:color .2s ease; padding:16px 22px; text-decoration:none; transition:color .2s ease; webkit-transition:color .2s ease; z-index:2; }
    #mobmenu > ul > li > a:hover { color:#000; }
    #mobmenu > ul > li.has-sub a:active { background:#d8d8d8; color:#fff; moz-transition:all 0.1s ease-out; ms-transition:all 0.1s ease-out; o-transition:all 0.1s ease-out; transition:all 0.1s ease-out; webkit-transition:all 0.1s ease-out; }
    #mobmenu ul > li.has-sub > a i.fa.fa-chevron-down { display:block; moz-transition:all 0.1s ease-out; ms-transition:all 0.1s ease-out; o-transition:all 0.1s ease-out; position:absolute; right:26px; top:15px; transition:all 0.1s ease-out; webkit-transition:all 0.1s ease-out; z-index:5; }
    #mobmenu ul > li.has-sub > a i.fa.fa-chevron-down { display:block; moz-transition:all 0.1s ease-out; ms-transition:all 0.1s ease-out; o-transition:all 0.1s ease-out; position:absolute; right:22px; top:15px; transition:all 0.1s ease-out; webkit-transition:all 0.1s ease-out; }
    #mobmenu ul > li.has-sub.open > a i.fa.fa-chevron-down { moz-transform:rotate(180deg); ms-transform:rotate(180deg); o-transform:rotate(180deg); transform:rotate(180deg); webkit-transform:rotate(180deg); }
    #mobmenu ul ul li a { background:#efefef; color:#989898; cursor:pointer; font-size:14px; o-transition:color .2s ease; padding:14px 22px; text-decoration:none; transition:color .2s ease; webkit-transition:color .2s ease; z-index:2; }
    #mobmenu ul ul ul li a { padding-left:32px; }
    #mobmenu ul ul li a:hover { color:#000; }
    #mobmenu ul ul > li.has-sub > a:after { background:#dddddd; right:26px; top:16px; }
    #mobmenu ul ul > li.has-sub > a:before { background:#dddddd; top:20px; }

    /* LOADING MASK */
    .loading-mask { position:relative; }
    .loading-mask::before { background-color:rgba(0, 0, 0, 0.25); bottom:0; content:''; left:0; position:absolute; right:0; top:0; }
    @keyframes spin { from { transform:rotate(0deg); }
    to { transform:rotate(359deg); } }
    .loading-mask::after { animation:2s linear 0s normal none infinite running spin; border-color:transparent rgb(255, 255, 255) rgb(255, 255, 255); border-radius:50%; border-style:solid; border-width:3px; filter:drop-shadow(0 0 2 rgba(0, 0, 0, 0.33)); height:24px; left:calc(50% - 12px); position:absolute; top:calc(50% - 12px); width:24px; }
    #message { margin:0,auto; position:absolute; text-align:center; top:20%; width:100%; }
    #loader { bottom:0; left:0; position:absolute; right:0; top:0; }

    /* FALLBACK STUFF */
    #fallback { display:none; margin-left:auto; margin-right:auto; width:85%; }

    /* COUNTER */
    #countdown { color:#000; margin-left:18px; padding:5px; text-align:left; }
    .counter div { display:inline-block; width:48%; }
    #countdownMobile { display:none; }

    /* SHARING */
    .shareRow { background-color:#fff; float:left; margin-bottom:18px; padding-left:23px; text-align:left; width:100%; }
    .shareRow a { cursor:pointer; }
    .shareRow a:hover { opacity:0.5; }
    .shareLeft { display:inline-block; }
    .shareRight { display:inline-block; }

    /* MOBILE BREAKPOINTS */
    @media (max-width:970px) { #countdownMobile { display:block; }
    .drop { display:inline-block; }
    .sideStates { display:none !important; }
    .footnote { display:none; }
    .tableRow { width:47%; }
    #allResults { height:1700px; }
    .dlabel, .rlabel { font-size:1em; }
    .metroMap { display:none !important; }
    .resultsRow { font-size:0.85em; }
    .label { width:48%; }
    .tooltip { }
    .count { font-size:1em; width:20%; }
    #cssmenu { display:none; }
    #mobmenu { display:block; }
    #cartogram { height:auto; text-align:center; width:100%; }
    #datavizPane { width:100%; }
    #wrapper { width:100%; }
    #infobox { font-size:0.9em; }
    .map { width:100%; }
    .carto { width:100%; }
    .count { width:14%; }
    #rightSide, .dataviz { float:none; width:100%; }
    #historyview { margin-left:auto; margin-right:auto; width:100%; }
    #viewSwitches { border-right:0; display:block; }
    .mapBox { height:auto !important; }
    #mnhouse .map, #mnsenate .map, #mnhouse .map svg, #mnsenate .map svg { height:400px !important; }
    }
    @media (max-width:770px) { 
    #powerbar { padding:1px; }
    .map { height:auto; width:700px; }
    #raceSwitcher { margin: 77px auto 14px; }
    .carto { height:auto; width:700px; }
    .mapState, #mnhouse .map svg, #mnsenate .map svg { height:400px !important; }
    }
    @media (max-width:630px) { 
    .count { width:20%; }
    #raceSwitcher { margin: 102px auto 14px; }
    #powerbar { padding:1px; }
    .map { height:auto; width:600px; }
    .carto { height:auto; width:600px; }
    #mnhouse .map, #mnsenate .map, #mnhouse .map svg, #mnsenate .map svg { height:300px !important; }
    }
    @media (max-width:500px) { 
    #powerbar { padding:1px; }
    .map { height:auto; width:450px; }
    .carto { height:auto; width:450px; }
    #mnhouse .map, #mnsenate .map, #mnhouse .map svg, #mnsenate .map svg { height:300px !important; }
    }
    @media only screen and (max-width: 480px) { 
    .col { margin:0 0 0 0%; }
    .span_1_of_3 { width:100%; }
    .span_2_of_3 { border-top:1px solid #e7e7e7; width:100%; }
    .coverageLinks { float:none; text-align:center; }
    .drop { display:inline-block; }
    #cssmenu { display:none; }
    #mobmenu { display:none; margin-top:49px !important; }
    }
    @media (max-width:420px) { 
    .partyBlock { width:18%; }
    .legendLabel { height:auto; }
    .label, #dCheck, #rCheck { font-size:0.8em; }
    .zoom { clear:both; float:none !important; padding-top:10px; text-align:center !important; }
    #infobox { font-size:0.8em; }
    #powerbar { padding:1px; }
    #mobmenu { margin-top:14px !important; }
    .mobileHide { display:none; }
    .bigBoard { font-size:0.7em; }
    .map { height:auto; width:100%; }
    .resultsRow { border:none !important; }
    #mnhouse .map, #mnsenate .map, #mnhouse .map svg, #mnsenate .map svg { height:300px !important; width:300px !important; }
    .carto { height:auto; width:100%; }
    }
  </style>
</head>

<!-- THUS BEGINS THE LIFELESS HUSK THAT IS MARKUP -->
<body>

<!-- LOADING MASK THINGY SO PEOPLE GET LESS FRUSTRATED AND HATE US LESS -->
<div class="loading-mask" id="loader">  
  <div id="message">Retrieving results...</div>
</div>

<!-- HOW CAN I HOLD ALL THESE TAGS??? -->
<div id="wrapper">

<!-- TOP ELECTIONS BANNER THINGIES FOR OTHER, NON-CLICKY MAP COVERAGE FOR PEOPLE WHO LIKE READING WORDS -->
<div class="l-elections-wrapper">
    <div clas="l-election-results-header">
      <div class="resultsBanner">
        
        <div class="section group">
          <div class="col span_1_of_3">
              <div class="resultsLogo">
                <h4>ELECTION</h4>
                <div class="resultsLogoSVG"></div>
              </div>
              <div class="drop">
                 <button class="switch">Menu</button>
              </div>             
          </div>          
          <div class="col span_2_of_3">
            <div class="coverageLinks">
            <a href="#">U.S. results</a>&nbsp;&nbsp;•&nbsp;&nbsp;<a href="#">MyVote results</a>&nbsp;&nbsp;•&nbsp;&nbsp;<a href="#">Full coverage</a>
            </div>
          </div>
        </div>
      </div>
    </div>
</div>

<!-- SERIOUS BUSINESS STARTS HERE -->
<div id="fulldataviz">

<!-- LEFT RAIL -->
<div id="raceSwitcher">

<!-- MOBILE MENU, AS USED BY MOST OF HUMANITY -->
<div id='mobmenu'>
<ul id="nav">
   <li class='<!-- active--> has-sub'><a href='#'>President</a>
      <ul>
         <li class="raceSwitch advance uszoom" data="president" legend="legendWinners" type="carto" layer="country" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="us"><a href='#'><div><div><strong>U.S.</strong> electoral</div></div></a>
         </li>
         <li class="raceSwitch advance uszoom" data="president" legend="legendWinners" type="geo" layer="country" dLabel="Clinton" rLabel="Trump" stateKey="showMe" infobox="us"><a href='#'> <div><div><strong>U.S.</strong> popular by state</div></div></a>
         </li>
<!--          <li class="raceSwitch advance uszoom" data="president" legend="legendMargins" type="geo" layer="counties" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="us"><a href='#'><div><div><strong>U.S.</strong> popular by county</div></div></a>
         </li>
         <li class="raceSwitch advance mnzoom" data="president" legend="legendMargins" type="geo" layer="counties" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="mn"><a href='#'><div><div><strong>MN</strong> popular by county</div></div></a>
         </li> -->
<!--          <li><a href='#'><div class="raceSwitch advance mnzoom" data="president" legend="legendMargins" type="map" layer="pct"><div><strong>MN</strong> popular by precinct</div></div></a> -->
        <!--  </li> -->
<!--          <li class="raceSwitch advance metrozoom" data="president" legend="legendMargins" type="geo" layer="counties" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="mn"><a href='#'><div><div><strong>Metro</strong> popular by county</div></div></a>
         </li> -->
<!--          <li><a href='#'><div class="raceSwitch advance metrozoom" data="president" legend="legendMargins" type="map" layer="pct"><div><strong>Metro</strong> popular by precinct</div></div></a> -->
      </ul>   
   </li>
   <li class='has-sub'><a href='#'>US House</a>
      <ul>
        <li class="raceSwitch advance uszoom" data="house" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="false" infobox="cd"><a href='#'><div><div><strong>U.S.</strong> by district</div></div></a></li>
        <li class="raceSwitch advance uszoom" data="house" legend="legendWinners" type="carto" layer="country" dLabel="DEM" rLabel="GOP" stateKey="false" infobox="cd"><a href='#'><div><div>CARTO by district </div></div></a></li>
        <li class="raceSwitch advance mnzoom" data="house" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="false" infobox="cd"><a href='#'><div><div><strong>MN</strong> by district</div></div></a></li>
      </ul>
   </li> 
<!--    <li class="raceSwitch advance uszoom"  section="senate" data="senate" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="showMe" infobox="none"><a href='#'><div><div>U.S. Senate</div></div></a></li>  
   <li class="raceSwitch advance uszoom" section="governors" data="governors" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="showMe" infobox="none"><a href='#'><div><div>Governors</div></div></a></li> -->
   <li section="mnhouse" class="raceSwitch advance uszoom" data="mnhouse" legend="legendWinners" type="geo" layer="country" dLabel="DFL" rLabel="GOP" stateKey="false" infobox="none"><a href='#'>MN House</a></li>
   <li section="mnsenate" class="raceSwitch advance uszoom" data="mnsenate" legend="legendWinners" type="geo" layer="country" dLabel="DFL" rLabel="GOP" stateKey="false" infobox="none"><a href='#'>MN Senate</a> </li>
</ul>
<li class="advance"><div class="shareRow">
    <div class="shareLeft">
        <a href="http://www.facebook.com/share.php?u=&lt;url&gt;" onclick="return fbs_click()" target="_blank">
            <img style="width:30px;" src="http://stmedia.startribune.com/designimages/faceBookCustomIcon.png">
        </a>
    </div>
    <div class="shareRight">
        <a id="twitterbtn-link" onclick="return twitter_click('https://twitter.com/share?url=ENCODEDURL&amp;counturl=ENCODEDURL&amp;text=ENCODEDTWEETTEXT&amp;via=StarTribune')">
            <img style="width:30px;" src="http://stmedia.startribune.com/designimages/twitterCustomIcon.png">
        </a> 
    </div>
</div></li>
</div> <!-- end mobmenu -->

<!-- DESKTOP MENU FOR GAMERS, SUBTERRANIAN DWELLERS AND OLD PEOPLE -->
<div id='cssmenu'>
<div id="countdown"><span class="ticker">0</span> to next update</div>
<ul id="nav">
   <li class='<!-- active--> has-sub'><a href='#'>President</a>
      <ul>
         <li class="raceSwitch advance uszoom" data="president" legend="legendWinners" type="carto" layer="country" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="us"><a href='#'><div><div><strong>U.S.</strong> electoral</div></div></a>
         </li>
         <li class="raceSwitch advance uszoom" data="president" legend="legendWinners" type="geo" layer="country" dLabel="Clinton" rLabel="Trump" stateKey="showMe" infobox="us"><a href='#'> <div><div><strong>U.S.</strong> popular by state</div></div></a>
         </li>
         <li class="raceSwitch advance uszoom" data="president" legend="legendMargins" type="geo" layer="counties" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="us"><a href='#'><div><div><strong>U.S.</strong> popular by county</div></div></a>
         </li>
         <li class="raceSwitch advance mnzoom" data="president" legend="legendMargins" type="geo" layer="counties" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="mn"><a href='#'><div><div><strong>MN</strong> popular by county</div></div></a>
         </li>
<!--          <li><a href='#'><div class="raceSwitch advance mnzoom" data="president" legend="legendMargins" type="map" layer="pct"><div><strong>MN</strong> popular by precinct</div></div></a> -->
         </li>
         <li class="raceSwitch advance metrozoom" data="president" legend="legendMargins" type="geo" layer="counties" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="mn"><a href='#'><div><div><strong>Metro</strong> popular by county</div></div></a>
         </li>
<!--          <li><a href='#'><div class="raceSwitch advance metrozoom" data="president" legend="legendMargins" type="map" layer="pct"><div><strong>Metro</strong> popular by precinct</div></div></a> -->
         </li>
      </ul>   
   </li>
   <li class='has-sub'><a href='#'>US House</a>
      <ul>
        <li class="raceSwitch advance uszoom" data="house" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="false" infobox="cd"><a href='#'><div><div><strong>U.S.</strong> by district</div></div></a></li>
        <li class="raceSwitch advance uszoom" data="house" legend="legendWinners" type="carto" layer="country" dLabel="DEM" rLabel="GOP" stateKey="false" infobox="cd"><a href='#'><div><div>CARTO by district </div></div></a></li>
        <li class="raceSwitch advance mnzoom" data="house" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="false" infobox="cd"><a href='#'><div><div><strong>MN</strong> by district</div></div></a></li>
      </ul>
   </li> 
   <li class="raceSwitch advance uszoom"  section="senate" data="senate" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="showMe" infobox="none"><a href='#'><div><div>U.S. Senate</div></div></a></li> 
   <li class="raceSwitch advance uszoom" section="governors" data="governors" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="showMe" infobox="none"><a href='#'><div><div>Governors</div></div></a></li>
   <li section="mnhouse" class="raceSwitch advance uszoom" data="mnhouse" legend="legendWinners" type="geo" layer="country" dLabel="DFL" rLabel="GOP" stateKey="false" infobox="none"><a href='#'>MN House</a></li>
   <li section="mnsenate" class="raceSwitch advance uszoom" data="mnsenate" legend="legendWinners" type="geo" layer="country" dLabel="DFL" rLabel="GOP" stateKey="false" infobox="none"><a href='#'>MN Senate</a></li>
<li><div class="shareRow">
    <div class="shareLeft">
        <a href="http://www.facebook.com/share.php?u=&lt;url&gt;" onclick="return fbs_click()" target="_blank">
            <img style="width:30px;" src="http://stmedia.startribune.com/designimages/faceBookCustomIcon.png">
        </a>
    </div>
    <div class="shareRight">
        <a id="twitterbtn-link" onclick="return twitter_click('https://twitter.com/share?url=ENCODEDURL&amp;counturl=ENCODEDURL&amp;text=ENCODEDTWEETTEXT&amp;via=StarTribune')">
            <img style="width:30px;" src="http://stmedia.startribune.com/designimages/twitterCustomIcon.png">
        </a> 
    </div>
</div></li>
</ul>
</div> <!-- end cssmenu -->

</div> <!-- end raceSwitcher -->

<!-- WHERE THE SHINY THINGS LIVE -->
<div id="datavizPane">

<!-- POWER BALANCE BAR -->
<div class="bars" id="powerbar">
<div id="partyLabels">
  <div class="label demsLabel"><span class="count demsCount">0</span> <span class="dparty dlabel" style="text-align:left;">DEM</span> <span id="dMark" class="check"></span></div>
  <div class="label gopLabel"><span id="rMark" class="check"></span><span class="rparty rlabel" style="text-align:right;">GOP</span> <span class="count gopCount">0</span></div>
</div>
<div id="partyBar">
  <div class="backbar">
  <div class="bar democrat" id="dWin"></div><div class="bar green4" id="iWin"></div><div class="bar republican" id="rWin"></div>
  </div>
</div>
</div> <!-- end powerbar -->

<div class="breaker"></div>


<!-- PRESIDENTIAL PANE: FOR PEERING INTO THE ABYSS OF OUR DOOMED FUTURE -->
<div id="president" class="dataviz">

<!-- ZOMG MAPS THAT CLICK -->
<div class="mapBox">
<!-- THE MAIN EVENT MAP -->
<div id="map" class="map geo"><svg id="USMAP" width="800" height="600" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid"></svg>

<!-- FOR THE TINY STATES TOO SAD TO FIT A LABEL -->
<div class="sideStates"><div class="block stateBlock VT" name="Vermont" ab="VT">VT</div><div class="block stateBlock NH" name="New Hampshire" ab="NH">NH</div><div class="block stateBlock MA" name="Massachusetts" ab="MA">MA</div><div class="block stateBlock RI" name="Rhode Island" ab="RI">RI</div><div class="block stateBlock CT" name="Connecticut" ab="CT">CT</div><div class="block stateBlock NJ" name="New Jersey" ab="NJ">NJ</div><div class="block stateBlock DE" name="Delaware" ab="DE">DE</div><div class="block stateBlock MD" name="Maryland" ab="MD">MD</div><div class="block stateBlock DC" name="District of Columbia" ab="DC">DC</div><div class="block stateBlock HI" name="Hawaii" ab="HI">HI</div><div class="block ME01 evcd" name="Main District 1" ab="ME01">ME1</div><div class="block ME02 evcd" name="Main District 2" ab="ME02">ME2</div><div class="block NE01 evcd" name="Nebraska District 1" ab="NE01">NE1</div><div class="block NE02 evcd" name="Nebraska District 2" ab="NE02">NE2</div><div class="block NE03 evcd" name="Nebraska District 3" ab="NE03">NE3</div></div>
</div>

<!-- AN UGLY ELECTORAL COLLEGE MAP FOR WONKS WHO LIKE SQUARES -->
<div id="carto" class="map normal carto">
<div id="cartogram">
<svg version="1.1" x="0px" y="0px" width="90%" viewBox="0 0 860 696.572" enable-background="new 0 0 860 696.572" xml:space="preserve">
<g id="PA" class="cartoState" name="Pennsylvania">
    <rect x="593.385" y="217.866" width="21.789" height="21.789"/>
    <rect x="615.174" y="217.866" width="21.793" height="21.79"/>
    <rect x="658.755" y="217.866" width="21.79" height="21.79"/>
    <rect x="636.968" y="217.866" width="21.787" height="21.79"/>
    <rect x="680.545" y="217.866" width="21.79" height="21.79"/>
    <rect x="702.334" y="217.866" width="21.788" height="21.79"/>
    <rect x="593.385" y="239.653" width="21.789" height="21.791"/>
    <rect x="615.174" y="239.654" width="21.793" height="21.79"/>
    <rect x="658.755" y="239.654" width="21.79" height="21.79"/>
    <rect x="636.968" y="239.654" width="21.787" height="21.79"/>
    <rect x="680.545" y="239.654" width="21.79" height="21.79"/>
    <rect x="702.334" y="239.654" width="21.788" height="21.79"/>
    <rect x="593.385" y="261.444" width="21.789" height="21.79"/>
    <rect x="571.604" y="217.851" width="21.788" height="21.792"/>
    <rect x="571.604" y="239.643" width="21.788" height="21.792"/>
    <rect x="615.174" y="261.446" width="21.793" height="21.788"/>
    <rect x="658.755" y="261.446" width="21.79" height="21.788"/>
    <rect x="636.968" y="261.446" width="21.787" height="21.788"/>
    <rect x="680.545" y="261.446" width="21.79" height="21.788"/>
    <rect x="702.334" y="261.446" width="21.788" height="21.788"/>
</g>
<g id="ME" class="cartoState" name="Maine">
    <rect x="789.546" y="21.79" width="21.79" height="21.79"/>
    <rect x="789.546" width="21.79" height="21.79"/>
</g>
<g id="ME01" class="cartoState evcd" name="Maine">
    <rect x="811.307" width="21.789" height="21.79"/>
</g>
<g id="ME02" class="cartoState evcd" name="Maine">
    <rect x="811.307" y="21.79" width="21.789" height="21.79"/>
</g>
<g id="NH" class="cartoState" name="New Hampshire">
    <rect x="789.504" y="65.359" width="21.792" height="21.789"/>
    <rect x="789.504" y="43.569" width="21.792" height="21.791"/>
    <rect x="811.304" y="65.35" width="21.789" height="21.789"/>
    <rect x="811.304" y="43.56" width="21.789" height="21.79"/>
</g>
<g id="VT" class="cartoState" name="Vermont">
    <rect x="767.745" y="65.33" width="21.789" height="21.793"/>
    <rect x="745.949" y="65.33" width="21.788" height="21.793"/>
    <rect x="724.173" y="65.33" width="21.79" height="21.793"/>
</g>
<g id="MA" class="cartoState" name="Massachusetts">
    <rect x="745.926" y="87.128" width="21.796" height="21.79"/>
    <rect x="745.926" y="108.919" width="21.796" height="21.788"/>
    <rect x="724.075" y="87.128" width="21.793" height="21.79"/>
    <rect x="724.075" y="108.919" width="21.793" height="21.788"/>
    <rect x="767.719" y="87.128" width="21.792" height="21.79"/>
    <rect x="767.719" y="108.919" width="21.792" height="21.788"/>
    <rect x="789.51" y="87.128" width="21.786" height="21.79"/>
    <rect x="789.51" y="108.919" width="21.786" height="21.788"/>
    <rect x="811.296" y="87.128" width="21.793" height="21.79"/>
    <rect x="811.296" y="108.919" width="21.793" height="21.788"/>
    <rect x="833.089" y="108.919" width="21.787" height="21.788"/>
</g>
<g id="RI" class="cartoState" name="Rhode Island">
    <rect x="789.521" y="130.711" width="21.785" height="21.79"/>
    <rect x="789.518" y="152.509" width="21.786" height="21.788"/>
    <rect x="811.278" y="130.711" width="21.786" height="21.79"/>
    <rect x="811.278" y="152.501" width="21.786" height="21.787"/>
</g>
<g id="CT" class="cartoState" name="Connecticut">
    <rect x="745.936" y="130.771" width="21.792" height="21.789"/>
    <rect x="724.145" y="152.561" width="21.791" height="21.789"/>
    <rect x="745.936" y="152.561" width="21.792" height="21.789"/>
    <rect x="767.694" y="130.771" width="21.793" height="21.789"/>
    <rect x="767.694" y="152.561" width="21.793" height="21.789"/>
    <rect x="724.145" y="130.771" width="21.791" height="21.789"/>
    <rect x="724.145" y="174.349" width="21.791" height="21.79"/>
</g>
<g id="NY" class="cartoState" name="New York">
    <rect x="724.119" y="217.878" width="21.793" height="21.792"/>
    <rect x="658.756" y="196.09" width="21.789" height="21.789"/>
    <rect x="593.385" y="196.09" width="21.789" height="21.789"/>
    <rect x="615.174" y="196.09" width="21.793" height="21.789"/>
    <rect x="636.963" y="196.09" width="21.793" height="21.789"/>
    <rect x="658.756" y="174.299" width="21.789" height="21.79"/>
    <rect x="680.545" y="174.299" width="21.79" height="21.79"/>
    <rect x="702.331" y="174.299" width="21.789" height="21.79"/>
    <rect x="702.331" y="152.51" width="21.789" height="21.79"/>
    <rect x="702.331" y="130.721" width="21.789" height="21.789"/>
    <rect x="702.331" y="108.931" width="21.789" height="21.79"/>
    <rect x="702.331" y="87.145" width="21.789" height="21.788"/>
    <rect x="680.545" y="196.09" width="21.79" height="21.789"/>
    <rect x="571.6" y="196.09" width="21.786" height="21.789"/>
    <rect x="680.545" y="87.145" width="21.79" height="21.788"/>
    <rect x="658.756" y="108.931" width="21.789" height="21.79"/>
    <rect x="615.174" y="152.51" width="21.793" height="21.79"/>
    <rect x="593.385" y="174.299" width="21.789" height="21.79"/>
    <rect x="615.174" y="174.299" width="21.793" height="21.79"/>
    <rect x="636.963" y="174.299" width="21.793" height="21.79"/>
    <rect x="636.963" y="152.51" width="21.793" height="21.79"/>
    <rect x="745.922" y="217.875" width="21.79" height="21.79"/>
    <rect x="636.963" y="130.746" width="21.793" height="21.79"/>
    <rect x="658.756" y="152.51" width="21.789" height="21.79"/>
    <rect x="680.545" y="152.51" width="21.79" height="21.79"/>
    <rect x="680.545" y="130.721" width="21.79" height="21.789"/>
    <rect x="658.756" y="130.721" width="21.789" height="21.789"/>
    <rect x="680.545" y="108.931" width="21.79" height="21.79"/>
    <rect x="702.331" y="196.09" width="21.789" height="21.789"/>
</g>
<g id="NJ" class="cartoState" name="New Jersey">
    <rect x="745.907" y="261.471" width="21.787" height="21.791"/>
    <rect x="767.694" y="261.471" width="21.793" height="21.791"/>
    <rect x="789.487" y="283.263" width="21.786" height="21.79"/>
    <rect x="745.901" y="239.68" width="21.789" height="21.791"/>
    <rect x="767.69" y="239.68" width="21.787" height="21.791"/>
    <rect x="745.907" y="283.263" width="21.787" height="21.79"/>
    <rect x="745.907" y="305.05" width="21.787" height="21.787"/>
    <rect x="767.694" y="326.837" width="21.793" height="21.791"/>
    <rect x="767.694" y="305.05" width="21.793" height="21.787"/>
    <rect x="767.694" y="283.263" width="21.793" height="21.79"/>
    <rect x="789.487" y="326.837" width="21.786" height="21.791"/>
    <rect x="745.907" y="326.837" width="21.787" height="21.791"/>
    <rect x="789.487" y="305.05" width="21.786" height="21.787"/>
    <rect x="724.11" y="239.68" width="21.789" height="21.791"/>
</g>
<g id="DE" class="cartoState" name="Delaware">
    <rect x="724.094" y="305.098" width="21.789" height="21.79"/>
    <rect x="724.094" y="283.254" width="21.789" height="21.79"/>
    <rect x="724.094" y="261.421" width="21.789" height="21.79"/>
</g>
<g id="MD" class="cartoState" name="Maryland">
    <rect x="658.728" y="283.201" width="21.794" height="21.79"/>
    <rect x="680.521" y="283.201" width="21.79" height="21.79"/>
    <rect x="615.151" y="283.201" width="21.789" height="21.79"/>
    <rect x="636.94" y="283.201" width="21.793" height="21.79"/>
    <rect x="724.097" y="348.568" width="21.792" height="21.79"/>
    <rect x="680.521" y="304.99" width="21.79" height="21.791"/>
    <rect x="702.312" y="304.99" width="21.788" height="21.791"/>
    <rect x="702.312" y="326.78" width="21.788" height="21.788"/>
    <rect x="724.097" y="326.78" width="21.792" height="21.788"/>
    <rect x="702.304" y="283.244" width="21.79" height="21.791"/>
</g>
<g id="WV" class="cartoState" name="West Virginia">
    <rect x="571.579" y="261.43" width="21.789" height="21.791"/>
    <rect x="571.579" y="304.959" width="21.789" height="21.79"/>
    <rect x="571.579" y="283.171" width="21.789" height="21.789"/>
    <rect x="593.382" y="304.959" width="21.787" height="21.79"/>
    <rect x="593.382" y="283.171" width="21.787" height="21.789"/>
</g>
<g id="OH" class="cartoState" name="Ohio">
    <rect x="484.467" y="217.851" width="21.79" height="21.791"/>
    <rect x="506.257" y="261.43" width="21.79" height="21.789"/>
    <rect x="506.257" y="283.217" width="21.79" height="21.79"/>
    <rect x="549.834" y="283.217" width="21.788" height="21.79"/>
    <rect x="528.046" y="283.217" width="21.788" height="21.79"/>
    <rect x="528.046" y="261.43" width="21.788" height="21.789"/>
    <rect x="528.046" y="239.64" width="21.788" height="21.79"/>
    <rect x="549.834" y="239.64" width="21.788" height="21.79"/>
    <rect x="484.456" y="305.007" width="21.79" height="21.79"/>
    <rect x="506.246" y="305.007" width="21.788" height="21.79"/>
    <rect x="528.046" y="305.007" width="21.79" height="21.79"/>
    <rect x="549.836" y="305.007" width="21.786" height="21.79"/>
    <rect x="549.834" y="261.43" width="21.788" height="21.789"/>
    <rect x="549.834" y="217.851" width="21.788" height="21.791"/>
    <rect x="484.467" y="239.64" width="21.79" height="21.79"/>
    <rect x="484.467" y="261.43" width="21.79" height="21.789"/>
    <rect x="484.467" y="283.217" width="21.79" height="21.79"/>
    <rect x="506.257" y="239.64" width="21.79" height="21.79"/>
</g>
<g id="MI" class="cartoState" name="Michigan">
    <rect x="440.905" y="152.454" width="21.789" height="21.79"/>
    <rect x="462.694" y="152.454" width="21.788" height="21.79"/>
    <rect x="484.482" y="152.454" width="21.792" height="21.79"/>
    <rect x="440.905" y="130.663" width="21.789" height="21.79"/>
    <rect x="419.114" y="108.874" width="21.791" height="21.789"/>
    <rect x="440.905" y="174.243" width="21.789" height="21.788"/>
    <rect x="462.694" y="174.243" width="21.788" height="21.788"/>
    <rect x="506.271" y="196.031" width="21.789" height="21.79"/>
    <rect x="506.271" y="174.243" width="21.789" height="21.79"/>
    <rect x="506.271" y="152.454" width="21.789" height="21.79"/>
    <rect x="484.482" y="174.243" width="21.792" height="21.788"/>
    <rect x="440.905" y="196.031" width="21.789" height="21.79"/>
    <rect x="462.694" y="196.031" width="21.788" height="21.79"/>
    <rect x="484.482" y="196.031" width="21.792" height="21.79"/>
    <rect x="462.694" y="130.663" width="21.788" height="21.79"/>
    <rect x="397.326" y="108.874" width="21.788" height="21.789"/>
</g>
<g id="WI" class="cartoState" name="Wisconsin">
    <rect x="353.733" y="130.666" width="21.789" height="21.788"/>
    <rect x="353.733" y="152.454" width="21.789" height="21.792"/>
    <rect x="375.521" y="130.666" width="21.792" height="21.788"/>
    <rect x="353.733" y="108.879" width="21.789" height="21.79"/>
    <rect x="375.521" y="108.879" width="21.792" height="21.79"/>
    <rect x="397.313" y="152.454" width="21.788" height="21.792"/>
    <rect x="375.521" y="152.454" width="21.792" height="21.792"/>
    <rect x="375.521" y="174.243" width="21.792" height="21.79"/>
    <rect x="397.313" y="174.243" width="21.788" height="21.79"/>
    <rect x="353.733" y="174.243" width="21.789" height="21.79"/>
</g>
<g id="MN" class="cartoState" name="Minnesota">
    <rect x="288.358" y="174.236" width="21.789" height="21.789"/>
    <rect x="310.147" y="174.236" width="21.791" height="21.789"/>
    <rect x="288.358" y="152.446" width="21.789" height="21.791"/>
    <rect x="331.943" y="108.867" width="21.79" height="21.79"/>
    <rect x="331.935" y="130.643" width="21.789" height="21.79"/>
    <rect x="310.147" y="152.446" width="21.791" height="21.791"/>
    <rect x="310.147" y="130.657" width="21.791" height="21.789"/>
    <rect x="331.935" y="174.221" width="21.79" height="21.79"/>
    <rect x="331.935" y="152.434" width="21.79" height="21.789"/>
    <rect x="288.358" y="130.657" width="21.789" height="21.789"/>
</g>
<g id="IA" class="cartoState" name="Iowa">
    <rect x="288.369" y="195.99" width="21.79" height="21.79"/>
    <rect x="310.158" y="195.99" width="21.788" height="21.79"/>
    <rect x="331.946" y="195.99" width="21.792" height="21.79"/>
    <rect x="288.369" y="217.778" width="21.79" height="21.79"/>
    <rect x="331.946" y="217.778" width="21.792" height="21.79"/>
    <rect x="310.158" y="217.78" width="21.788" height="21.788"/>
</g>
<g id="ND" class="cartoState" name="North Dakota">
    <rect x="223.029" y="174.216" width="21.788" height="21.79"/>
    <rect x="244.807" y="174.216" width="21.788" height="21.79"/>
    <rect x="266.599" y="174.216" width="21.787" height="21.79"/>
</g>
<g id="SD" class="cartoState" name="South Dakota">
    <rect x="223.029" y="196.005" width="21.788" height="21.788"/>
    <rect x="244.807" y="196.005" width="21.788" height="21.788"/>
    <rect x="266.599" y="196.005" width="21.787" height="21.788"/>
</g>
<g id="NE" class="cartoState" name="Nebraska">
    <rect x="223.014" y="217.809" width="21.788" height="21.79"/>
    <rect x="244.806" y="239.587" width="21.792" height="21.789"/>
</g>
<g id="NE01" class="cartoState evcd" name="Nebraska">
    <rect x="266.594" y="239.587" width="21.789" height="21.789"/>
</g>
<g id="NE02" class="cartoState evcd" name="Nebraska">
    <rect x="266.594" y="217.8" width="21.789" height="21.791"/>
</g>
<g id="NE03" class="cartoState evcd" name="Nebraska">
    <rect x="244.804" y="217.8" width="21.788" height="21.791"/>
</g>
<g id="IN" class="cartoState" name="Indiana">
    <rect x="440.891" y="217.834" width="21.788" height="21.79"/>
    <rect x="462.679" y="217.834" width="21.792" height="21.79"/>
    <rect x="462.679" y="239.623" width="21.792" height="21.789"/>
    <rect x="440.891" y="239.623" width="21.788" height="21.789"/>
    <rect x="440.891" y="261.412" width="21.788" height="21.791"/>
    <rect x="462.679" y="261.412" width="21.792" height="21.791"/>
    <rect x="419.112" y="304.97" width="21.79" height="21.789"/>
    <rect x="440.891" y="283.201" width="21.788" height="21.79"/>
    <rect x="462.679" y="283.201" width="21.792" height="21.79"/>
    <rect x="440.891" y="304.979" width="21.788" height="21.79"/>
    <rect x="462.679" y="304.979" width="21.792" height="21.79"/>
</g>
<g id="IL" class="cartoState" name="Illinois">
    <rect x="419.107" y="261.327" width="21.787" height="21.79"/>
    <rect x="419.107" y="239.518" width="21.787" height="21.788"/>
    <rect x="353.718" y="261.292" width="21.788" height="21.789"/>
    <rect x="353.732" y="195.934" width="21.788" height="21.792"/>
    <rect x="375.52" y="195.934" width="21.792" height="21.792"/>
    <rect x="397.312" y="195.934" width="21.792" height="21.792"/>
    <rect x="353.732" y="217.726" width="21.788" height="21.79"/>
    <rect x="375.52" y="217.726" width="21.792" height="21.79"/>
    <rect x="397.312" y="217.726" width="21.79" height="21.79"/>
    <rect x="375.516" y="239.492" width="21.79" height="21.791"/>
    <rect x="397.304" y="239.492" width="21.79" height="21.791"/>
    <rect x="419.091" y="283.067" width="21.787" height="21.792"/>
    <rect x="375.511" y="261.292" width="21.788" height="21.789"/>
    <rect x="397.304" y="261.292" width="21.79" height="21.789"/>
    <rect x="375.511" y="283.09" width="21.788" height="21.791"/>
    <rect x="397.288" y="283.09" width="21.792" height="21.791"/>
    <rect x="353.732" y="239.492" width="21.792" height="21.789"/>
    <rect x="375.501" y="304.881" width="21.792" height="21.792"/>
    <rect x="331.945" y="239.492" width="21.792" height="21.791"/>
    <rect x="397.292" y="304.881" width="21.788" height="21.792"/>
</g>
<g id="MO" class="cartoState" name="Missouri">
    <rect x="310.153" y="261.304" width="21.792" height="21.788"/>
    <rect x="331.938" y="261.304" width="21.792" height="21.788"/>
    <rect x="310.155" y="239.498" width="21.791" height="21.791"/>
    <rect x="353.738" y="283.088" width="21.789" height="21.792"/>
    <rect x="310.153" y="283.092" width="21.788" height="21.791"/>
    <rect x="331.931" y="283.092" width="21.792" height="21.791"/>
    <rect x="353.738" y="304.883" width="21.789" height="21.79"/>
    <rect x="288.372" y="239.498" width="21.789" height="21.791"/>
    <rect x="310.153" y="304.883" width="21.788" height="21.79"/>
    <rect x="331.937" y="304.883" width="21.788" height="21.79"/>
</g>
<g id="KS" class="cartoState" name="Kansas">
    <rect x="244.806" y="261.297" width="21.79" height="21.79"/>
    <rect x="266.592" y="261.297" width="21.792" height="21.79"/>
    <rect x="288.385" y="261.297" width="21.787" height="21.79"/>
    <rect x="266.585" y="283.088" width="21.79" height="21.792"/>
    <rect x="288.374" y="283.088" width="21.79" height="21.792"/>
    <rect x="244.806" y="283.088" width="21.788" height="21.792"/>
</g>
<g id="WY" class="cartoState" name="Wyoming">
    <rect x="135.764" y="217.758" width="21.792" height="21.789"/>
    <rect x="157.554" y="217.758" width="21.79" height="21.789"/>
    <rect x="179.327" y="217.758" width="21.789" height="21.789"/>
</g>
<g id="MT" class="cartoState" name="Montana">
    <rect x="114.004" y="195.964" width="21.789" height="21.791"/>
    <rect x="135.779" y="195.964" width="21.787" height="21.791"/>
    <rect x="157.578" y="195.964" width="21.79" height="21.791"/>
</g>
<g id="CO" class="cartoState" name="Colorado">
    <rect x="179.367" y="261.314" width="21.787" height="21.788"/>
    <rect x="201.152" y="261.314" width="21.79" height="21.787"/>
    <rect x="222.944" y="261.314" width="21.79" height="21.787"/>
    <rect x="179.367" y="239.527" width="21.787" height="21.79"/>
    <rect x="222.944" y="239.527" width="21.79" height="21.789"/>
    <rect x="222.944" y="283.102" width="21.79" height="21.791"/>
    <rect x="179.367" y="283.102" width="21.787" height="21.791"/>
    <rect x="201.152" y="283.102" width="21.79" height="21.791"/>
    <rect x="201.152" y="239.527" width="21.79" height="21.79"/>
</g>
<g id="UT" class="cartoState" name="Utah">
    <rect x="135.766" y="283.088" width="21.788" height="21.789"/>
    <rect x="157.535" y="239.532" width="21.788" height="21.79"/>
    <rect x="157.554" y="283.088" width="21.79" height="21.789"/>
    <rect x="135.757" y="239.532" width="21.788" height="21.79"/>
    <rect x="135.757" y="261.304" width="21.791" height="21.788"/>
    <rect x="157.534" y="261.304" width="21.789" height="21.79"/>
</g>
<g id="NV" class="cartoState" name="Nevada">
    <rect x="113.999" y="261.343" width="21.789" height="21.79"/>
    <rect x="92.197" y="283.157" width="21.788" height="21.792"/>
    <rect x="113.998" y="283.157" width="21.792" height="21.792"/>
    <rect x="92.197" y="261.343" width="21.792" height="21.788"/>
    <rect x="113.998" y="239.53" width="21.792" height="21.79"/>
    <rect x="92.197" y="239.53" width="21.788" height="21.79"/>
</g>
<g id="ID" class="cartoState" name="Idaho">
    <rect x="92.181" y="174.194" width="21.791" height="21.789"/>
    <rect x="92.181" y="195.983" width="21.791" height="21.791"/>
    <rect x="92.181" y="217.769" width="21.791" height="21.79"/>
    <rect x="113.969" y="217.769" width="21.792" height="21.79"/>
</g>
<g id="WA" class="cartoState" name="Washington">
    <rect x="5.026" y="130.596" width="21.789" height="21.789"/>
    <rect x="26.815" y="130.596" width="21.79" height="21.789"/>
    <rect x="26.815" y="152.384" width="21.79" height="21.788"/>
    <rect x="5.012" y="86.998" width="21.79" height="21.789"/>
    <rect x="48.604" y="86.998" width="21.789" height="21.789"/>
    <rect x="70.393" y="86.998" width="21.791" height="21.789"/>
    <rect x="70.393" y="130.596" width="21.791" height="21.789"/>
    <rect x="48.604" y="130.596" width="21.789" height="21.789"/>
    <rect x="70.393" y="108.806" width="21.791" height="21.79"/>
    <rect x="48.604" y="108.806" width="21.789" height="21.79"/>
    <rect x="26.815" y="108.806" width="21.79" height="21.79"/>
    <rect x="5.012" y="108.806" width="21.79" height="21.79"/>
</g>
<g id="OR" class="cartoState" name="Oregon">
    <rect x="5.026" y="174.175" width="21.789" height="21.79"/>
    <rect x="26.815" y="174.175" width="21.79" height="21.79"/>
    <rect x="48.604" y="174.175" width="21.789" height="21.79"/>
    <rect x="48.604" y="152.384" width="21.789" height="21.79"/>
    <rect x="70.393" y="174.175" width="21.791" height="21.79"/>
    <rect x="70.393" y="152.384" width="21.791" height="21.79"/>
    <rect x="5.026" y="152.386" width="21.789" height="21.789"/>
</g>
<g id="CA" class="cartoState" name="California">
    <rect x="5" y="195.904" width="21.79" height="21.788"/>
    <rect x="26.812" y="195.904" width="21.79" height="21.788"/>
    <rect x="48.576" y="195.904" width="21.79" height="21.788"/>
    <rect x="70.393" y="195.904" width="21.791" height="21.788"/>
    <rect x="5" y="217.695" width="21.79" height="21.789"/>
    <rect x="26.812" y="217.695" width="21.79" height="21.789"/>
    <rect x="48.576" y="217.695" width="21.79" height="21.789"/>
    <rect x="70.393" y="217.695" width="21.791" height="21.789"/>
    <rect x="5" y="239.588" width="21.79" height="21.788"/>
    <rect x="26.812" y="239.588" width="21.79" height="21.788"/>
    <rect x="48.576" y="239.588" width="21.79" height="21.788"/>
    <rect x="70.393" y="239.588" width="21.791" height="21.788"/>
    <rect x="5" y="261.273" width="21.79" height="21.788"/>
    <rect x="26.812" y="261.273" width="21.79" height="21.788"/>
    <rect x="48.576" y="261.273" width="21.79" height="21.788"/>
    <rect x="70.393" y="261.273" width="21.791" height="21.788"/>
    <rect x="5" y="283.062" width="21.79" height="21.789"/>
    <rect x="26.812" y="283.062" width="21.79" height="21.789"/>
    <rect x="48.576" y="283.062" width="21.79" height="21.789"/>
    <rect x="70.393" y="283.062" width="21.791" height="21.789"/>
    <rect x="26.812" y="414.03" width="21.79" height="21.792"/>
    <rect x="48.625" y="414.03" width="21.79" height="21.792"/>
    <rect x="70.388" y="414.03" width="21.791" height="21.792"/>
    <rect x="92.204" y="414.03" width="21.789" height="21.792"/>
    <rect x="26.812" y="435.82" width="21.79" height="21.792"/>
    <rect x="48.625" y="435.82" width="21.79" height="21.792"/>
    <rect x="70.388" y="435.82" width="21.791" height="21.792"/>
    <rect x="92.204" y="435.82" width="21.789" height="21.792"/>
    <rect x="5" y="304.91" width="21.79" height="21.789"/>
    <rect x="26.812" y="304.91" width="21.79" height="21.789"/>
    <rect x="48.576" y="304.91" width="21.79" height="21.789"/>
    <rect x="70.393" y="304.91" width="21.791" height="21.789"/>
    <rect x="92.153" y="304.91" width="21.791" height="21.789"/>
    <rect x="5" y="326.808" width="21.79" height="21.788"/>
    <rect x="26.812" y="326.808" width="21.79" height="21.788"/>
    <rect x="48.576" y="326.808" width="21.79" height="21.788"/>
    <rect x="70.393" y="326.808" width="21.791" height="21.788"/>
    <rect x="92.153" y="326.808" width="21.791" height="21.788"/>
    <rect x="5" y="348.558" width="21.79" height="21.788"/>
    <rect x="26.812" y="348.558" width="21.79" height="21.788"/>
    <rect x="48.576" y="348.558" width="21.79" height="21.788"/>
    <rect x="70.393" y="348.558" width="21.791" height="21.788"/>
    <rect x="92.153" y="348.558" width="21.791" height="21.788"/>
    <rect x="5" y="370.454" width="21.79" height="21.787"/>
    <rect x="26.812" y="370.454" width="21.79" height="21.787"/>
    <rect x="48.576" y="370.454" width="21.79" height="21.787"/>
    <rect x="70.393" y="370.454" width="21.791" height="21.787"/>
    <rect x="92.153" y="370.454" width="21.791" height="21.787"/>
    <rect x="114.004" y="370.454" width="21.79" height="21.787"/>
    <rect x="5" y="392.244" width="21.79" height="21.786"/>
    <rect x="26.812" y="392.244" width="21.79" height="21.786"/>
    <rect x="48.576" y="392.244" width="21.79" height="21.786"/>
    <rect x="70.393" y="392.244" width="21.791" height="21.786"/>
    <rect x="92.153" y="392.244" width="21.791" height="21.786"/>
    <rect x="114.004" y="392.244" width="21.79" height="21.786"/>
</g>
<g id="AZ" class="cartoState" name="Arizona">
    <rect x="114.004" y="326.669" width="21.789" height="21.79"/>
    <rect x="135.793" y="326.669" width="21.789" height="21.79"/>
    <rect x="157.583" y="326.669" width="21.791" height="21.79"/>
    <rect x="157.583" y="348.456" width="21.791" height="21.79"/>
    <rect x="135.793" y="348.456" width="21.789" height="21.79"/>
    <rect x="157.583" y="370.315" width="21.791" height="21.789"/>
    <rect x="135.793" y="370.315" width="21.789" height="21.789"/>
    <rect x="114.004" y="348.456" width="21.789" height="21.79"/>
    <rect x="135.793" y="304.88" width="21.789" height="21.789"/>
    <rect x="157.583" y="304.88" width="21.791" height="21.789"/>
    <rect x="114.004" y="304.88" width="21.789" height="21.789"/>
</g>
<g id="NM" class="cartoState" name="New Mexico">
    <rect x="179.352" y="348.487" width="21.789" height="21.791"/>
    <rect x="201.141" y="326.698" width="21.79" height="21.789"/>
    <rect x="179.352" y="326.698" width="21.789" height="21.789"/>
    <rect x="201.141" y="304.909" width="21.79" height="21.791"/>
    <rect x="179.352" y="304.909" width="21.789" height="21.791"/>
</g>
<g id="OK" class="cartoState" name="Oklahoma">
    <rect x="222.912" y="304.79" width="21.787" height="21.791"/>
    <rect x="244.701" y="304.79" width="21.791" height="21.791"/>
    <rect x="266.49" y="304.79" width="21.789" height="21.791"/>
    <rect x="266.49" y="326.58" width="21.789" height="21.789"/>
    <rect x="288.268" y="304.79" width="21.79" height="21.791"/>
    <rect x="288.268" y="326.58" width="21.79" height="21.789"/>
    <rect x="244.701" y="326.58" width="21.791" height="21.789"/>
</g>
<g id="AR" class="cartoState" name="Arkansas">
    <rect x="310.11" y="326.662" width="21.79" height="21.787"/>
    <rect x="331.899" y="326.662" width="21.788" height="21.787"/>
    <rect x="331.899" y="348.449" width="21.788" height="21.791"/>
    <rect x="353.702" y="326.662" width="21.788" height="21.787"/>
    <rect x="375.475" y="326.68" width="21.789" height="21.788"/>
    <rect x="310.11" y="348.449" width="21.79" height="21.791"/>
</g>
<g id="TN" class="cartoState" name="Tennessee">
    <rect x="419.078" y="348.556" width="21.791" height="21.794"/>
    <rect x="462.654" y="348.556" width="21.792" height="21.794"/>
    <rect x="484.445" y="348.556" width="21.786" height="21.794"/>
    <rect x="506.231" y="348.556" width="21.794" height="21.794"/>
    <rect x="462.635" y="326.761" width="21.792" height="21.79"/>
    <rect x="397.267" y="326.761" width="21.789" height="21.79"/>
    <rect x="440.846" y="326.761" width="21.789" height="21.79"/>
    <rect x="419.054" y="326.761" width="21.792" height="21.79"/>
    <rect x="440.868" y="348.556" width="21.789" height="21.794"/>
    <rect x="375.486" y="348.556" width="21.792" height="21.794"/>
    <rect x="397.276" y="348.556" width="21.786" height="21.794"/>
</g>
<g id="KY" class="cartoState" name="Kentucky">
    <rect x="528.014" y="348.676" width="21.79" height="21.788"/>
    <rect x="528.029" y="326.886" width="21.792" height="21.79"/>
    <rect x="549.804" y="348.676" width="21.793" height="21.788"/>
    <rect x="571.597" y="348.676" width="21.789" height="21.788"/>
    <rect x="593.385" y="348.676" width="21.789" height="21.788"/>
    <rect x="549.821" y="326.886" width="21.789" height="21.79"/>
    <rect x="484.445" y="326.886" width="21.793" height="21.79"/>
    <rect x="506.238" y="326.886" width="21.791" height="21.79"/>
</g>
<g id="VA" class="cartoState" name="Virginia">
    <rect x="571.582" y="326.819" width="21.789" height="21.791"/>
    <rect x="593.371" y="326.819" width="21.791" height="21.791"/>
    <rect x="615.162" y="348.59" width="21.789" height="21.79"/>
    <rect x="636.95" y="348.59" width="21.791" height="21.79"/>
    <rect x="636.95" y="305.039" width="21.791" height="21.791"/>
    <rect x="636.95" y="326.819" width="21.791" height="21.791"/>
    <rect x="615.137" y="305.039" width="21.794" height="21.791"/>
    <rect x="615.137" y="326.819" width="21.794" height="21.791"/>
    <rect x="658.738" y="305.039" width="21.79" height="21.791"/>
    <rect x="658.738" y="326.819" width="21.79" height="21.791"/>
    <rect x="680.528" y="348.59" width="21.789" height="21.793"/>
    <rect x="658.738" y="348.59" width="21.79" height="21.79"/>
    <rect x="680.528" y="326.819" width="21.789" height="21.791"/>
</g>
<g id="NC" class="cartoState" name="North Carolina">
    <rect x="593.286" y="392.15" width="21.788" height="21.793"/>
    <rect x="615.108" y="392.15" width="21.792" height="21.793"/>
    <rect x="571.516" y="370.367" width="21.79" height="21.793"/>
    <rect x="636.916" y="392.15" width="21.79" height="21.793"/>
    <rect x="658.726" y="392.15" width="21.79" height="21.793"/>
    <rect x="593.305" y="370.367" width="21.786" height="21.793"/>
    <rect x="615.131" y="370.367" width="21.79" height="21.793"/>
    <rect x="680.532" y="392.15" width="21.789" height="21.793"/>
    <rect x="658.741" y="370.369" width="21.793" height="21.791"/>
    <rect x="658.726" y="413.921" width="21.794" height="21.791"/>
    <rect x="680.534" y="370.369" width="21.787" height="21.791"/>
    <rect x="615.108" y="413.921" width="21.792" height="21.791"/>
    <rect x="636.916" y="413.921" width="21.786" height="21.791"/>
    <rect x="549.672" y="370.367" width="21.795" height="21.793"/>
    <rect x="636.943" y="370.367" width="21.785" height="21.793"/>
</g>
<g id="DC" class="cartoState" name="District of Columbia">
    <rect x="768.818" y="349.15" width="21.792" height="21.791"/>
    <rect x="745.818" y="349.15" width="21.792" height="21.793"/>
    <rect x="745.904" y="370.207" width="21.788" height="21.792"/>
</g>
<g id="AK" class="cartoState" name="Alaska">
    <rect x="41.265" y="507.53" width="21.789" height="21.789"/>
    <rect x="41.265" y="529.317" width="21.789" height="21.789"/>
    <rect x="19.083" y="551.473" width="21.79" height="21.791"/>
</g>
<g id="HI" class="cartoState" name="Hawaii">
    <rect x="141.415" y="507.53" width="21.792" height="21.79"/>
    <rect x="163.206" y="529.317" width="21.792" height="21.791"/>
    <rect x="185.153" y="551.473" width="21.792" height="21.792"/>
    <rect x="206.944" y="551.473" width="21.792" height="21.791"/>
</g>
<g id="FL" class="cartoState" name="Florida">
    <rect x="571.543" y="479.308" width="21.793" height="21.788"/>
    <rect x="593.336" y="479.308" width="21.785" height="21.788"/>
    <rect x="615.121" y="501.088" width="21.793" height="21.791"/>
    <rect x="636.909" y="501.088" width="21.79" height="21.791"/>
    <rect x="658.699" y="653.615" width="21.793" height="21.791"/>
    <rect x="549.753" y="479.308" width="21.793" height="21.788"/>
    <rect x="658.699" y="588.247" width="21.793" height="21.79"/>
    <rect x="593.336" y="501.088" width="21.785" height="21.79"/>
    <rect x="636.909" y="522.879" width="21.79" height="21.789"/>
    <rect x="527.964" y="479.308" width="21.789" height="21.788"/>
    <rect x="506.178" y="479.308" width="21.786" height="21.788"/>
    <rect x="658.699" y="544.664" width="21.793" height="21.794"/>
    <rect x="658.699" y="631.824" width="21.793" height="21.791"/>
    <rect x="615.121" y="522.879" width="21.793" height="21.789"/>
    <rect x="636.909" y="653.615" width="21.79" height="21.791"/>
    <rect x="658.699" y="610.035" width="21.793" height="21.789"/>
    <rect x="636.909" y="631.824" width="21.79" height="21.791"/>
    <rect x="636.909" y="610.035" width="21.79" height="21.789"/>
    <rect x="636.909" y="588.247" width="21.79" height="21.79"/>
    <rect x="636.909" y="566.457" width="21.79" height="21.79"/>
    <rect x="615.121" y="544.664" width="21.793" height="21.794"/>
    <rect x="615.121" y="566.457" width="21.793" height="21.79"/>
    <rect x="615.121" y="588.247" width="21.793" height="21.79"/>
    <rect x="615.121" y="610.035" width="21.793" height="21.789"/>
    <rect x="658.699" y="566.457" width="21.793" height="21.79"/>
    <rect x="658.699" y="501.088" width="21.793" height="21.791"/>
    <rect x="658.699" y="522.879" width="21.793" height="21.794"/>
    <rect x="636.909" y="544.664" width="21.79" height="21.794"/>
    <rect x="571.543" y="501.088" width="21.793" height="21.79"/>
</g>
<g id="SC" class="cartoState" name="South Carolina">
    <rect x="636.896" y="479.269" width="21.787" height="21.79"/>
    <rect x="658.684" y="457.479" width="21.796" height="21.79"/>
    <rect x="658.684" y="435.691" width="21.796" height="21.79"/>
    <rect x="615.106" y="457.479" width="21.79" height="21.79"/>
    <rect x="615.106" y="479.269" width="21.79" height="21.79"/>
    <rect x="658.684" y="479.269" width="21.796" height="21.79"/>
    <rect x="636.896" y="457.479" width="21.787" height="21.79"/>
    <rect x="615.106" y="435.691" width="21.79" height="21.79"/>
    <rect x="636.896" y="435.691" width="21.787" height="21.79"/>
</g>
<g id="GA" class="cartoState" name="Georgia">
    <rect x="527.979" y="392.187" width="21.788" height="21.79"/>
    <rect x="549.767" y="392.187" width="21.793" height="21.788"/>
    <rect x="571.558" y="392.187" width="21.788" height="21.788"/>
    <rect x="527.941" y="370.396" width="21.789" height="21.79"/>
    <rect x="527.979" y="413.975" width="21.788" height="21.786"/>
    <rect x="549.767" y="413.972" width="21.793" height="21.789"/>
    <rect x="571.558" y="413.972" width="21.788" height="21.789"/>
    <rect x="571.558" y="457.552" width="21.788" height="21.791"/>
    <rect x="593.345" y="457.552" width="21.789" height="21.791"/>
    <rect x="593.336" y="435.764" width="21.789" height="21.792"/>
    <rect x="593.345" y="413.972" width="21.789" height="21.789"/>
    <rect x="527.979" y="457.552" width="21.788" height="21.791"/>
    <rect x="549.767" y="457.552" width="21.793" height="21.791"/>
    <rect x="571.558" y="435.764" width="21.788" height="21.792"/>
    <rect x="527.979" y="435.764" width="21.788" height="21.792"/>
    <rect x="549.767" y="435.764" width="21.793" height="21.792"/>
</g>
<g id="AL" class="cartoState" name="Alabama">
    <rect x="462.667" y="392.212" width="21.789" height="21.787"/>
    <rect x="484.456" y="392.212" width="21.79" height="21.787"/>
    <rect x="462.667" y="370.406" width="21.789" height="21.791"/>
    <rect x="484.456" y="370.406" width="21.79" height="21.791"/>
    <rect x="484.456" y="414.037" width="21.79" height="21.789"/>
    <rect x="462.667" y="414.037" width="21.789" height="21.789"/>
    <rect x="506.227" y="392.212" width="21.787" height="21.789"/>
    <rect x="506.227" y="370.408" width="21.79" height="21.789"/>
    <rect x="506.223" y="414.037" width="21.791" height="21.791"/>
</g>
<g id="MS" class="cartoState" name="Mississippi">
    <rect x="397.31" y="370.454" width="21.792" height="21.787"/>
    <rect x="419.1" y="370.454" width="21.788" height="21.787"/>
    <rect x="440.885" y="370.452" width="21.787" height="21.789"/>
    <rect x="419.095" y="392.241" width="21.79" height="21.789"/>
    <rect x="397.314" y="392.244" width="21.786" height="21.786"/>
    <rect x="440.877" y="392.244" width="21.79" height="21.786"/>
</g>
<g id="LA" class="cartoState" name="Louisiana">
    <rect x="353.681" y="370.26" width="21.788" height="21.792"/>
    <rect x="375.49" y="392.052" width="21.789" height="21.786"/>
    <rect x="353.681" y="413.838" width="21.788" height="21.791"/>
    <rect x="353.681" y="392.052" width="21.788" height="21.786"/>
    <rect x="375.49" y="413.838" width="21.789" height="21.791"/>
    <rect x="397.32" y="413.838" width="21.792" height="21.791"/>
    <rect x="375.493" y="370.26" width="21.787" height="21.792"/>
    <rect x="353.681" y="348.456" width="21.791" height="21.79"/>
</g>
<g id="TX" class="cartoState" name="Texas">
    <rect x="222.898" y="326.588" width="21.788" height="21.788"/>
    <rect x="201.108" y="370.219" width="21.79" height="21.791"/>
    <rect x="222.898" y="348.366" width="21.788" height="21.789"/>
    <rect x="244.686" y="348.366" width="21.791" height="21.789"/>
    <rect x="222.898" y="370.219" width="21.788" height="21.791"/>
    <rect x="244.686" y="370.219" width="21.791" height="21.791"/>
    <rect x="266.477" y="370.219" width="21.788" height="21.791"/>
    <rect x="288.265" y="479.164" width="21.791" height="21.79"/>
    <rect x="222.898" y="392.01" width="21.788" height="21.79"/>
    <rect x="244.686" y="392.01" width="21.791" height="21.79"/>
    <rect x="266.477" y="392.01" width="21.788" height="21.79"/>
    <rect x="288.265" y="392.01" width="21.791" height="21.79"/>
    <rect x="310.055" y="392.01" width="21.791" height="21.79"/>
    <rect x="331.842" y="392.01" width="21.792" height="21.79"/>
    <rect x="266.477" y="479.164" width="21.788" height="21.79"/>
    <rect x="266.477" y="457.378" width="21.788" height="21.789"/>
    <rect x="244.686" y="457.378" width="21.791" height="21.789"/>
    <rect x="201.108" y="392.01" width="21.79" height="21.79"/>
    <rect x="222.898" y="413.8" width="21.788" height="21.787"/>
    <rect x="244.686" y="413.8" width="21.791" height="21.788"/>
    <rect x="266.477" y="413.8" width="21.788" height="21.788"/>
    <rect x="288.265" y="413.8" width="21.791" height="21.788"/>
    <rect x="310.055" y="413.8" width="21.791" height="21.788"/>
    <rect x="331.842" y="413.8" width="21.792" height="21.788"/>
    <rect x="288.265" y="370.219" width="21.791" height="21.791"/>
    <rect x="266.477" y="348.366" width="21.788" height="21.789"/>
    <rect x="288.265" y="348.366" width="21.791" height="21.789"/>
    <rect x="331.842" y="370.219" width="21.792" height="21.791"/>
    <rect x="201.108" y="413.8" width="21.79" height="21.788"/>
    <rect x="222.898" y="435.585" width="21.788" height="21.792"/>
    <rect x="244.686" y="435.587" width="21.791" height="21.793"/>
    <rect x="266.477" y="435.587" width="21.788" height="21.793"/>
    <rect x="288.265" y="435.587" width="21.791" height="21.793"/>
    <rect x="310.055" y="435.587" width="21.791" height="21.793"/>
    <rect x="310.055" y="370.219" width="21.791" height="21.791"/>
    <rect x="201.129" y="348.366" width="21.79" height="21.789"/>
    <rect x="288.265" y="457.378" width="21.791" height="21.789"/>
    <rect x="179.317" y="370.223" width="21.79" height="21.787"/>
</g>
<g id="labels">
</g>
<g>
    <text transform="matrix(1 0 0 1 634.5459 253.0298)">PA</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 800.4951 22.7681)">ME</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 800.709 67.5225)">NH</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 728.4854 82.7822)">VT</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 730.2783 115.2788)">MA</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 797.8691 156.0396)">RI</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 730.168 159.1758)">CT</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 655.666 176.9756)">NY</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 761.4434 307.2148)">NJ</text>
</g>
    <text transform="matrix(1 0 0 1 720.6611 290.4951)">DE</text>
<g>
    <text transform="matrix(1 0 0 1 687.0957 310.6392)">MD</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 570.5723 305.1094)">WV</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 508.2764 284.7144)">OH</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 458.3867 188.1318)">MI</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 366.9663 176.5874)">WI</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 297.4551 176.5854)">MN</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 301.0615 219.4805)">IA</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 235.6074 190.542)">ND</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 235.3838 212.2583)">SD</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 236.0249 233.9722)">NE</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 446.6367 275.1074)">IN</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 385.3857 260.0415)">IL</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 324.7559 307.3965)">MO</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 253.7261 288.3877)">KS</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 146.2573 233.9702)">WY</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 119.6094 212.0845)">MT</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 189.4282 276.0938)">CO</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 138.3203 276.7612)">UT</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 95.2354 275.2827)">NV</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 100.6392 233.9722)">ID</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 18.2832 133.6523)">WA</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 26.7891 191.3711)">OR</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 23.4517 341.9648)">CA</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 124.792 348.0547)">AZ</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 181.3237 332.2461)">NM</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 254.1372 331.5869)">OK</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 313.8501 352.4258)">AR</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 417.4175 352.8994)">TN</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 536.9121 352.8994)">KY</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 629.7734 342.4941)">VA</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 630.7305 401.3809)">NC</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 759.7549 409.2383)">DC</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 20.1812 546.6758)">AK</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 164.9419 570.8096)">HI</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 631.5918 582.8545)">FL</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 630.5078 472.6221)">SC</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 554.1865 439.7744)">GA</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 476.4355 407.7295)">AL</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 405.7368 396.4111)">MS</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 363.5508 414.3857)">LA</text>
</g>
<g>
    <text transform="matrix(1 0 0 1 247.7451 416.5967)">TX</text>
</g>
<g id="stroke">
    <polygon fill="none" stroke-width="1.7" points="397.313,152.454 397.313,130.667 397.313,130.666 
        397.313,108.879 375.521,108.879 353.733,108.879 353.733,130.666 353.733,130.667 353.733,152.454 353.733,174.243 
        353.733,196.033 375.521,196.033 397.313,196.033 419.1,196.033 419.1,174.243 419.1,152.454   "/>
    <polygon fill="none" stroke-width="1.7" points="658.699,501.088 636.909,501.088 615.121,501.088 
        615.121,479.308 593.336,479.308 571.543,479.308 549.753,479.308 527.964,479.308 506.178,479.308 506.178,501.096 
        527.964,501.096 549.753,501.096 571.543,501.096 571.543,522.878 593.336,522.878 615.121,522.878 615.121,522.879 
        615.121,544.664 615.121,566.457 615.121,588.247 615.121,610.035 615.121,631.824 636.909,631.824 636.909,653.615 
        636.909,675.403 658.699,675.403 680.492,675.403 680.492,653.615 680.492,631.824 680.492,610.035 680.492,588.247 
        680.492,566.457 680.492,544.671 680.492,544.664 680.492,522.879 680.492,522.879 680.492,501.088     "/>
    <polygon fill="none" stroke-width="1.7" points="331.946,195.99 310.158,195.99 288.369,195.99 288.369,217.778 
        288.369,217.78 288.369,239.567 310.158,239.567 331.946,239.567 353.738,239.567 353.738,217.78 353.738,217.778 353.738,195.99    
        "/>
    <polygon fill="none" stroke-width="1.7" points="70.393,152.384 48.604,152.384 48.604,174.175 26.815,174.175 
        26.815,152.386 5.026,152.386 5.026,174.175 5.026,195.964 26.815,195.964 48.604,195.964 70.393,195.964 92.184,195.964 
        92.184,174.175 92.184,152.384   "/>
    <polygon fill="none" stroke-width="1.7" points="5.026,195.964 26.815,195.964 48.604,195.964 70.393,195.964 
        92.184,195.964 92.184,304.949 113.998,304.949 113.998,370.246 135.793,370.246 135.793,413.819 113.946,413.819 113.946,457.43 
        26.8,457.43 26.8,413.819 5.012,413.819  "/>
    <polygon fill="none" stroke-width="1.7" points="135.793,392.034 135.793,370.246 113.998,370.246 
        113.998,304.949 179.346,304.949 179.346,392.01  "/>
    <polygon fill="none" stroke-width="1.7" points="5.026,152.386 26.815,152.386 26.815,174.175 48.604,174.175 
        48.604,152.384 70.393,152.384 92.184,152.384 92.184,86.998 48.604,86.998 48.604,108.806 26.8,108.806 26.8,86.998 5.012,86.998 
            "/>
    <polygon fill="none" stroke-width="1.7" points="113.972,217.769 113.972,195.983 113.972,174.194 
        92.181,174.194 92.181,195.983 92.181,217.769 92.181,217.771 92.181,239.558 113.969,239.558 113.972,239.558 135.761,239.558 
        135.761,217.769     "/>
    <rect x="114.004" y="195.964" fill="none" stroke-width="1.7" width="65.362" height="21.791"/>
    <rect x="222.994" y="174.202" fill="none" stroke-width="1.7" width="65.361" height="21.79"/>
    <rect x="222.994" y="196.031" fill="none" stroke-width="1.7" width="65.361" height="21.79"/>
    <rect x="135.79" y="217.843" fill="none" stroke-width="1.7" width="65.361" height="21.789"/>
    <rect x="92.181" y="239.558" fill="none" stroke-width="1.7" width="43.612" height="65.322"/>
    <rect x="135.904" y="239.558" fill="none" stroke-width="1.7" width="43.419" height="65.322"/>
    <rect x="179.519" y="239.558" fill="none" stroke-width="1.7" width="65.286" height="65.322"/>
    <rect x="462.737" y="370.333" fill="none" stroke-width="1.7" width="65.284" height="65.324"/>
    <rect x="615.201" y="435.855" fill="none" stroke-width="1.7" width="65.284" height="65.322"/>
    <polygon fill="none" stroke-width="1.7" points="593.345,414.101 615.155,414.101 615.155,479.422 
        527.979,479.422 527.979,370.464 549.804,370.464 549.804,392.16 593.305,392.16   "/>
    <polygon fill="none" stroke-width="1.7" points="615.155,435.764 615.155,414.101 593.345,414.101 
        593.305,392.16 549.804,392.16 549.804,370.464 702.317,370.464 702.317,413.943 680.516,413.943 680.516,435.855   "/>
    <polygon fill="none" stroke-width="1.7" points="179.372,368.816 179.372,304.88 222.898,304.88 222.898,348.376 
        201.13,348.376 201.13,370.278 179.346,370.278   "/>
    <polygon fill="none" stroke-width="1.7" points="244.732,239.643 222.994,239.643 222.994,217.854 
        288.355,217.854 288.355,261.297 244.775,261.297     "/>
    <rect x="244.806" y="261.297" fill="none" stroke-width="1.7" width="65.251" height="43.494"/>
    <rect x="397.356" y="370.403" fill="none" stroke-width="1.7" width="65.251" height="43.627"/>
    <polygon fill="none" stroke-width="1.7" points="244.643,326.59 244.643,348.369 310.055,348.369 310.055,304.79 
        222.912,304.79 222.912,326.588  "/>
    <polygon fill="none" stroke-width="1.7" points="222.912,326.588 244.643,326.588 244.643,348.369 
        310.055,348.369 310.055,370.209 353.688,370.209 353.688,435.587 331.842,435.587 331.842,457.378 310.055,457.378 
        310.055,500.954 266.477,500.954 266.477,479.164 244.686,479.164 244.686,457.378 222.898,457.378 222.898,435.585 
        201.108,435.585 201.108,392.01 179.346,392.01 179.346,370.278 201.13,370.278 201.13,348.376 222.898,348.376 222.898,327.035     
        "/>
    <path fill="none" stroke-width="1.7" d="M353.688,370.592"/>
    <polygon fill="none" stroke-width="1.7" points="353.688,369.562 353.688,348.449 375.486,348.449 
        375.486,370.349 397.31,370.349 397.31,414.03 419.1,414.03 419.1,435.629 353.688,435.629     "/>
    <polygon fill="none" stroke-width="1.7" points="353.732,108.867 331.943,108.867 331.943,130.643 
        331.935,130.643 331.935,130.657 310.147,130.657 288.358,130.657 288.358,152.446 288.358,174.236 288.358,196.026 
        310.147,196.026 331.935,196.026 331.935,196.01 353.725,196.01 353.725,174.221 353.725,152.434 353.725,130.657 353.732,130.657 
            "/>
    <g>
        <polygon fill="none" stroke-width="1.7" points="419.114,108.874 397.326,108.874 397.326,130.663 
            419.114,130.663 440.905,130.663 440.905,108.874         "/>
        <polygon fill="none" stroke-width="1.7" points="506.271,152.454 484.482,152.454 484.482,130.663 
            462.694,130.663 440.905,130.663 440.905,152.454 440.905,174.243 440.905,196.031 440.905,217.822 462.694,217.822 
            484.482,217.822 506.271,217.822 528.061,217.822 528.061,196.033 528.061,196.031 528.061,174.243 528.061,152.454         "/>
    </g>
    <polygon fill="none" stroke-width="1.7" points="462.679,217.834 440.891,217.834 440.891,239.623 
        440.891,261.412 440.891,283.201 440.891,304.97 419.112,304.97 419.112,326.759 440.891,326.759 440.891,326.77 462.679,326.77 
        484.471,326.77 484.471,304.99 484.471,304.979 484.471,283.201 484.471,261.412 484.471,239.623 484.471,217.834   "/>
    <g>
        <polygon fill="none" stroke-width="1.7" points="724.119,174.299 724.119,152.51 724.119,130.721 
            724.119,108.931 724.119,87.145 702.331,87.145 680.545,87.145 680.545,108.931 658.756,108.931 658.756,130.721 658.756,130.746 
            636.963,130.746 636.963,152.51 615.174,152.51 615.174,174.299 593.385,174.299 593.385,196.09 571.6,196.09 571.6,217.878 
            593.385,217.878 615.174,217.878 636.963,217.878 658.756,217.878 680.545,217.878 702.331,217.878 724.119,217.878 
            724.119,196.09      "/>
        <polygon fill="none" stroke-width="1.7" points="745.922,239.665 767.712,239.665 767.712,217.875 
            746.126,217.875 745.912,217.878 724.119,217.878 724.119,239.669 745.509,239.669         "/>
    </g>
    <polygon fill="none" stroke-width="1.7" points="767.727,130.771 767.694,130.771 745.936,130.771 
        724.145,130.771 724.145,152.561 724.145,174.349 724.145,196.141 745.936,196.141 745.936,174.349 767.694,174.349 
        767.727,174.349 789.487,174.349 789.487,152.561 789.487,130.771     "/>
    <polygon fill="none" stroke-width="1.7" points="811.336,0 811.307,0 789.546,0 789.546,21.79 789.546,43.579 
        811.307,43.579 811.336,43.579 833.096,43.579 833.096,21.79 833.096,0    "/>
    <polygon fill="none" stroke-width="1.7" points="811.336,43.625 811.307,43.625 789.546,43.625 789.546,65.412 
        789.546,87.201 811.307,87.201 811.336,87.201 833.096,87.201 833.096,65.412 833.096,43.625   "/>
    <polygon fill="none" stroke-width="1.7" points="811.336,130.758 811.307,130.758 789.546,130.758 
        789.546,152.55 789.546,174.337 811.307,174.337 811.336,174.337 833.096,174.337 833.096,152.55 833.096,130.758   "/>
    <polygon fill="none" stroke-width="1.7" points="756.84,65.33 756.879,65.33 789.546,65.33 789.546,76.267 
        789.546,87.201 756.879,87.201 756.84,87.201 724.173,87.201 724.173,76.267 724.173,65.33     "/>
    <polygon fill="none" stroke-width="1.7" points="833.089,130.708 724.119,130.708 724.119,87.145 833.089,87.145 
        833.089,108.92 854.876,108.92 854.876,130.708   "/>
    <polygon fill="none" stroke-width="1.7" points="288.383,239.672 331.946,239.672 331.946,261.289 
        353.729,261.289 353.729,283.092 375.529,283.092 375.529,326.68 310.055,326.68 310.055,261.297 288.355,261.297   "/>
    <polygon fill="none" stroke-width="1.7" points="353.633,326.58 310.055,326.58 310.055,370.219 353.633,370.219 
        353.633,348.456 397.292,348.456 397.292,326.68  "/>
    <polyline fill="none" stroke-width="1.7" points="375.353,326.832 419.112,326.759 419.112,304.97 
        440.891,304.97 440.891,283.201 440.891,261.412 440.891,239.623 419.094,239.623 419.1,196.033 397.313,196.033 375.521,196.033 
        353.733,196.033 353.733,239.567 331.946,239.672 331.946,261.289 353.729,261.289 353.729,283.092 375.529,283.092 
        375.529,326.672     "/>
    <polygon fill="none" stroke-width="1.7" points="484.471,326.77 484.471,348.676 528.028,348.676 
        528.028,370.464 375.486,370.464 375.486,348.456 397.292,348.456 397.292,326.795     "/>
    <polygon fill="none" stroke-width="1.7" points="549.834,217.822 571.579,217.822 571.579,326.749 
        484.482,326.749 484.482,217.822 506.257,217.822 506.257,239.64 549.834,239.64   "/>
    <polygon fill="none" stroke-width="1.7" points="571.597,348.556 571.597,326.797 484.456,326.797 
        484.456,348.676 528.021,348.676 528.021,370.367 615.091,370.367 615.091,348.556     "/>
    <polygon fill="none" stroke-width="1.7" points="680.534,326.827 680.534,305.039 615.137,305.039 
        615.137,326.819 571.597,326.819 571.597,348.676 615.137,348.676 615.137,370.369 680.528,370.369 680.534,370.369 
        702.321,370.369 702.321,326.827     "/>
    <polygon fill="none" stroke-width="1.7" points="571.579,261.434 571.579,217.822 724.122,217.822 
        724.122,283.234 593.385,283.234 593.385,261.442     "/>
    <polygon fill="none" stroke-width="1.7" points="593.282,283.234 593.282,283.016 593.282,261.434 
        571.604,261.434 571.604,326.819 593.282,326.819 615.174,326.819 615.174,283.234     "/>
    <rect x="724.122" y="261.444" fill="none" stroke-width="1.7" width="21.785" height="65.393"/>
    <polygon fill="none" stroke-width="1.7" points="724.097,326.78 724.097,304.99 724.094,304.99 724.094,283.244 
        702.312,283.244 702.312,283.201 680.521,283.201 658.728,283.201 636.94,283.201 615.151,283.201 615.151,304.99 636.94,304.99 
        658.728,304.99 680.521,304.99 680.521,326.78 702.312,326.78 702.312,348.568 724.097,348.568 724.097,370.354 745.889,370.354 
        745.889,348.568 745.889,326.78  "/>
    <polygon fill="none" stroke-width="1.7" points="811.273,348.628 745.889,348.628 745.889,261.444 
        724.014,261.444 724.122,239.68 789.478,239.68 789.478,283.263 811.273,283.263   "/>
    <polygon fill="none" stroke-width="1.7" points="752.904,392.207 796.61,392.207 796.61,435.782 774.818,435.782 
        774.818,413.999 752.904,413.999     "/>
</g>
</svg></div></div>
<!-- <div id="mapStates" class="hideIT"><svg id="USSTATES" width="800" height="600" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid"></svg></div> -->
</div>
</div> <!-- end presidential stuff -->

<!-- SENATE PANES: WE DON'T EVEN HAVE THESE RACES -->
<div id="senate" class="dataviz">
<small class="footnote">Notes: Two independent senators caucus with Democrats. In Louisiana's Senate race, there's a run-off on Dec. 10 nobody received a majority vote</small>
<div class="mapBox">
<div id="mapSen" class="map geo"><svg id="USSENATE" width="800" height="600" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid"></svg>
<div class="sideStates"><div class="block stateBlock VT" name="Vermont" ab="VTs">VT</div><div class="block stateBlock NH" name="New Hampshire" ab="NHs">NH</div><div class="block stateBlock CT" name="Connecticut" ab="CTs">CT</div><div class="block stateBlock MD" name="Maryland" ab="MDs">MD</div></div>
</div>
</div>
</div> <!-- end senate stuff -->

<!-- GOVERNORS PANES: FOR THOSE LONGING FOR THEIR NORTH DAKOTAN HOME -->
<div id="governors" class="dataviz">
<div class="mapBox">
<small class="footnote">Note: Alaska has an independent governor</small>
<div id="mapGov" class="map geo"><svg id="USGOV" width="800" height="600" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid"></svg>
<div class="sideStates"><div class="block stateBlock VT" name="Vermont" ab="VTg">VT</div><div class="block stateBlock NH" name="New Hampshire" ab="NHg">NH</div><div class="block stateBlock DE" name="Delaware" ab="DEg">DE</div></div>
</div>
</div>
</div> <!-- end govenors stuff -->

<!-- HOUSE PANES: CALIFORNIA AND LOUISANA HAVE A SPECIAL PLACE IN CONGRESSIONAL HELL -->
<div id="house" class="dataviz">
<div class="mapBox">
<div id="mapHouse" class="map geo"><svg id="USHOUSE" width="800" height="600" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid"></svg></div>
<div id="cartoHouse" class="map normal carto"><svg width="800" height="600" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid"></svg></div>
<!-- <div id="mapMN" class="map geo"><svg id="USHOUSEMN" width="800" height="600" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid"></svg></div> -->
</div>
</div> <!-- end house stuff -->

<!-- MNHOUSE PANES: WHAT MINNPOST READERS TRULY CARE ABOUT -->
<div id="mnhouse" class="dataviz">
<small class="footnote">Note: Some candidates are running unopposed</small>
<div class="mapBox">
      <div class="mapState map geo"><svg id="MNHOUSE" width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
      <div class="mapMetro map geo metroMap"><svg id="MNHOUSEMETRO" width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
      <div class="cartoState map normal carto"><svg width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
      <div class="cartoMetro map normal carto"><svg width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
</div>
</div> <!-- end mnhouse stuff -->

<!-- MNSENATE PANES: ON YEARS THAT END IN SIX SENATORIAL WINNERS ALSO GET A LIVE PONY -->
<div id="mnsenate" class="dataviz">
<small class="footnote">Note: Some candidates are running unopposed</small>
<div class="mapBox">
      <div class="mapState map geo"><svg id="MNSENATE" width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
      <div class="mapMetro map geo metroMap"><svg id="MNSENATEMETRO" width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
      <div class="cartoState map normal carto"><svg width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
      <div class="cartoMetro map normal carto"><svg width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
</div>
</div> <!-- end mnsenate stuff -->

<!-- CONTEXT TO UNRAVEL THE MYSTERY OF WHAT RED AND BLUE COULD POSSIBLY MEAN ON THE MAPS -->
<div id="rightSide">

<!-- COLOR SCALE LEGENDS: CAN'T HAVE TOO MANY OF THESE -->
<div id="legends"> 
<div id="legendMargins" class="legendBlock">
  <div class='partyBlock'>
    <div class='dparty legendLabel'>Clinton</div>
    <div class='dlean brick'></div>
    <div class='democrat brick'></div>
    <div class="tinybreak"></div>
    <div class='legendLabel'></div>
    <div class='brick smallLabel'>50%</div>
    <div class='brick smallLabel'>70%</div>  
  </div>
  <div class='partyBlock'>
    <div class='rparty legendLabel'>Trump</div>
    <div class='rlean brick'></div>
    <div class='republican brick'></div>
    <div class="tinybreak"></div>
    <div class='legendLabel'></div>
    <div class='brick smallLabel'>50%</div>
    <div class='brick smallLabel'>70%</div>   
  </div>
  <div class='partyBlock'>
    <div class='iparty legendLabel'>IND</div>
    <div class='green2 brick'></div>
    <div class='green4 brick'></div>
    <div class="tinybreak"></div>
    <div class='legendLabel'></div>
    <div class='brick smallLabel'>50%</div>
    <div class='brick smallLabel'>70%</div>   
  </div>
<!--     <div class="breaker"></div> -->
<!--     <div class='partyBlock'>
    <div class='dparty legendLabel'>DEM</div>
    <div class='d4 brick'></div>
    <div class='d3 brick'></div>
    <div class='d2 brick'></div>
    <div class='d1 brick'></div>
    <div class="tinybreak"></div>
    <div class='legendLabel'></div>
    <div class='brick smallLabel'>80%</div> 
    <div class='brick smallLabel'>70%</div> 
    <div class='brick smallLabel'>60%</div> 
    <div class='brick smallLabel'>50%</div>
  </div>
  <div class='partyBlock'>
    <div class='green4 brick'></div>
    <div class='r1 brick'></div>
    <div class='r2 brick'></div>
    <div class='r3 brick'></div>
    <div class='r4 brick'></div>
    <div class='rparty legendLabel'>GOP</div>
    <div class="tinybreak"></div>
    <div class='brick smallLabel'>IND</div>
    <div class='brick smallLabel'>50%</div>
    <div class='brick smallLabel'>60%</div> 
    <div class='brick smallLabel'>70%</div>
    <div class='brick smallLabel'>80%</div>
    <div class='legendLabel'></div>
  </div> -->
</div>

<div id="legendWinners" class="legendBlock">
<!--   <div class="breaker"></div> -->
  <div class='partyBlock'>
    <div class='dparty legendLabel'>Clinton</div>
    <div class='dlean brick'></div>
    <div class='democrat brick'></div>
    <div class="tinybreak"></div>
    <div class='legendLabel'></div>
    <div class='brick smallLabel'>Lean</div>
    <div class='brick smallLabel'>Win</div>  
  </div>
  <div class='partyBlock'>
    <div class='rparty legendLabel'>Trump</div>
    <div class='rlean brick'></div>
    <div class='republican brick'></div>
    <div class="tinybreak"></div>
    <div class='legendLabel'></div>
    <div class='brick smallLabel'>Lean</div>
    <div class='brick smallLabel'>Win</div>   
  </div>
  <div class='partyBlock'>
    <div class='iparty legendLabel'>IND</div>
    <div class='green2 brick'></div>
    <div class='green4 brick'></div>
    <div class="tinybreak"></div>
    <div class='legendLabel'></div>
    <div class='brick smallLabel'>Lean</div>
    <div class='brick smallLabel'>Win</div>   
  </div>
</div>
</div>

<div class="zoom">Reset</div>

</div>

<div class="breaker mobileHide"></div>

<!-- WHERE THE VERY HELPFUL TABLES LIVE -->
<div class="table" id="table">
<div id="infobox"></div>
<div class="filter"><input type="search" class="filter_box" placeholder="Search races by location or candidate"></input></div>
<div id="allResults">
    <div class='president bigBoard'></div>
    <div class='house bigBoard'></div>
    <div class='senate bigBoard'></div>
    <div class='governors bigBoard'></div>
    <div class='mnhouse bigBoard'></div>
    <div class='mnsenate bigBoard'></div>
</div>
</div> <!-- end table -->

</div>
<!-- end datavizPane -->
</div>
<!-- end fulldataviz -->

</div>
<!-- end wrapper -->

<!-- FALLBACK CONTAINER IN CASE THIS ELECTION SOMEHOW GETS WORSE -->
<div id="fallback">
</div>
<!-- end fallback -->

</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src="//d3js.org/topojson.v1.min.js"></script>

<script>
var thisView = "us";

//D3 CLICKY MAP BINDINGS
jQuery.fn.d3Click = function () {
  this.each(function (i, e) {
    var evt = document.createEvent("MouseEvents");
    evt.initMouseEvent("click", true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);

    e.dispatchEvent(evt);
  });
};

jQuery.fn.d3Down = function () {
  this.each(function (i, e) {
    var evt = document.createEvent("MouseEvents");
    evt.initMouseEvent("mousedown", true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);

    e.dispatchEvent(evt);
  });
};

jQuery.fn.d3Up = function () {
  this.each(function (i, e) {
    var evt = document.createEvent("MouseEvents");
    evt.initMouseEvent("mouseup", true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);

    e.dispatchEvent(evt);
  });
};

//WE HAVE A BINARY POLITICAL PARTY SYSTEM UNTIL YOU HAVE TO CRUNCH NUMBERS ON ELECTION NIGHT
function fetchData(district,state,type,dataCompare,race,ev,label,evcd){

//initialize top level variables 
var stateName = '';
var statePostal = '';
var precinctsReporting = 0;
var precinctsTotal = 0;
var precinctsReportingPct = 0;
var lastUpdated = 0;

var fipsCode = '';
var seatName = '';
var seatNum = '';

var voteCountT = 0;

//initialize candidate arrays
var first = [];
var last = [];
var party = [];
var incumbent = [];
var voteCount = [];
var winner = [];

//initialize sorting array
var sortAll = [];

//run through data and assign variables to candidate arrays
  for (var i=0; i < dataCompare.races.length; i++) {
   if (race == "ushouse" || race == "mnhouse" || race == "mnsenate"){
    if (district == "District 0"){
      if (dataCompare.races[i].seatName == "District 1") {
     for (var j=0; j < dataCompare.races[i].reportingUnits.length; j++) {
         if (dataCompare.races[i].reportingUnits[j].stateName == state){
              stateName = dataCompare.races[i].reportingUnits[j].stateName;
              statePostal = dataCompare.races[i].reportingUnits[j].statePostal;
              precinctsReporting = dataCompare.races[i].reportingUnits[j].precinctsReporting;
              precinctsTotal = dataCompare.races[i].reportingUnits[j].precinctsTotal;
              precinctsReportingPct = dataCompare.races[i].reportingUnits[j].precinctsReportingPct;
              lastUpdated = dataCompare.races[i].reportingUnits[j].lastUpdated;

           for (var k=0; k < dataCompare.races[i].reportingUnits[j].candidates.length; k++) {
              first[k] = dataCompare.races[i].reportingUnits[j].candidates[k].first;
              last[k] = dataCompare.races[i].reportingUnits[j].candidates[k].last;
              party[k] = dataCompare.races[i].reportingUnits[j].candidates[k].party;
              incumbent[k] = dataCompare.races[i].reportingUnits[j].candidates[k].incumbent;
              voteCount[k] = dataCompare.races[i].reportingUnits[j].candidates[k].voteCount;
              winner[k] = dataCompare.races[i].reportingUnits[j].candidates[k].winner; 
           } //end k loop
         } //end if
     } //end j loop
    } //end if
}
     else {
        if (dataCompare.races[i].seatName == district) {
     for (var j=0; j < dataCompare.races[i].reportingUnits.length; j++) {
         if (dataCompare.races[i].reportingUnits[j].stateName == state){
              stateName = dataCompare.races[i].reportingUnits[j].stateName;
              statePostal = dataCompare.races[i].reportingUnits[j].statePostal;
              precinctsReporting = dataCompare.races[i].reportingUnits[j].precinctsReporting;
              precinctsTotal = dataCompare.races[i].reportingUnits[j].precinctsTotal;
              precinctsReportingPct = dataCompare.races[i].reportingUnits[j].precinctsReportingPct;
              lastUpdated = dataCompare.races[i].reportingUnits[j].lastUpdated;

           for (var k=0; k < dataCompare.races[i].reportingUnits[j].candidates.length; k++) {
              first[k] = dataCompare.races[i].reportingUnits[j].candidates[k].first;
              last[k] = dataCompare.races[i].reportingUnits[j].candidates[k].last;
              party[k] = dataCompare.races[i].reportingUnits[j].candidates[k].party;
              incumbent[k] = dataCompare.races[i].reportingUnits[j].candidates[k].incumbent;
              voteCount[k] = dataCompare.races[i].reportingUnits[j].candidates[k].voteCount;
              winner[k] = dataCompare.races[i].reportingUnits[j].candidates[k].winner;
           } //end k loop
         } //end if
     } //end j loop
    } //end if
     }
   } else {
     for (var j=0; j < dataCompare.races[i].reportingUnits.length; j++) {
       if (state != null && evcd != null) {
         if (dataCompare.races[i].reportingUnits[j].statePostal == state && dataCompare.races[i].reportingUnits[j].reportingunitName == evcd){
              stateName = dataCompare.races[i].reportingUnits[j].stateName;
              statePostal = dataCompare.races[i].reportingUnits[j].statePostal;
              precinctsReporting = dataCompare.races[i].reportingUnits[j].precinctsReporting;
              precinctsTotal = dataCompare.races[i].reportingUnits[j].precinctsTotal;
              precinctsReportingPct = dataCompare.races[i].reportingUnits[j].precinctsReportingPct;
              lastUpdated = dataCompare.races[i].reportingUnits[j].lastUpdated;

           for (var k=0; k < dataCompare.races[i].reportingUnits[j].candidates.length; k++) { 
              first[k] = dataCompare.races[i].reportingUnits[j].candidates[k].first;
              last[k] = dataCompare.races[i].reportingUnits[j].candidates[k].last;
              party[k] = dataCompare.races[i].reportingUnits[j].candidates[k].party;
              incumbent[k] = dataCompare.races[i].reportingUnits[j].candidates[k].incumbent;
              voteCount[k] = dataCompare.races[i].reportingUnits[j].candidates[k].voteCount;
              winner[k] = dataCompare.races[i].reportingUnits[j].candidates[k].winner;
           } //end k loop
         }
      } else if (state != null){
         if (dataCompare.races[i].reportingUnits[j].stateName == state){
              stateName = dataCompare.races[i].reportingUnits[j].stateName;
              statePostal = dataCompare.races[i].reportingUnits[j].statePostal;
              precinctsReporting = dataCompare.races[i].reportingUnits[j].precinctsReporting;
              precinctsTotal = dataCompare.races[i].reportingUnits[j].precinctsTotal;
              precinctsReportingPct = dataCompare.races[i].reportingUnits[j].precinctsReportingPct;
              lastUpdated = dataCompare.races[i].reportingUnits[j].lastUpdated;

           for (var k=0; k < dataCompare.races[i].reportingUnits[j].candidates.length; k++) { 
              first[k] = dataCompare.races[i].reportingUnits[j].candidates[k].first;
              last[k] = dataCompare.races[i].reportingUnits[j].candidates[k].last;
              party[k] = dataCompare.races[i].reportingUnits[j].candidates[k].party;
              incumbent[k] = dataCompare.races[i].reportingUnits[j].candidates[k].incumbent;
              voteCount[k] = dataCompare.races[i].reportingUnits[j].candidates[k].voteCount;
              winner[k] = dataCompare.races[i].reportingUnits[j].candidates[k].winner;
           } //end k loop
         }
      } else if (district != null) {
         if (dataCompare.races[i].reportingUnits[j].fipsCode == district){
              stateName = dataCompare.races[i].reportingUnits[j].stateName;
              statePostal = dataCompare.races[i].reportingUnits[j].statePostal;
              precinctsReporting = dataCompare.races[i].reportingUnits[j].precinctsReporting;
              precinctsTotal = dataCompare.races[i].reportingUnits[j].precinctsTotal;
              precinctsReportingPct = dataCompare.races[i].reportingUnits[j].precinctsReportingPct;
              lastUpdated = dataCompare.races[i].reportingUnits[j].lastUpdated;

           for (var k=0; k < dataCompare.races[i].reportingUnits[j].candidates.length; k++) { 
              first[k] = dataCompare.races[i].reportingUnits[j].candidates[k].first;
              last[k] = dataCompare.races[i].reportingUnits[j].candidates[k].last;
              party[k] = dataCompare.races[i].reportingUnits[j].candidates[k].party;
              incumbent[k] = dataCompare.races[i].reportingUnits[j].candidates[k].incumbent;
              voteCount[k] = dataCompare.races[i].reportingUnits[j].candidates[k].voteCount;
              winner[k] = dataCompare.races[i].reportingUnits[j].candidates[k].winner;
           } //end k loop
         }
      } 
     } //end j loop
   }
} //end i loop

//sort arrays by vountCount
for (var i = 0; i < voteCount.length; i++) {
    sortAll.push({ 'first': first[i], 'last': last[i], 'party': party[i], 'incumbent': incumbent[i], 'voteCount': voteCount[i], 'winner': winner[i] });
}

sortAll.sort(function(a, b) {
  return b.voteCount - a.voteCount;
});

first = [];
last = [];
party = [];
incumbent = [];
voteCount = [];
winner = [];

for (var i = 0; i < sortAll.length; i++) {
   first.push(sortAll[i].first);
   last.push(sortAll[i].last);
   party.push(sortAll[i].party);
   incumbent.push(sortAll[i].incumbent);
   voteCount.push(sortAll[i].voteCount);
   winner.push(sortAll[i].winner);
} 


//initialize and calculate some miscellaneous variables for printing results
for (var i=0; i < voteCount.length; i++){
  voteCountT += voteCount[i];
}

var topPCT = voteCount[0] / voteCountT;

var evString = "";
if (ev != null) { evString = "<span class='ev'> - " + ev + " electoral votes</span>"; }

var stateString = state;
if (label != null) { stateString = label + ", " + statePostal; } else { stateString = state; }

var iMark = [];
for (var i = 0; i < incumbent.length; i++) {
if (incumbent[i] == true) { iMark[i] = "*"; }
else { iMark[i] = ""; }
}

var wMark = [];
for (var i = 0; i < last.length; i++) {
if (winner[i] == "X") { wMark[i] = "&#x2714;"; }
else if (winner[i] == "R") { wMark[i] = "-R"; }
else { wMark[i] = ""; }
}

var colors = [];
for (var i=0; i < last.length; i++){
  var thisPCT = voteCount[i] / voteCountT;
    if (party[i] == "GOP"){
      if (thisPCT >= .80) { colors[i] = "#d84c27"; } 
      else if (thisPCT >= .70) { colors[i] = "#df6a4c"; } 
      else if (thisPCT >= .60) { colors[i] = "#e58970"; } 
      else if (thisPCT >= 0) { colors[i] = "#eca795"; } 
    }
    else if (party[i] == "Dem") { 
      if (thisPCT >= .80) { colors[i] = "#2b7ab5"; } 
      else if (thisPCT >= .70) { colors[i] = "#4f90c1"; } 
      else if (thisPCT >= .60) { colors[i] = "#73a7ce"; } 
      else if (thisPCT >= 0) { colors[i] = "#97bedb"; } 
    }
    else if (thisPCT > 0) { colors[i] = "#299E3D"; }
    else { colors[i] = "#bbbbbb"; }
}


//return precincts
if (type == "pct"){ return precinctsReportingPct; }

//return timestamp
if (type == "timestamp"){ return lastUpdated; }

//return all votes
if (type == "votesT"){ return voteCountT; }

//return dem votes
if (type == "votesD"){
    for (var i = 0; i < last.length; i++) {
    if (party[i] == "Dem") { return voteCount[i]; }
    }
}

//return gop votes
if (type == "votesR"){
    for (var i = 0; i < last.length; i++) {
    if (party[i] == "GOP") { return voteCount[i]; }
    }
}

//return winner
if (type == "winner"){
    if (winner[0] == "X" && party[0] == "GOP"){ return "GOP Win"; }
    else if (winner[0] == "X" && party[0] == "Dem"){ return "DEM Win"; }
    else if (winner[0] == "X") { return "IND Win"; }
}

//return lean
if (type == "lean"){
    if (winner[0] == "X" && party[0] == "GOP"){ return "#d34A44"; }
    else if (winner[0] == "X" && party[0] == "Dem"){ return "#3585BC"; }
    else if (winner[0] == "X") { return "#299E3D"; }
    else if (party[0] == "GOP") { return "#f7816E"; }
    else if (party[0] == "Dem") { return "#72A9D6"; }
    else if (voteCount[0] == 0) { return "#bbbbbb"; } 
    else { return "#bbbbbb"; } 
}

//return color
if (type == "colors"){ return colors[0]; }

//return tooltips
if (type == "tooltip"){
  var tooltipString = "<div class='districtName'>" + stateString + "</div>";
  if (last.length < 2) { var howMany = last.length; }
  else { var howMany = 2; }

  for (var i = 0; i < howMany; i++) {
    var thisPCT = "0%";
    if (voteCountT > 0) { thisPCT = d3.format("%")(voteCount[i] / voteCountT); }
    tooltipString += "<div class='candidate'>" + iMark[i] + last[i] + " " + wMark[i] + "</div><div class='pct' style='background-color:" + colors[i] + "'>" + thisPCT + "</div><div class='smallbreak'>"
  }

  return tooltipString;
}

//return tables
if (type == "table"){
  var stateColor = "";
  if (last.length < 3) { var howMany = last.length; }
  else { var howMany = 3; }

  var tableString = "<div class='districtName'>" + stateString + " " + evString + "</div><div class='resultsRow'><div class='resultsHead'>Candidate</div><div class='counts resultsHead'>#</div><div class='pct resultsHead'>%</div></div>";

  for (var i = 0; i < howMany; i++) {
    var thisPCT = "0%";
    if (voteCountT > 0) { thisPCT = d3.format("%")(voteCount[i] / voteCountT); }

    stateColor = ""

    if (winner[i] == "X" && party[i] == "GOP") { stateColor = "republican"; }
    else if (winner[i] == "X" && party[i] == "Dem") { stateColor = "democrat"; }
    else if (winner[i] == "X") { stateColor = "green4"; }

    tableString += "<div class='resultsRow'><div class='candidate'>" + iMark[i] + first[i] + " " + last[i] + " (" + party[i] + ")" + " " + wMark[i] + "</div><div class='counts'>" + d3.format(",")(voteCount[i]) + "</div><div class='pct " + stateColor + "' style='border:2px solid " + colors[i] + ";'>" + thisPCT + "</div></div>"
  }

  return tableString + "<div class='reportingRow'><span class='pctReported'>" + precinctsReporting + "</span> / <span class='pctAll'>" + precinctsTotal + "</span> (" + precinctsReportingPct + "%) precincts reporting</div>";
}

//return boards
if (type == "board"){
var pct1 = "0%";
var pct2 = "0%";
var color1 = "";
var color2 = "";
var candidate1 = first[0] + " " + last[0];
var candidate2 = first[1] + " " + last[1];
var stateColor1 = "";
var stateColor2 = "";
var dTest = false;

  for (var i = 0; i < 2; i++) {
    if (party[i] == "Dem" && pct1 == "0%"){
        pct1 = d3.format("%")(voteCount[i] / voteCountT); 
        color1 = colors[i];
        if (winner[i] == "X") { stateColor1 = "democrat"; }
    }
    else if (party[i] == "Dem" && pct1 != "0%"){
        pct2 = d3.format("%")(voteCount[i] / voteCountT); 
        color2 = colors[i];
        if (winner[i] == "X") { stateColor2 = "democrat"; }
    }
    else if (party[i] == "GOP" && pct2 == "0%"){
        pct2 = d3.format("%")(voteCount[i] / voteCountT); 
        color2 = colors[i];
        if (winner[i] == "X") { stateColor2 = "republican"; }
    }
    else if (party[i] == "GOP" && pct2 != "0%"){
        pct1 = d3.format("%")(voteCount[i] / voteCountT); 
        color1 = colors[i];
        if (winner[i] == "X") { stateColor1 = "republican"; }
    }
  }

    if (voteCountT == 0) { pct1 = "0%"; pct2 = "0%"; }

    if (race == "president" && evcd != null){
    return "<div id='evcd" + label + "' class='tableRow evcd' name='" + label + "'><div class='stateBlockR'>" + label + "</div><div class='pctBox'>" + ev + "</div><div class='pctBox " + stateColor1 + "' style='border:2px solid " + color1 + ";'>" + pct1 + "</div><div class='pctBox " + stateColor2 + "' style='border:2px solid " + color2 + ";'>" + pct2 + "</div><div class='pctBox reporting'>" + precinctsReportingPct + "%</div><div class='searchTerms'>" + stateName + " " + candidate1 + " " + candidate2 +  "</div></div>";
    }

    if (race == "president"){
    return "<div class='tableRow' name='" + statePostal + "'><div class='stateBlockR'>" + statePostal + "</div><div class='pctBox'>" + ev + "</div><div class='pctBox " + stateColor1 + "' style='border:2px solid " + color1 + ";'>" + pct1 + "</div><div class='pctBox " + stateColor2 + "' style='border:2px solid " + color2 + ";'>" + pct2 + "</div><div class='pctBox reporting'>" + precinctsReportingPct + "%</div><div class='searchTerms'>" + stateName + " " + candidate1 + " " + candidate2 +  "</div></div>";
    }

    if (race == "senate" || race == "governors"){
    return "<div class='tableRow' name='" + statePostal + "'><div class='stateBlockR'>" + statePostal + "</div><div class='pctBox " + stateColor1 + "' style='border:2px solid " + color1 + ";'>" + pct1 + "</div><div class='pctBox " + stateColor2 + "' style='border:2px solid " + color2 + ";'>" + pct2 + "</div><div class='pctBox reporting'>" + precinctsReportingPct + "%</div><div class='searchTerms'>" + stateName + " " + candidate1 + " " + candidate2 +  "</div></div>";
    }

    if (race == "mnhouse" || race == "mnsenate"){
    return "<div class='tableRow' name='" + label + "'><div class='stateBlockR'>" + label + "</div><div class='pctBox " + stateColor1 + "' style='border:2px solid " + color1 + ";'>" + pct1 + "</div><div class='pctBox " + stateColor2 + "' style='border:2px solid " + color2 + ";'>" + pct2 + "</div><div class='pctBox reporting'>" + precinctsReportingPct + "%</div><div class='searchTerms'>" + stateName + " " + candidate1 + " " + candidate2 +  "</div></div>";
    }

    if (race == "ushouse"){
    return "<div class='tableRow' name='Minnesota" + label + "'><div class='stateBlockR'>MN" + label + "</div><div class='pctBox " + stateColor1 + "' style='border:2px solid " + color1 + ";'>" + pct1 + "</div><div class='pctBox " + stateColor2 + "' style='border:2px solid " + color2 + ";'>" + pct2 + "</div><div class='pctBox reporting'>" + precinctsReportingPct + "%</div><div class='searchTerms'>" + stateName + " " + candidate1 + " " + candidate2 +  "</div></div>";
    }
  }

} //end fetchData

//UPDATE INFOBOXES
function spillInfo(data){
 $("#infobox").html(data);
} //end spillInfo

//CARTOGRAM DATA UPDATE
function electoralCarto(data){
    $('.cartoState').each(function(i, obj) {
        var color = fetchData($(this).attr("name"),$(this).attr("name"),"lean",data,"president");
        $(this).attr("fill", color);
    });
} //end electoralCarto

//US HOUSE CARTOGRAM
function houseCarto(data){
(function(){
    var margin = {top: 3, left: 10, bottom: 40, right: 10}
    , width = 800
    // , width = width - margin.left - margin.right
    , mapRatio = .5
    , height = 600;

    var projection = d3.geo.equirectangular()
              .scale(width/1.1)//this makes it larger or smaller for the space you have
              .translate([width / 4, height / 2.5])
              .center([-102, 40 ]); //move the map center to fit in the spsace

    var path = d3.geo.path()
          .projection(projection);

    var svg = d3.select("#cartoHouse svg")
          .attr("width", width)
          .attr("height", height);

    var g = svg.append("g").attr('transform',"translate(150,25)").attr('class','house-group-g');

    makeCartogram();

function makeCartogram() {
        d3.json("shapefiles/usdistricts_cartogram.json", function(error, us) {

            g.append("g").attr("id", "districts").selectAll("path")
            .data(topojson.feature(us, us.objects['cart113']).features)
            .enter().append("path")
                .attr("d", path)
                .attr("class","cd")
                .attr("fill", function(d){
                    var color = fetchData("District " + d.properties['d'],d.properties.State,"lean",data,"ushouse",null,"District " + d.properties['d']);
                    return color;
                })
                .attr('id',function(d){ return d.properties.State + '' + d.properties['d'] + "c"; })
                .attr('data-hash-key',function(d){ return d.properties.State + '-' + d.properties['d']; })
                .on("mousedown", function(d, i){
                    d3.selectAll(".cd").classed("active",false);
                    d3.select(this).classed("active",true);
                    $(".tableRow").removeClass("selectedBox");
                    if (d.properties.State == "Minnesota") { $(".tableRow[name=" + d.properties.State + "" + d.properties['d'] + "]").addClass("selectedBox"); }
                    spillInfo(fetchData("District " + d.properties['d'],d.properties.State,"table",data,"ushouse",null,"District " + d.properties['d']));
                })
                .call(d3.helper.tooltip(function(d, i){
                    if ($(window).width() > 960) { 
                    return fetchData("District " + d.properties['d'],d.properties.State,"tooltip",data,"ushouse",null,"District " + d.properties['d']);
                } else { $(".tooltip").hide(); }}));
        })
    }
})();

d3.helper = {};

d3.helper.tooltip = function(accessor){
    return function(selection){
        var tooltipDiv;
        var bodyNode = d3.select('body').node();
        selection.on("mouseover", function(d, i){
            // Clean up lost tooltips
            d3.select('body').selectAll('div.tooltip').remove();
            // Append tooltip
            tooltipDiv = d3.select('body').append('div').attr('class', 'tooltip');
            var absoluteMousePos = d3.mouse(bodyNode);
            tooltipDiv.style('left', (absoluteMousePos[0] - 160)+'px')
                .style('top', (absoluteMousePos[1] - 15)+'px')
                .style('position', 'absolute')
                .style('z-index', 1001);
            // Add text using the accessor function
            var tooltipText = accessor(d, i) || '';
            // Crop text arbitrarily
            //tooltipDiv.style('width', function(d, i){return (tooltipText.length > 80) ? '300px' : null;})
            //    .html(tooltipText);
        })
        .on('mousemove', function(d, i) {
            // Move tooltip
            var absoluteMousePos = d3.mouse(bodyNode);
            tooltipDiv.style('left', (absoluteMousePos[0] - 160)+'px')
                .style('top', (absoluteMousePos[1] - 15)+'px');
            var tooltipText = accessor(d, i) || '';
            tooltipDiv.html(tooltipText);
        })
        .on("mouseout", function(d, i){
            // Remove tooltip
            tooltipDiv.remove();
        });

    };
};

var aspect = 800 / 600, chart = $("#cartoHouse svg"); //, chart2 = $(".carto svg")
  var targetWidth = chart.parent().width();
  chart.attr("width", targetWidth);
  chart.attr("height", targetWidth / aspect);

$(window).on("resize", function() {
  var targetWidth = chart.parent().width();
  chart.attr("width", targetWidth);
  chart.attr("height", targetWidth / aspect);
});

} //end houseCarto

//ALL OTHER MAPS
function mapBuild(container, boxContainer, chartContainer, shape, race, geo, level, dataCompare, index, visible) {

if (geo=="us") { var width = 800, height = 600, centered; var projection = d3.geo.albersUsa().scale(1000).translate([400, 210]); }
else if (geo=="mn") { var width = 400, height = 400, centered; var projection = d3.geo.mercator().scale([3200]).center([-89.736328,46.377254]); }
else if (geo=="metro") { var width = 400, height = 400, centered; var projection = d3.geo.mercator().scale([16500]).center([-92.403259,44.988113]); }

var path = d3.geo.path()
    .projection(projection);

var svg = d3.select(container + " svg")
    .attr("width", width)
    .attr("height", height);

var g = svg.append("g").attr("class", "mappage states " + race + " " + level);

d3.json("shapefiles/" + shape, function(error, us) {

  g.selectAll("path")
      .data(us.features)
    .enter().append("path")
      .attr("d", path)
      .on("click", clicked)
      .attr("precinctName", function(d){ return d.properties.NAME })
      .style("fill", function(d){
         if (race == "president") { 
        $('#president .sideStates .block').each(function(i, obj) {
            if ($(this).hasClass(d.properties.STUSPS)){
            var color = fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race);
            $(this).css("background-color", color);
            }
        });
            return fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race); 
         }
         if (race == "senate") { 
        $('#senate .sideStates .block').each(function(i, obj) {
            if ($(this).hasClass(d.properties.STUSPS)){
            var color = fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race);
            $(this).css("background-color", color);
            }
        });
            return fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race); 
         }
         if (race == "governors") { 
        $('#governors .sideStates .block').each(function(i, obj) {
            if ($(this).hasClass(d.properties.STUSPS)){
            var color = fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race);
            $(this).css("background-color", color);
            }
        });
            return fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race); 
         }
         else if (race == "county") { return fetchData(d.properties.GEOID,null,"colors",dataCompare,race); }
         // else if (race == "pct") { return mapColor(d.properties.PCTCODE, race, dataCompare); }
         else if (race == "house") { return fetchData("District " + d.properties.DISTRICT,d.properties.STATENAME,"lean",dataCompare,"ushouse",null,"District " + d.properties.DISTRICT); $(".tableRow").removeClass("selectedBox"); if (d.properties.STATENAME == "Minnesota") { $(".tableRow[name=" + d.properties.STATENAME + "" + d.properties.DISTRICT + "]").addClass("selectedBox"); } }
         else if (race == "mnsenate" || race == "mnhouse") { return fetchData("District " + d.properties.DISTRICT,"Minnesota","lean",dataCompare,race,null,"District " + d.properties.DISTRICT); }
        })
       .on("mousedown", function(d, i){

        var str = d.properties.NAME; 
        $(".district").removeClass("selected");
        $(".tableRow").removeClass("selectedBox");
        $(".tableRow[name=" + d.properties.STUSPS + "]").addClass("selectedBox");
        $(".tableRow[name=" + d.properties.DISTRICT + "]").addClass("selectedBox");
        if (race == "president" || race == "senate" ||  race == "governors"){ 
            spillInfo(fetchData(d.properties.NAME,d.properties.NAME,"table",dataCompare,race)); $(".block").removeClass("blockSelect"); $("." + d.properties.STUSPS).addClass("blockSelect"); }
        else if (race == "county"){ spillInfo(fetchData(d.properties.GEOID,null,"table",dataCompare,race,null,d.properties.NAME)); }
        else if (race == "house"){ spillInfo(fetchData("District " + d.properties.DISTRICT,d.properties.STATENAME,"table",dataCompare,"ushouse",null,"District " + d.properties.DISTRICT)); if (d.properties.STATENAME == "Minnesota") { $(".tableRow[name=" + d.properties.STATENAME + "" + d.properties.DISTRICT + "]").addClass("selectedBox"); } } 
        else if (race == "mnsenate" || race == "mnhouse") { spillInfo(fetchData("District " + d.properties.DISTRICT,"Minnesota","table",dataCompare,race,null,"District " + d.properties.DISTRICT)); }

        // else if (race == "pct"){
        //               $("#candidatePCTR, #candidatePCTD").removeClass("d4");
        //               $("#candidatePCTR, #candidatePCTD").removeClass("d3");
        //               $("#candidatePCTR, #candidatePCTD").removeClass("d2");
        //               $("#candidatePCTR, #candidatePCTD").removeClass("d1");
        //               $("#candidatePCTR, #candidatePCTD").removeClass("r4");
        //               $("#candidatePCTR, #candidatePCTD").removeClass("r3");
        //               $("#candidatePCTR, #candidatePCTD").removeClass("r2");
        //               $("#candidatePCTR, #candidatePCTD").removeClass("r1");
        //               $("#pctReported").html(0);
        //               $("#pctAll").html(0);
        //               $("#pctPCT").html(0);

        //     for (var i=0; i < dataCompare.length; i++){
        //     if (Number(d.properties.PCTCODE) == Number(dataCompare[i].pct_id)){
        //       if (dataCompare[i].party_id == "R" && dataCompare[i].vote_pct >= 48) { 
        //         $("#candidatePCTR").html(dataCompare[i].vote_pct + "%");
        //         $("#candidateVotesR").html(0);
        //         // $("#candidatePCTR").css("background-color", mapColor(d.properties.PCTCODE, race, dataCompare));
        //       }
        //       if (dataCompare[i].party_id == "DFL" && dataCompare[i].vote_pct >= 48) { 
        //         $("#candidateVotesD").html(0);
        //         $("#candidatePCTD").html(dataCompare[i].vote_pct + "%");
        //         // $("#candidatePCTD").css("background-color", mapColor(d.properties.PCTCODE, race, dataCompare));
        //       }
        //     }
        //   }
        // }
       })
      .style("stroke-width", "0.3px")
      .style("stroke", "#fff")
      .attr("id",function(d){ 
        if (race == "president"){ return d.properties.STUSPS; }
        else if (race == "senate"){ return d.properties.STUSPS + "s"; }
        else if (race == "governors"){ return d.properties.STUSPS + "g"; }
        else if (race == "mnsenate"){ return "mns" + d.properties.DISTRICT; }
        else if (race == "mnhouse"){ return "mnh" + d.properties.DISTRICT; }
        else if (race == "house"){ return d.properties.STATENAME + "" + d.properties.DISTRICT; }
        else { return null; }
      })
      .attr("class",function(d){
          if (race == "president"){ return "district " + d.properties.STUSPS; }
          if (race == "senate"){ 
            if (d.properties.NAME == "Montana" || d.properties.NAME == "Wyoming" || d.properties.NAME == "Nebraska" || d.properties.NAME == "Minnesota" || d.properties.NAME == "New Mexico" || d.properties.NAME == "Texas" || d.properties.NAME == "Mississippi" || d.properties.NAME == "Tennessee" || d.properties.NAME == "West Virginia" || d.properties.NAME == "Virginia" || d.properties.NAME == "New Jersey" || d.properties.NAME == "Delaware" || d.properties.NAME == "Rhode Island" || d.properties.NAME == "Massachusetts" || d.properties.NAME == "Maine" || d.properties.NAME == "Michigan"){
                return "noclicky  district " + d.properties.STUSPS;
            }
          }
          if (race == "governors"){ 
            if (d.properties.NAME != "Washington" && d.properties.NAME != "Oregon" && d.properties.NAME != "Montana" && d.properties.NAME != "Utah" && d.properties.NAME != "Missouri" && d.properties.NAME != "Montana" && d.properties.NAME != "Montana" && d.properties.NAME != "Montana" && d.properties.NAME != "West Virginia" && d.properties.NAME != "North Carolina" && d.properties.NAME != "Delaware" && d.properties.NAME != "New Hampshire" && d.properties.NAME != "Vermont" && d.properties.NAME != "Indiana" && d.properties.NAME != "North Dakota"){
                return "noclicky district " + d.properties.STUSPS;
            }
          }
          if (race == "county"){ 
            if (d.properties.STATEFP == 27){
              if (d.properties.NAME == "Hennepin" || d.properties.NAME == "Ramsey" || d.properties.NAME == "Washington" || d.properties.NAME == "Carver" || d.properties.NAME == "Scott" || d.properties.NAME == "Dakota" || d.properties.NAME == "Anoka") { return "mn metro"; }
              else { return "mn"; }  
            } else if (d.properties.STATEFP == 2){
              return "noclicky district";
            }
            else { return "areas district"; }
          }
          if (race == "house"){ 
            if (d.properties.STATENAME == "Minnesota"){ return "mn"; }
            else { return "areas district"; }
          }
      })
      .call(d3.helper.tooltip(function(d, i){
        if ($(window).width() > 960) { 
         if (race == "president" || race == "senate" || race == "governors") { return fetchData(d.properties.NAME,d.properties.NAME,"tooltip",dataCompare,race); }
         else if (race == "county") { return fetchData(d.properties.GEOID,null,"tooltip",dataCompare,race,null,d.properties.NAME); }
         // else if (race == "pct") { return mapTips(d, race, dataCompare, level); }
         else if (race == "house") { return fetchData("District " + d.properties.DISTRICT,d.properties.STATENAME,"tooltip",dataCompare,"ushouse",null,"District " + d.properties.DISTRICT); }
         else if (race == "mnsenate" || race == "mnhouse") { return fetchData("District " + d.properties.DISTRICT,"Minnesota","tooltip",dataCompare,race,null,"District " + d.properties.DISTRICT); }
      } else { $(".tooltip").hide(); }}))

if (race == "president" || race == "senate" ||  race == "governors"){
    g.selectAll("text")
    .data(us.features)
    .enter()
    .append("text")
    .attr("fill", "white")
    .style("font-weight",900)
    .attr("class","passthrough")
    .attr("transform", function(d) { 
        var centroid = path.centroid(d);
        var x = centroid[0];
        var y = centroid[1];

        if (d.properties.STUSPS == "FL") { x = x + 11; }
        if (d.properties.STUSPS == "MI") { x = x + 9; y = y + 18; }
        if (d.properties.STUSPS == "AK") { y = y - 4; }
        if (d.properties.STUSPS == "LA") { x = x - 8; y = y - 4; }
        return "translate(" + x + "," + y + ")";
    })
    .attr("text-anchor", "middle")
    .attr("dy", ".35em")
    .text(function(d) {
        if (race == "president") { 
            if (d.properties.STUSPS != "MA" && d.properties.STUSPS != "RI" && d.properties.STUSPS != "CT" && d.properties.STUSPS != "DE" && d.properties.STUSPS != "DC" && d.properties.STUSPS != "MD" && d.properties.STUSPS != "NH" && d.properties.STUSPS != "VT" && d.properties.STUSPS != "NJ") { return d.properties.STUSPS; }
        }
        if (race == "senate") { 
            if (d.properties.STUSPS != "MA" && d.properties.STUSPS != "RI" && d.properties.STUSPS != "CT" && d.properties.STUSPS != "DE" && d.properties.STUSPS != "DC" && d.properties.STUSPS != "MD" && d.properties.STUSPS != "NH" && d.properties.STUSPS != "VT" && d.properties.STUSPS != "NJ" && d.properties.STUSPS != "MT" && d.properties.STUSPS != "WY" && d.properties.STUSPS != "NE" && d.properties.STUSPS != "NM" && d.properties.STUSPS != "TX" && d.properties.STUSPS != "MN" && d.properties.STUSPS != "MI" && d.properties.STUSPS != "MS" && d.properties.STUSPS != "TN" && d.properties.STUSPS != "WV" && d.properties.STUSPS != "VA" && d.properties.STUSPS != "ME") { return d.properties.STUSPS; }
        }
        if (race == "governors") { 
            if (d.properties.STUSPS != "OH" && d.properties.STUSPS != "MI" && d.properties.STUSPS != "AZ" && d.properties.STUSPS != "ME" && d.properties.STUSPS != "NY" && d.properties.STUSPS != "PA" && d.properties.STUSPS != "VA" && d.properties.STUSPS != "FL" && d.properties.STUSPS != "SC" && d.properties.STUSPS != "GA" && d.properties.STUSPS != "MS" && d.properties.STUSPS != "AL" && d.properties.STUSPS != "KY" && d.properties.STUSPS != "TN" && d.properties.STUSPS != "WI" && d.properties.STUSPS != "IL" && d.properties.STUSPS != "AR" && d.properties.STUSPS != "LA" && d.properties.STUSPS != "MN" && d.properties.STUSPS != "IA" && d.properties.STUSPS != "TX" && d.properties.STUSPS != "KS" && d.properties.STUSPS != "OK" && d.properties.STUSPS != "SD" && d.properties.STUSPS != "NE" && d.properties.STUSPS != "NM" && d.properties.STUSPS != "CO" && d.properties.STUSPS != "ID" && d.properties.STUSPS != "WY" && d.properties.STUSPS != "CA" && d.properties.STUSPS != "NV" && d.properties.STUSPS != "AK" && d.properties.STUSPS != "HI" && d.properties.STUSPS != "MA" && d.properties.STUSPS != "RI" && d.properties.STUSPS != "CT" && d.properties.STUSPS != "DE" && d.properties.STUSPS != "DC" && d.properties.STUSPS != "MD" && d.properties.STUSPS != "NH" && d.properties.STUSPS != "VT" && d.properties.STUSPS != "NJ") { return d.properties.STUSPS; }
        }
    });
}

  g.append("path")
      //.datum(topojson.mesh(us, us.features, function(a, b) { return a !== b; }))
      .attr("class", "state-borders")
      .attr("d", path);

});

var zoom = d3.behavior.zoom()
    .on("zoom",function() {
        g.attr("transform","translate("+
            d3.event.translate.join(",")+")scale("+d3.event.scale+")");
        g.selectAll("circle")
            .attr("d", path.projection(projection));
        g.selectAll("path")
            .attr("d", path.projection(projection));

  });

$(".zoom").click(function() {
  g.selectAll("." + race + " path")
      .classed("faded", false)
      .classed("active", false);
});

$(".uszoom").click(function() {
    clicked2();
    d3.selectAll(".areas").classed("gone", false);
    d3.selectAll(".mn").classed("gone", false);
    d3.selectAll(".metro").classed("gone", false);
});

$(".mnzoom").click(function() {
    mnzoom();
    d3.selectAll(".areas").classed("gone", true);
    d3.selectAll(".mn").classed("gone", false);
});

$(".metrozoom").click(function() {
    metrozoom();
    d3.selectAll(".areas").classed("gone", true);
    d3.selectAll(".mn").classed("gone", true);
    d3.selectAll(".metro").classed("gone", false);
});

function clicked(d) {
  var x, y, k;

  if (d && centered !== d) {
    var centroid = path.centroid(d);
    x = centroid[0];
    y = centroid[1];
    k = 3;
    centered = d;
  } else {
    x = width / 2;
    y = height / 2;
    k = 3;
    centered = null;
  }

  g.selectAll("." + race + " path")
      .classed("faded", true)
      .classed("active", centered && function(d) { return d === centered; });

  // g.transition()
  //     .duration(200)
  //     .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")scale(" + k + ")translate(" + -x + "," + -y + ")")
      // .style("stroke-width", 1.5 / k + "px");

  // g.selectAll("path").style("stroke-width", "0.3px");
}

function mnzoom(d) {
  var x, y, k;

    var centroid = path.centroid(d);
    x = 429.8542649319006;
    y = 90.27472769218944;
    k = 5;

  g.transition()
      .duration(200)
      .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")scale(" + k + ")translate(" + -x + "," + -y + ")")
      .style("stroke-width", "0");

  g.selectAll("path").style("stroke-width", "0.3px");
}

function metrozoom(d) {
  var x, y, k;

    var centroid = path.centroid(d);
    x = 439.8542649319006;
    y = 103.27472769218944;
    k = 25;

  g.transition()
      .duration(200)
      .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")scale(" + k + ")translate(" + -x + "," + -y + ")")
      .style("stroke-width", "0");

  g.selectAll("path").style("stroke-width", "0.1px");
}

function clicked2(d) {
  var x, y, k;

  if (d && centered !== d) {
    var centroid = path.centroid(d);
    x = centroid[0];
    y = centroid[1];
    k = 1;
    centered = d;
  } else {
    x = width / 2;
    y = height / 2;
    k = 1;
    centered = null;
  }

  g.selectAll("." + race + " path")
      .classed("faded", false)
      .classed("active", centered && function(d) { return d === centered; });

  g.transition()
      .duration(200)
      .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")scale(" + k + ")translate(" + -x + "," + -y + ")")
      .style("stroke-width","0.5px");

  g.selectAll("path").style("stroke-width", ".5px");
}

d3.helper = {};

d3.helper.tooltip = function(accessor){
    return function(selection){
        var tooltipDiv;
        var bodyNode = d3.select('body').node();
        selection.on("mouseover", function(d, i){
            // Clean up lost tooltips
            d3.select('body').selectAll('div.tooltip').remove();
            // Append tooltip
            tooltipDiv = d3.select('body').append('div').attr('class', 'tooltip');
            var absoluteMousePos = d3.mouse(bodyNode);
            tooltipDiv.style('left', (absoluteMousePos[0] - 160)+'px')
                .style('top', (absoluteMousePos[1] - 15)+'px')
                .style('position', 'absolute')
                .style('z-index', 1001);
            // Add text using the accessor function
            var tooltipText = accessor(d, i) || '';
            // Crop text arbitrarily
            //tooltipDiv.style('width', function(d, i){return (tooltipText.length > 80) ? '300px' : null;})
            //    .html(tooltipText);
        })
        .on('mousemove', function(d, i) {
            // Move tooltip
            var absoluteMousePos = d3.mouse(bodyNode);
            tooltipDiv.style('left', (absoluteMousePos[0] - 160)+'px')
                .style('top', (absoluteMousePos[1] - 15)+'px');
            var tooltipText = accessor(d, i) || '';
            tooltipDiv.html(tooltipText);
        })
        .on("mouseout", function(d, i){
            // Remove tooltip
            tooltipDiv.remove();
        });

    };
};

var aspect = 800 / 600, chart = $(container + " svg"); //, chart2 = $(".carto svg")
$(document).ready(function() {
  var targetWidth = chart.parent().width();
  chart.attr("width", targetWidth);
  chart.attr("height", targetWidth / aspect);
});
$(window).on("resize", function() {
  var targetWidth = chart.parent().width();
  chart.attr("width", targetWidth);
  chart.attr("height", targetWidth / aspect);
});

} //end mapBuild


//show/hide parameters
$.urlParam = function(name){
  var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
  return results[1] || 0;
}

var race = $.urlParam('race');
$(".raceSwitch, li").removeClass("selected2");
$(".raceSwitch[section=" + race + "]").addClass("selected2");
$("li[section=" + race + "]").addClass("selected2");

var currentrace = race;

function mapShow(container, race){
 d3.selectAll(".mappage").each(function(i){
  if (!d3.select(this).classed(race)) { d3.select(this).style("display","none"); }
  else { d3.select(this).style("display","block"); }
 });
} //end mapShow

function mapSpill(race,data){

  if (race == "president"){
    mapBuild("#president .geo", "#districtName", "#chart", "us_states.json", race, "us", "country", data);
    if ($(window).width() > 960) { mapBuild("#president .geo", "#districtName", "#chart", "us_counties.json", "county", "us", "counties", data); }
    electoralCarto(data);
    // mapBuild("#mapStates", "#districtName", "#chart", "us_states.json", race, "us", "country", data);
    // mapBuild("#mapCounties", "#districtName", "#chart", "us_counties.json", "county", "us", "counties", data);
  }  

  if (race == "house"){
    mapBuild("#house .geo", "#districtName", "#chart", "uscongress.json", race, "us", "country", data);
    // mapBuild("#mapMN", "#districtName", "#chart", "us_cd_mn_2012.json", race, "mn", "country", data);
    houseCarto(data);
  }  

  if (race == "senate"){
    mapBuild("#senate .geo", "#districtName", "#chart", "us_states.json", race, "us", "country", data);
  }  

  if (race == "governors"){
    mapBuild("#governors .geo", "#districtName", "#chart", "us_states.json", race, "us", "country", data);
  }  

  if (race == "mnhouse"){
    mapBuild("#mnhouse .mapState", "#districtName", "#chart", "mnleg.json", race, "mn", "country", data);
    mapBuild("#mnhouse .mapMetro", "#districtName", "#chart", "mnleg_metro.json", race, "metro", "country", data);
    // cartoBuild("#mnhouse .cartoState", "#districtName", "#chart", null, race, data, "us", 0, cartoData(race,"mn"));
    // cartoBuild("#mnhouse .cartoMetro", "#districtName", "#chart", null, race, data, "us", 0, cartoData(race,"metro"));
  }  

  if (race == "mnsenate"){
    mapBuild("#mnsenate .mapState", "#districtName", "#chart", "mnsenate.json", race, "mn", "country", data);
    mapBuild("#mnsenate .mapMetro", "#districtName", "#chart", "mnsenate_metro.json", race, "metro", "country", data);
    // cartoBuild("#mnsenate .cartoState", "#districtName", "#chart", null, race, data, "us", 0, cartoData(race,"mn"));
    // cartoBuild("#mnsenate .cartoMetro", "#districtName", "#chart", null, race, data, "us", 0, cartoData(race,"metro"));
  }

} //end mapSpill

//RETRIEVE NEW DATA FOR THE TABLES AND POWER BALANCE
function prezCrunch(data,dataEV){

  $("#allResults .president").html("");

  var stateList = ["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","District of Columbia","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"];

  var evList = [9,3,11,6,55,9,7,3,3,29,16,4,4,20,11,6,6,8,8,2,10,11,16,10,6,10,3,2,6,4,14,5,29,15,3,18,7,7,20,4,9,3,11,38,6,3,13,12,5,10,3];

  var dTally = 0;
  var rTally = 0;
  var iTally = 0;

  for (var i=0; i < 51; i++){
    var updated = fetchData(null,stateList[i],"winner",data,"president",null,null,null);
    if (updated == "GOP Win") { rTally += evList[i]; }
    else if (updated == "DEM Win") { dTally += evList[i]; }
    else if (updated == "IND Win") { iTally += evList[i]; }
    $("#allResults .president").append(fetchData(null,stateList[i],"board",data,"president",evList[i],null));
  }

  var me1 = fetchData(null,"ME","lean",dataEV,"president",null,null,"District 1");
  var me2 = fetchData(null,"ME","lean",dataEV,"president",null,null,"District 2");
  var ne1 = fetchData(null,"NE","lean",dataEV,"president",null,null,"District 1");
  var ne2 = fetchData(null,"NE","lean",dataEV,"president",null,null,"District 2");
  var ne3 = fetchData(null,"NE","lean",dataEV,"president",null,null,"District 3");

  $(".ME01").css("background-color",me1);
  $(".ME02").css("background-color",me2);
  $(".NE01").css("background-color",ne1);
  $(".NE02").css("background-color",ne2);
  $(".NE03").css("background-color",ne3);
  $("#ME01").css("fill",me1);
  $("#ME02").css("fill",me2);
  $("#NE01").css("fill",ne1);
  $("#NE02").css("fill",ne2);
  $("#NE03").css("fill",ne3);

  $("#allResults .president").append(fetchData(null,"ME","board",dataEV,"president",1,"ME01","District 1"));
  $("#allResults .president").append(fetchData(null,"ME","board",dataEV,"president",1,"ME02","District 2"));
  $("#allResults .president").append(fetchData(null,"NE","board",dataEV,"president",1,"NE01","District 1"));
  $("#allResults .president").append(fetchData(null,"NE","board",dataEV,"president",1,"NE02","District 2"));
  $("#allResults .president").append(fetchData(null,"NE","board",dataEV,"president",1,"NE03","District 3"));

  var me1W = fetchData(null,"ME","winner",dataEV,"president",null,null,"District 1");
  var me2W = fetchData(null,"ME","winner",dataEV,"president",null,null,"District 2");
  var ne1W = fetchData(null,"NE","winner",dataEV,"president",null,null,"District 1");
  var ne2W = fetchData(null,"NE","winner",dataEV,"president",null,null,"District 2");
  var ne3W = fetchData(null,"NE","winner",dataEV,"president",null,null,"District 3");

  if (me1W == "GOP Win") { rTally++; }
  else if (me1W == "DEM Win") { dTally++; }
  if (me2W == "GOP Win") { rTally++; }
  else if (me2W == "DEM Win") { dTally++; }
  if (ne1W == "GOP Win") { rTally++; }
  else if (ne1W == "DEM Win") { dTally++; }
  if (ne2W == "GOP Win") { rTally++; }
  else if (ne2W == "DEM Win") { dTally++; }
  if (ne3W == "GOP Win") { rTally++; }
  else if (ne3W == "DEM Win") { dTally++; }

  // var votesR = fetchData(null,"United States","votesR",data,"data",null,null);
  // var votesD = fetchData(null,"United States","votesD",data,"data",null,null);
  // var votesT = fetchData(null,"United States","votesT",data,"data",null,null);

  var winner = fetchData(null,"United States","winner",data,"president",null,null);

  if (winner == "GOP Win") { $("#rMark").html("&#x2714;"); }
  else if (winner == "DEM Win") { $("#dMark").html("&#x2714;"); }

  $(".demsCount").html(dTally);
  $(".gopCount").html(rTally);
  // $(".dcount").html(d3.format(",")(votesD));
  // $(".rcount").html(d3.format(",")(votesR));
  // $(".demPCT").html(d3.format("%")(votesD/votesT));
  // $(".gopPCT").html(d3.format("%")(votesR/votesT)); 
  $("#dWin").css("width", d3.format("%")(dTally/538));
  $("#rWin").css("width", d3.format("%")(rTally/538));
  $("#iWin").css("width", d3.format("%")(iTally/538));

  $('.filter_box').keyup(function(i){
     $('#allResults .president .tableRow').hide();
     $("#allResults .president .tableRow").removeClass("selectedBox");
     var txt = String($('.filter_box').val());
     $('#allResults .president .tableRow').each(function(){
        if($(this).text().toUpperCase().indexOf(txt.toUpperCase()) != -1){
            $(this).show();
        }
     });
  });

  $(".president .tableRow").click(function() {
    $(".tableRow").removeClass("selectedBox");
    $(this).addClass("selectedBox");
    var findDistrict = $(this).attr("name");
    $(".cartoState").removeClass("selectedBox");
    $("#cartogram #" + $(this).attr("name")).addClass("selectedBox");
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
  });

} //end prezCrunch

function senCrunch(data){

  $("#allResults .senate").html("");
  $("#rMark, #dMark").html("");

  var stateList = ["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maryland","Missouri","Nevada","New Hampshire","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","South Carolina","South Dakota","Utah","Vermont","Washington","Wisconsin"];

  var dTally = 36;
  var rTally = 30;
  var iTally = 0;

  for (var i=0; i < stateList.length; i++){
    var updated = fetchData(null,stateList[i],"winner",data,"senate",null,null);
    if (updated == "GOP Win") { rTally++; }
    else if (updated == "DEM Win") { dTally++; }
    else if (updated == "IND Win") { iTally++; }

    $("#allResults .senate").append(fetchData(null,stateList[i],"board",data,"senate",null,null));
  }

  $(".demsCount").html(dTally);
  $(".gopCount").html(rTally);
  $("#dWin").css("width", d3.format("%")(dTally/100));
  $("#rWin").css("width", d3.format("%")(rTally/100));
  $("#iWin").css("width", d3.format("%")(iTally/100));

  $('.filter_box').keyup(function(i){
     $('#allResults .senate .tableRow').hide();
     $("#allResults .senate .tableRow").removeClass("selectedBox");
     var txt = String($('.filter_box').val());
     $('#allResults .senate .tableRow').each(function(){
        if($(this).text().toUpperCase().indexOf(txt.toUpperCase()) != -1){
            $(this).show();
        }
     });
  });

  $(".senate .tableRow").click(function() {
     d3.selectAll("path").classed("faded", false).classed("active", false); 
     $(".tableRow").removeClass("selectedBox");
     $(this).addClass("selectedBox");
     var findDistrict = $(this).attr("name") + "s";
     $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
     $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
     $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
  });

} //end senCrunch

function govCrunch(data){

  $("#allResults .governors").html("");
  $("#rMark, #dMark").html("");

  var stateList = ["Delaware","Indiana","Missouri","Montana","New Hampshire","North Carolina","North Dakota","Oregon","Utah","Vermont","Washington","West Virginia"];

  var dTally = 10;
  var rTally = 27;
  var iTally = 1;

  for (var i=0; i < stateList.length; i++){
    var updated = fetchData(null,stateList[i],"winner",data,"governors",null,null);
    if (updated == "GOP Win") { rTally++; }
    else if (updated == "DEM Win") { dTally++; }
    else if (updated == "IND Win") { iTally++; }

    $("#allResults .governors").append(fetchData(null,stateList[i],"board",data,"governors",null,null));
  }

  $(".demsCount").html(dTally);
  $(".gopCount").html(rTally);
  $("#dWin").css("width", d3.format("%")(dTally/50));
  $("#rWin").css("width", d3.format("%")(rTally/50));
  $("#iWin").css("width", d3.format("%")(iTally/50));

  $('.filter_box').keyup(function(i){
     $('#allResults .governors .tableRow').hide();
     $("#allResults .governors .tableRow").removeClass("selectedBox");
     var txt = String($('.filter_box').val());
     $('#allResults .governors .tableRow').each(function(){
        if($(this).text().toUpperCase().indexOf(txt.toUpperCase()) != -1){
            $(this).show();
        }
     });
  });

  $(".governors .tableRow").click(function() {
    d3.selectAll("path").classed("faded", false).classed("active", false);  
    $(".tableRow").removeClass("selectedBox");
    $(this).addClass("selectedBox");
    var findDistrict = $(this).attr("name") + "g";
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
  });

} //end govCrunch

function houseCrunch(data){

  $("#allResults .house").html("");
  $("#rMark, #dMark").html("");

  var stateList = ["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"];
  var districtList = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53];

  var dTally = 0;
  var rTally = 0;
  var iTally = 0;

  for (var i=0; i < districtList.length; i++){
    for (var k=0; k < stateList.length; k++){
    var updated = fetchData("District " + districtList[i],stateList[k],"winner",data,"ushouse",null,"District " + districtList[i]);
    if (updated == "GOP Win") { rTally++; }
    else if (updated == "DEM Win") { dTally++; }
    else if (updated == "IND Win") { iTally++; }
    }

  }

  $("#allResults .house").append(fetchData("District 1","Minnesota","board",data,"ushouse",null,"1"));
  $("#allResults .house").append(fetchData("District 2","Minnesota","board",data,"ushouse",null,"2"));
  $("#allResults .house").append(fetchData("District 3","Minnesota","board",data,"ushouse",null,"3"));
  $("#allResults .house").append(fetchData("District 4","Minnesota","board",data,"ushouse",null,"4"));
  $("#allResults .house").append(fetchData("District 5","Minnesota","board",data,"ushouse",null,"5"));
  $("#allResults .house").append(fetchData("District 6","Minnesota","board",data,"ushouse",null,"6"));
  $("#allResults .house").append(fetchData("District 7","Minnesota","board",data,"ushouse",null,"7"));
  $("#allResults .house").append(fetchData("District 8","Minnesota","board",data,"ushouse",null,"8"));

  $(".demsCount").html(dTally);
  $(".gopCount").html(rTally);
  $("#dWin").css("width", d3.format("%")(dTally/435));
  $("#rWin").css("width", d3.format("%")(rTally/435));
  $("#iWin").css("width", d3.format("%")(iTally/435));

  $('.filter_box').keyup(function(i){
     $('#allResults .house .tableRow').hide();
     $("#allResults .house .tableRow").removeClass("selectedBox");
     var txt = String($('.filter_box').val());
     $('#allResults .house .tableRow').each(function(){
        if($(this).text().toUpperCase().indexOf(txt.toUpperCase()) != -1){
            $(this).show();
        }
     });
  });

  $(".house .tableRow").click(function() {
    d3.selectAll("path").classed("faded", false).classed("active", false);  
    $(".tableRow").removeClass("selectedBox");
    $(this).addClass("selectedBox");  

      var findDistrict = $(this).attr("name");
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();  

      var findDistrict2 = $(this).attr("name") + "c";
    $("[id='" + findDistrict2.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
    $("[id='" + findDistrict2.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
    $("[id='" + findDistrict2.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
  });

} //end houseCrunch

function mnhouseCrunch(data){

  $("#allResults .mnhouse").html("");
  $("#rMark, #dMark").html("");

  var districtList = ["1A","1B","2A","2B","3A","3B","4A","4B","5A","5B","6A","6B","7A","7B","8A","8B","9A","9B","10A","10B","11A","11B","12A","12B","13A","13B","14A","14B","15A","15B","16A","16B","17A","17B","18A","18B","19A","19B","20A","20B","21A","21B","22A","22B","23A","23B","24A","24B","25A","25B","26A","26B","27A","27B","28A","28B","29A","29B","30A","30B","31A","31B","32A","32B","33A","33B","34A","34B","35A","35B","36A","36B","37A","37B","38A","38B","39A","39B","40A","40B","41A","41B","42A","42B","43A","43B","44A","44B","45A","45B","46A","46B","47A","47B","48A","48B","49A","49B","50A","50B","51A","51B","52A","52B","53A","53B","54A","54B","55A","55B","56A","56B","57A","57B","58A","58B","59A","59B","60A","60B","61A","61B","62A","62B","63A","63B","64A","64B","65A","65B","66A","66B","67A","67B"];

  var dTally = 0;
  var rTally = 0;
  var iTally = 0;

  for (var i=0; i < districtList.length; i++){
    var updated = fetchData("District " + districtList[i],"Minnesota","winner",data,"mnhouse",null,"District " + districtList[i]);
    if (updated == "GOP Win") { rTally++; }
    else if (updated == "DEM Win") { dTally++; }
    else if (updated == "IND Win") { iTally++; }
    $("#allResults .mnhouse").append(fetchData("District " + districtList[i],"Minnesota","board",data,"mnhouse",null,districtList[i]));
  }

  $(".demsCount").html(dTally);
  $(".gopCount").html(rTally);
  $("#dWin").css("width", d3.format("%")(dTally/134));
  $("#rWin").css("width", d3.format("%")(rTally/134));
  $("#iWin").css("width", d3.format("%")(iTally/134));

  $('.filter_box').keyup(function(i){
     $('#allResults .mnhouse .tableRow').hide();
     $("#allResults .mnhouse .tableRow").removeClass("selectedBox");
     var txt = String($('.filter_box').val());
     $('#allResults .mnhouse .tableRow').each(function(){
        if($(this).text().toUpperCase().indexOf(txt.toUpperCase()) != -1){
            $(this).show();
        }
     });
  });

  $(".mnhouse .tableRow").click(function() {
      d3.selectAll("path").classed("faded", false).classed("active", false);
      $(".tableRow").removeClass("selectedBox");
      $(this).addClass("selectedBox");
      var findDistrict = "mnh" + $(this).attr("name");
      $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
      $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
      $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
  });

} //end mnhouseCrunch

function mnsenCrunch(data){

  $("#allResults .mnsenate").html("");
  $("#rMark, #dMark").html("");

  var districtList = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67];

  var dTally = 0;
  var rTally = 0;
  var iTally = 0;

  for (var i=0; i < districtList.length; i++){
    var updated = fetchData("District " + districtList[i],"Minnesota","winner",data,"mnsenate",null,"District " + districtList[i]);
    if (updated == "GOP Win") { rTally++; }
    else if (updated == "DEM Win") { dTally++; }
    else if (updated == "IND Win") { iTally++; }
    $("#allResults .mnsenate").append(fetchData("District " + districtList[i],"Minnesota","board",data,"mnsenate",null,districtList[i]));
  }

  $(".demsCount").html(dTally);
  $(".gopCount").html(rTally);
  $("#dWin").css("width", d3.format("%")(dTally/67));
  $("#rWin").css("width", d3.format("%")(rTally/67));
  $("#iWin").css("width", d3.format("%")(iTally/67));

  $('.filter_box').keyup(function(i){
     $('.tableRow').hide();
     $(".tableRow").removeClass("selectedBox");
     var txt = String($('.filter_box').val());
     $('.tableRow').each(function(){
        if($(this).text().toUpperCase().indexOf(txt.toUpperCase()) != -1){
            $(this).show();
        }
     });
  });

  $(".mnsenate .tableRow").click(function() {
      d3.selectAll("path").classed("faded", false).classed("active", false);
      $(".tableRow").removeClass("selectedBox");
      $(this).addClass("selectedBox");
      var findDistrict = "mns" + $(this).attr("name");
      $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
      $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
      $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
  });

} //end mnsenCrunch

function toggleyBits(data1,data2,data3,data4,data5,data6,data7,reload){
  var loadState = 0;

function loadBars(race){
  if (race == "president") { prezCrunch(data1,data7); } 
  if (race == "senate") { senCrunch(data2); } 
  if (race == "governors") { govCrunch(data3); } 
  if (race == "mnsenate") { mnsenCrunch(data4); } 
  if (race == "mnhouse") { mnhouseCrunch(data5); } 
  if (race == "house") { houseCrunch(data6); } 
}

loadBars(currentrace);

//MAKE THOSE PESKY EVCDS WORK
function evcdToggles(){
$(".ME01, #ME01").hover(function(event) {
    event.stopPropagation();
 spillInfo(fetchData(null,"ME","table",data7,"president",null,"District 1","District 1"));
 $(".block").removeClass("blockSelect");
 $(".ME01.evcd").addClass("blockSelect");
 $("#evcdME01").addClass("selectedBox");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$("#evcdME01").click(function(event) {
    event.stopPropagation();
 spillInfo(fetchData(null,"ME","table",data7,"president",null,"District 1","District 1"));
 $(".block").removeClass("blockSelect");
 $(".ME01.evcd").addClass("blockSelect");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$(".ME02, #ME02").hover(function(event) {
    event.stopPropagation();
 spillInfo(fetchData(null,"ME","table",data7,"president",null,"District 2","District 2"));
 $(".block").removeClass("blockSelect");
 $(".ME02.evcd").addClass("blockSelect");
 $("#evcdME02").addClass("selectedBox");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$("#evcdME02").click(function(event) {
    event.stopPropagation();
 spillInfo(fetchData(null,"ME","table",data7,"president",null,"District 2","District 2"));
 $(".block").removeClass("blockSelect");
 $(".ME02.evcd").addClass("blockSelect");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$(".NE01, #NE01").hover(function(event) {
    event.stopPropagation();
 spillInfo(fetchData(null,"NE","table",data7,"president",null,"District 1","District 1"));
 $(".block").removeClass("blockSelect");
 $(".NE01.evcd").addClass("blockSelect");
 $("#evcdNE01").addClass("selectedBox");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$("#evcdNE01").click(function(event) {
    event.stopPropagation();
 spillInfo(fetchData(null,"NE","table",data7,"president",null,"District 1","District 1"));
 $(".block").removeClass("blockSelect");
 $(".NE01.evcd").addClass("blockSelect");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$(".NE02, #NE02").hover(function(event) {
    event.stopPropagation();
 spillInfo(fetchData(null,"NE","table",data7,"president",null,"District 2","District 2"));
 $(".block").removeClass("blockSelect");
 $(".NE02.evcd").addClass("blockSelect");
 $("#evcdNE02").addClass("selectedBox");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$("#evcdNE02").click(function(event) {
    event.stopPropagation();
 spillInfo(fetchData(null,"NE","table",data7,"president",null,"District 2","District 2"));
 $(".block").removeClass("blockSelect");
 $(".NE02.evcd").addClass("blockSelect");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$(".NE03, #NE03").hover(function(event) {
    event.stopPropagation();
 spillInfo(fetchData(null,"NE","table",data7,"president",null,"District 3","District 3"));
 $(".block").removeClass("blockSelect");
 $(".NE03.evcd").addClass("blockSelect");
 $("#evcdNE03").addClass("selectedBox");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$("#evcdNE03").click(function(event) {
    event.stopPropagation();
 spillInfo(fetchData(null,"NE","table",data7,"president",null,"District 3","District 3"));
 $(".block").removeClass("blockSelect");
 $(".NE03.evcd").addClass("blockSelect");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});
}

  evcdToggles();

$(".cartoState").click(function(event) {
    event.stopPropagation();
 spillInfo(fetchData($(this).attr("name"),$(this).attr("name"),"table",data1,"president"));
});

$(".cartoState rect").hover(function(event) {
    event.stopPropagation();
$(".cartoState, .tableRow").removeClass("selectedBox");
$(".tableRow[name=" + $(this).parent().attr("id") + "]").addClass("selectedBox");
 spillInfo(fetchData($(this).parent().attr("name"),$(this).parent().attr("name"),"table",data1,"president"));
});

$(".cartoState").mouseleave(function(event) {
    event.stopPropagation();
  $(".cartoState").removeClass("blockSelect");
  $(".cartoState, .tableRow").removeClass("selectedBox");
  if (thisView == "mn") { spillInfo(fetchData("Minnesota","Minnesota","table",data1,"president")); }
  else if (thisView == "us") { spillInfo(fetchData("United States","United States","table",data1,"president")); }
  else if (thisView == "cd") { spillInfo(fetchData("District 2","Minnesota","table",data6,"ushouse",null,"District 2")); }
  else { $("#infobox").html(""); }
});

$(".block").mouseleave(function(event) {
    event.stopPropagation();
  $(".block").removeClass("blockSelect");
  $(".tableRow").removeClass("selectedBox");
  if (thisView == "mn") { spillInfo(fetchData("Minnesota","Minnesota","table",data1,"president")); }
  else if (thisView == "us") { spillInfo(fetchData("United States","United States","table",data1,"president")); }
  else if (thisView == "cd") { spillInfo(fetchData("District 2","Minnesota","table",data6,"ushouse",null,"District 2")); }
  else { $("#infobox").html(""); }
    d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

//RESET ALL THE VIEWS
$(".zoom").click(function(event) {
    event.stopPropagation();
  $(".block").removeClass("blockSelect");
  $(".tableRow").removeClass("selectedBox");
  $(".cartoState").removeClass("selectedBox");
  d3.selectAll(".cd").classed("active",false);
  $(".tableRow").show();
  $(".filter_box").val("");
  if (thisView == "mn") { spillInfo(fetchData("Minnesota","Minnesota","table",data1,"president")); }
  else if (thisView == "us") { spillInfo(fetchData("United States","United States","table",data1,"president")); }
  else if (thisView == "cd") { spillInfo(fetchData("District 2","Minnesota","table",data6,"ushouse",null,"District 2")); }
  else { $("#infobox").html(""); }
});

//carto clickies
$(".stateBlock").click(function(event) {
    event.stopPropagation();
$(".block").removeClass("blockSelect");
$(this).addClass("blockSelect");
    var findDistrict = $(this).attr("ab");
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
});

$(".stateBlock").hover(function(event) {
    event.stopPropagation();
    var findDistrict = $(this).attr("ab");
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
}, function(){
      // unhover code 
   });

//TRIGGER CHANGES WHEN SELECTING MENU ITEMS
$(".has-sub").click(function(event) {
    event.stopPropagation();
  $(".raceSwitch, li").removeClass("selected2");
});

$(".raceSwitch").click(function(event) {
    event.stopPropagation();
  //infobox switches
  thisView = $(this).attr("infobox");

  if (thisView == "mn") { spillInfo(fetchData("Minnesota","Minnesota","table",data1,"president")); }
  else if (thisView == "us") { spillInfo(fetchData("United States","United States","table",data1,"president")); }
  else if (thisView == "cd") { spillInfo(fetchData("District 2","Minnesota","table",data6,"ushouse",null,"District 2")); }
  else { $("#infobox").html(""); }

  //load power bars
  loadBars($(this).attr("data"));

  //button thingies
  $(".raceSwitch, li").removeClass("selected2");
  $(".cartoState").removeClass("selectedBox");
  $(this).addClass("selected2");
  $(".raceSwitch").find("a").removeClass("selected3");
  $(this).find("a").addClass("selected3");

  //show correct race
  $(".dataviz, .bigBoard").hide();
  $("#" + $(this).attr("data")).show();
  $("." + $(this).attr("data")).show();
  currentrace = $(this).attr("data");

  //show correct legend
  $(".legendBlock").hide();
  $("#" + $(this).attr("legend")).show();
  $(".dparty").html($(this).attr("dLabel"));
  $(".rparty").html($(this).attr("rLabel"));
  if ($(this).attr("stateKey") == "showMe") { $(".sideStates").show(); }
  else { $(".sideStates").hide(); }
  
  //show map or carto
  $(".map").hide();
  $("." + $(this).attr("type")).show();
  $("." + $(this).attr("type")).css('display','inline-block');

  //show correct layer
  loadState++;
  mapShow(".map",$(this).attr("layer"));

  evcdToggles();

}); //end menu triggers

} //end togglyBits


//INITIAL DATAMANCY TO CONJURE RESULTS FROM THE ASSOCIATED PRESS
var apiStringPrez = "https://s3-us-west-2.amazonaws.com/strib-elections-ap-api/us-uspresident-by-county/full.json";
var apiStringSen = "https://s3-us-west-2.amazonaws.com/strib-elections-ap-api/us-ussenate-by-state/full.json";
var apiStringGov = "https://s3-us-west-2.amazonaws.com/strib-elections-ap-api/us-governors-by-state/full.json";
var apiStringMNS = "https://s3-us-west-2.amazonaws.com/strib-elections-ap-api/mn-mnsenate-by-district/full.json";
var apiStringMNH = "https://s3-us-west-2.amazonaws.com/strib-elections-ap-api/mn-mnhouse-by-district/full.json";
var apiStringHouse = "https://s3-us-west-2.amazonaws.com/strib-elections-ap-api/us-ushouse-by-state/full.json";
var apiStringEVCD = "https://s3-us-west-2.amazonaws.com/strib-elections-ap-api/us-uspresident-nebraska-maine/full.json";

d3.json(apiStringPrez + '?' + (Math.floor(Math.random() * 1000)), function(error1, jsonSpillPrez) {
d3.json(apiStringSen + '?' + (Math.floor(Math.random() * 1000)), function(error2, jsonSpillSen) {
d3.json(apiStringGov + '?' + (Math.floor(Math.random() * 1000)), function(error3, jsonSpillGov) {
d3.json(apiStringMNS + '?' + (Math.floor(Math.random() * 1000)), function(error4, jsonSpillMNS) {
d3.json(apiStringMNH + '?' + (Math.floor(Math.random() * 1000)), function(error5, jsonSpillMNH) {
d3.json(apiStringHouse + '?' + (Math.floor(Math.random() * 1000)), function(error6, jsonSpillHouse) {
d3.json(apiStringEVCD + '?' + (Math.floor(Math.random() * 1000)), function(error7, jsonSpillEVCD) {

//JUST IN CASE OF THERMONUCLEAR DISASTER
function fallback(){
  var mapsString = "<img src='http://static.startribune.com/news/elections/frontpage_bars_maps.png' width='100%' />";
  var mobileString = "<img src='http://static.startribune.com/news/elections/frontpage_bars_desktop.png' width='100%' />";
  $("#fulldataviz, #loader").hide();
  $("#fallback").html("<div style='padding:20px; text-align:center;'>We're experiencing technical difficulties, please check back shortly.</div><div>" + mapsString + "</div><div>" + mobileString + "</div>");
  // $("#fallback").html("FALLBACKS!!!11~");
  $("#fallback").show();
}

if (error1 != null || error2 != null || error3 != null || error4 != null || error5 != null || error6 != null || error7 != null) {
   fallback(); 
   return;
}

var dataPrez = jsonSpillPrez;
var dataSen = jsonSpillSen;
var dataGov = jsonSpillGov;
var dataMNS = jsonSpillMNS;
var dataMNH = jsonSpillMNH;
var dataHouse = jsonSpillHouse;
var dataEVCD = jsonSpillEVCD;

mapSpill("president",dataPrez);
if ($(window).width() > 960) { mapSpill("senate",dataSen); }
if ($(window).width() > 960) { mapSpill("governors",dataGov); }
mapSpill("mnsenate",dataMNS);
mapSpill("mnhouse",dataMNH);
mapSpill("house",dataHouse);

$(document).ready(function() {
    $(".dataviz").hide();
    $("#" + race).show();
    mapShow(".map","country");

var docwidth = $(window).width(); 

if ((docwidth < 500)) {
    $("svg").width(docwidth);
    $("svg").height(docwidth / 1.5);
}

});

toggleyBits(dataPrez,dataSen,dataGov,dataMNS,dataMNH,dataHouse,dataEVCD,false);

spillInfo(fetchData("United States","United States","table",dataPrez,"president"));

$(".dparty").html("Clinton");
$(".rparty").html("Trump");
$("#prezButton").trigger("click");
$("#table .president").show();

window.setTimeout(function () { $("#message").html("Rendering results..."); }, 3000);

window.setTimeout(function () {
  
  $("#wrapper").show();
  $(".loading-mask").hide();

    var count = 120;
    var timerId = setInterval(function() {
        count--;
        $(".ticker").html(count);

        if(count == 0) {
            count = 120;
            $(".ticker").html("--");
            reloadData();
        }
    }, 1000);

}, 6000);

});
});
});
});
});
});
}); //end data stream initialization


//REPAINT EVERYTHING TO REFLECT OUR TERRIFYING NEW REALITY
function mapReshade(container, shape, subject, race, dataCompare) {
d3.json("shapefiles/" + shape, function(error, us) {
    if (race != "cartoHouse"){
  d3.selectAll(container + " path")
        .data(us.features)
        .style("fill", function(d){
         if (race == "president") { 
            $('#president .sideStates .block').each(function(i, obj) {
                if ($(this).hasClass(d.properties.STUSPS)){
                var color = fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race);
                $(this).css("background-color", color);
                }
            });
            return fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race); 
         }
         if (race == "senate") { 
            $('#senate .sideStates .block').each(function(i, obj) {
                if ($(this).hasClass(d.properties.STUSPS)){
                var color = fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race);
                $(this).css("background-color", color);
                }
            });
            return fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race); 
         }
         if (race == "governors") { 
            $('#governors .sideStates .block').each(function(i, obj) {
                if ($(this).hasClass(d.properties.STUSPS)){
                var color = fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race);
                $(this).css("background-color", color);
                }
            });
            return fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race); 
         }
         else if (race == "county") { return fetchData(d.properties.GEOID,null,"colors",dataCompare,race); }
           // else if (race == "pct") { return mapColor(d.properties.PCTCODE, race, dataCompare); }
         else if (race == "house") { return fetchData("District " + d.properties.DISTRICT,d.properties.STATENAME,"lean",dataCompare,"ushouse",null,"District " + d.properties.DISTRICT); }
         else if (race == "mnsenate" || race == "mnhouse") { return fetchData("District " + d.properties.DISTRICT,"Minnesota","lean",dataCompare,race); }
        })
       .on("mousedown", function(d, i){
        var str = d.properties.NAME; 
        $(".district").removeClass("selected");
        $(".tableRow").removeClass("selectedBox");
        $(".tableRow[name=" + d.properties.STUSPS + "]").addClass("selectedBox");
        $(".tableRow[name=" + d.properties.DISTRICT + "]").addClass("selectedBox");
        if (race == "president" || race == "senate" ||  race == "governors"){ 
            spillInfo(fetchData(d.properties.NAME,d.properties.NAME,"table",dataCompare,race)); $(".block").removeClass("blockSelect"); $("." + d.properties.STUSPS).addClass("blockSelect"); 
        }
        else if (race == "county"){ 
            spillInfo(fetchData(d.properties.GEOID,null,"table",dataCompare,race,null,d.properties.NAME)); 
        }
        else if (race == "house"){ 
            spillInfo(fetchData("District " + d.properties.DISTRICT,d.properties.STATENAME,"table",dataCompare,"ushouse",null,"District " + d.properties.DISTRICT)); 
            $(".tableRow").removeClass("selectedBox"); 
            if (d.properties.STATENAME == "Minnesota") { 
                $(".tableRow[name=" + d.properties.STATENAME + "" + d.properties.DISTRICT + "]").addClass("selectedBox"); } 
            } 
        else if (race == "mnsenate" || race == "mnhouse") { 
            spillInfo(fetchData("District " + d.properties.DISTRICT,"Minnesota","table",dataCompare,race,null,"District " + d.properties.DISTRICT)); }
       })
         .call(d3.helper.tooltip(function(d, i){
         if ($(window).width() > 960) { 
         if (race == "president" || race == "senate" || race == "governors") { 
            return fetchData(d.properties.NAME,d.properties.NAME,"tooltip",dataCompare,race);
         }
         else if (race == "county") { 
            return fetchData(d.properties.GEOID,null,"tooltip",dataCompare,race,null,d.properties.NAME); 
         }
         else if (race == "house") { 
            return fetchData("District " + d.properties.DISTRICT,d.properties.STATENAME,"tooltip",dataCompare,"ushouse",null,"District " + d.properties.DISTRICT); 
         }
         else if (race == "mnsenate" || race == "mnhouse") { 
            return fetchData("District " + d.properties.DISTRICT,"Minnesota","tooltip",dataCompare,race,null,"District " + d.properties.DISTRICT); }
        }}));
  } else {

  d3.selectAll(container + " path")
        .data(topojson.feature(us, us.objects['cart113']).features)
        .style("fill", function(d){
           return fetchData("District " + d.properties['d'],d.properties.State,"lean",dataCompare,"ushouse",null,"District " + d.properties['d']); 
          })
        .attr("class","cd")
        .on("mousedown", function(d, i){
            d3.selectAll(".cd").classed("active",false);
            d3.select(this).classed("active",true);
            $(".tableRow").removeClass("selectedBox");
            if (d.properties.State == "Minnesota") { 
                $(".tableRow[name=" + d.properties.State + "" + d.properties['d'] + "]").addClass("selectedBox"); 
            }
            spillInfo(fetchData("District " + d.properties['d'],d.properties.State,"table",dataCompare,"ushouse",null,"District " + d.properties['d']))
         })
         .call(d3.helper.tooltip(function(d, i){
        if ($(window).width() > 960) { 
            return fetchData("District " + d.properties['d'],d.properties.State,"tooltip",dataCompare,"ushouse",null,"District " + d.properties['d']);
        } else { $(".tooltip").hide(); }}));
  }
});
} //end mapReshade

//A SUMMONING SPELL FOR NEW DATA
function reloadData(){

   d3.json(apiStringPrez + '?' + (Math.floor(Math.random() * 1000)), function(error1, jsonSpillPrez) {
   d3.json(apiStringSen + '?' + (Math.floor(Math.random() * 1000)), function(error2, jsonSpillSen) {
   d3.json(apiStringGov + '?' + (Math.floor(Math.random() * 1000)), function(error3, jsonSpillGov) {
   d3.json(apiStringMNS + '?' + (Math.floor(Math.random() * 1000)), function(error4, jsonSpillMNS) {
   d3.json(apiStringMNH + '?' + (Math.floor(Math.random() * 1000)), function(error5, jsonSpillMNH) {
   d3.json(apiStringHouse + '?' + (Math.floor(Math.random() * 1000)), function(error6, jsonSpillHouse) {
   d3.json(apiStringEVCD + '?' + (Math.floor(Math.random() * 1000)), function(error7, jsonSpillEVCD) {   

   var dataPrez = jsonSpillPrez;
   var dataSen = jsonSpillSen;
   var dataGov = jsonSpillGov;
   var dataMNS = jsonSpillMNS;
   var dataMNH = jsonSpillMNH;
   var dataHouse = jsonSpillHouse;
   var dataEVCD = jsonSpillEVCD;   

   // $(".raceSwitch, .cartoState, .tableRow, .block, .has-sub, .stateBlock, #evcdNE01, #evcdNE02, #evcdNE03, #evcdME01, #evcdME02").off("click");
   // $(".ME01, #ME01, .ME02, #ME02, .NE01, #NE01, .NE02, #NE02, .NE03, #NE03, .cartoState rect, .cartoState, .block").off();

   //presidential updates
   mapReshade("#USMAP .country", "us_states.json", "country", "president", dataPrez);
   if ($(window).width() > 960) { mapReshade("#USMAP .counties", "us_counties.json", "counties", "county", dataPrez); }
   electoralCarto(dataPrez);   

   //senate updates
   if ($(window).width() > 960) { mapReshade("#USSENATE .country", "us_states.json", "country", "senate", dataSen); }   

   //governors updates
   if ($(window).width() > 960) { mapReshade("#USGOV .country", "us_states.json", "country", "governors", dataGov); }   

   //house updates
   mapReshade("#USHOUSE .country", "uscongress.json", "country", "house", dataHouse);
   mapReshade("#cartoHouse svg", "usdistricts_cartogram.json", "country", "cartoHouse", dataHouse);
   // mapReshade("#USHOUSEMN .country", "us_cd_mn_2012.json", "country", "house", dataHouse);   

   //mnhouse updates
   mapReshade("#MNHOUSE .country", "mnleg.json", "country", "mnhouse", dataMNH);
   if ($(window).width() > 960) { mapReshade("#MNHOUSEMETRO", "mnleg_metro.json", "country", "mnhouse", dataMNH); }   

   //mnsenate updates
   mapReshade("#MNSENATE .country", "mnsenate.json", "country", "mnsenate", dataMNS);
   if ($(window).width() > 960) { mapReshade("#MNSENATEMETRO", "mnsenate_metro.json", "country", "mnsenate", dataMNS); }   

   d3.selectAll("path").classed("faded", false).classed("active", false);
   $(".block").removeClass("blockSelect");   

   toggleyBits(dataPrez,dataSen,dataGov,dataMNS,dataMNH,dataHouse,dataEVCD);

   if (thisView == "mn") { spillInfo(fetchData("Minnesota","Minnesota","table",dataPrez,"president")); }
   else if (thisView == "us") { spillInfo(fetchData("United States","United States","table",dataPrez,"president")); }
   else if (thisView == "cd") { spillInfo(fetchData("District 2","Minnesota","table",dataHouse,"ushouse",null,"District 2")); }
   else { $("#infobox").html(""); }

});
});
});
});
});
});
});
} //end reloadData

//NAV MENU DARK MAGICKS
$('#cssmenu li.active').addClass('open').children('ul').show();

$('#cssmenu li.has-sub>a, #mobmenu li.has-sub>a').on('click', function(){
    $(this).removeAttr('href');
    var element = $(this).parent('li');
    if (element.hasClass('open')) {
        element.removeClass('open');
        element.find('li').removeClass('open');
        element.find('ul').slideUp(200);
    }
    else {
        element.addClass('open');
        element.children('ul').slideDown(200);
        element.siblings('li').children('ul').slideUp(200);
        element.siblings('li').removeClass('open');
        element.siblings('li').find('li').removeClass('open');
        element.siblings('li').find('ul').slideUp(200);
    }
});

$( "button" ).click(function() { $("#mobmenu").toggle(); });
$("#mobmenu .raceSwitch").click(function() { $("#mobmenu").toggle(); });

//SOCIAL MEDIA TRIGGERS THAT DON'T WORK VERY WELL
function fbs_click() {
u=location.href;t=document.title;window.open('http://www.facebook.com/sharer.php?u='+encodeURIComponent(u)+'&t='+encodeURIComponent(t),'sharer','toolbar=0,status=0,width=520,height=350');return false;
}

function twitter_click(url){newwindow=window.open(url,'name','height=350,width=520');
    if (window.focus) {newwindow.focus()}
    return false;
}
</script>
</html>