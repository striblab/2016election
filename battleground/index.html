<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Star Tribune: Election 2016 live results</title>
  <meta name="description" content="Election 2016 live results">
  <meta name="author" content="Frey Hargarten - StarTribune">

  <!-- ARIANA GRANDE IS NEITHER A FONT NOR A LATTE -->
  <link rel="stylesheet" href="./css/startribune_dataviz_styles.css" />
  <link rel="stylesheet" href="./css/datastyles.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" />
</head>

<!-- THUS BEGINS THE LIFELESS HUSK THAT IS MARKUP -->
<body>

<!-- LOADING MASK THINGY SO PEOPLE GET LESS FRUSTRATED AND HATE US LESS -->
<div class="loading-mask" id="loader">  
  <div id="message">Retrieving results...</div>
</div>

<!-- HOW CAN I HOLD ALL THESE TAGS??? -->
<div id="wrapper">

<!-- TOP ELECTIONS BANNER THINGIES FOR OTHER, NON-CLICKY MAP COVERAGE FOR PEOPLE WHO LIKE READING WORDS -->
<div class="l-elections-wrapper">
    <div clas="l-election-results-header">
<div class="resultsBanner">      
  <div class="section group">
    <div class="col span_1_of_3">
      <div class="resultsLogo">
        <h4><a href="http://startribune.com/politics" target="new_">ELECTION</a></h4>
        <a href="#">
          <div class="resultsLogoSVG"></div>
        </a>
      </div>
      <div class="coverageLinks cl-dsktp">
        <a href="http://election.startribune.com/results/2016/general" target="new_">MN results</a>&nbsp;&nbsp;•&nbsp;&nbsp;<a href="http://election.startribune.com/myvote" target="new_">MyVote</a>
      </div>      
    </div>
    <div class="col span_2_of_3">
      <div class="drop">
        <button class="switch">View Races <img class="test-chev button-drop" src="http://static.startribune.com/mike-test/down-chevron.png"></button>
      </div>
      <div class="coverageLinks cl-mobile">
        <a href="http://election.startribune.com/results/2016/general" target="new_">MN results</a>&nbsp;&nbsp;•&nbsp;&nbsp;<a href="http://election.startribune.com/myvote" target="new_">MyVote</a>
      </div>       
    </div>
  </div>
</div>
    </div>
</div>


<!-- SERIOUS BUSINESS STARTS HERE -->
<div id="fulldataviz">

<!-- LEFT RAIL -->
<div id="raceSwitcher">

<!-- MOBILE MENU, AS USED BY MOST OF HUMANITY -->
<div id='mobmenu'>
<ul id="nav">
   <li class='<!-- active--> has-sub'><a href='#'>President  <img class="test-chev" src="http://static.startribune.com/mike-test/down-chevron.png"></a>
      <ul>
         <li class="raceSwitch advance uszoom" data="president" legend="legendWinners" type="carto" layer="country" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="us"><a href='#'><div><div><strong>U.S.</strong> electoral</div></div></a>
         </li>
         <li class="raceSwitch advance uszoom" data="president" legend="legendWinners" type="geo" layer="country" dLabel="Clinton" rLabel="Trump" stateKey="showMe" infobox="us"><a href='#'> <div><div><strong>U.S.</strong> popular by state</div></div></a>
         </li>
         <li class="raceSwitch menukill advance uszoom" data="president" legend="legendMargins" type="geo" layer="counties" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="us"><a href='#'><div><div><strong>U.S.</strong> popular by county</div></div></a>
         </li>
         <li class="raceSwitch menukill advance mnzoom" data="president" legend="legendMargins" type="geo" layer="counties" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="mn"><a href='#'><div><div><strong>MN</strong> popular by county</div></div></a>
         </li>
         <li><a href='#'><div class="raceSwitch menukill advance mnzoom" data="president" legend="legendMargins" type="map" layer="pct"><div><strong>MN</strong> popular by precinct</div></div></a>
        <!--  </li> -->
         <li class="raceSwitch menukill advance metrozoom" data="president" legend="legendMargins" type="geo" layer="counties" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="mn"><a href='#'><div><div><strong>Metro</strong> popular by county</div></div></a>
         </li>
<!--          <li><a href='#'><div class="raceSwitch advance metrozoom" data="president" legend="legendMargins" type="map" layer="pct"><div><strong>Metro</strong> popular by precinct</div></div></a> -->
      </ul>   
   </li>
   <li class='has-sub'><a href='#'>US House  <img class="test-chev" src="http://static.startribune.com/mike-test/down-chevron.png"></a>
      <ul>
        <li class="raceSwitch advance uszoom" data="house" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="false" infobox="cd"><a href='#'><div><div><strong>U.S.</strong> by district</div></div></a></li>
        <li class="raceSwitch advance uszoom" data="house" legend="legendWinners" type="carto" layer="country" dLabel="DEM" rLabel="GOP" stateKey="false" infobox="cd"><a href='#'><div><div>CARTO by district </div></div></a></li>
        <li class="raceSwitch advance mnzoom" data="house" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="false" infobox="cd"><a href='#'><div><div><strong>MN</strong> by district</div></div></a></li>
      </ul>
   </li> 
   <li class="raceSwitch advance menukill uszoom"  section="senate" data="senate" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="showMe" infobox="none"><a href='#'><div><div>U.S. Senate</div></div></a></li>  
   <li class="raceSwitch advance menukill uszoom" section="governors" data="governors" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="showMe" infobox="none"><a href='#'><div><div>Governors</div></div></a></li>
   <li section="mnhouse" class="raceSwitch advance uszoom" data="mnhouse" legend="legendWinners" type="geo" layer="country" dLabel="DFL" rLabel="GOP" stateKey="false" infobox="none"><a href='#'>MN House</a></li>
   <li section="mnsenate" class="raceSwitch advance uszoom" data="mnsenate" legend="legendWinners" type="geo" layer="country" dLabel="DFL" rLabel="GOP" stateKey="false" infobox="none"><a href='#'>MN Senate</a> </li>
</ul>
<li class="advance"><div class="shareRow">
    <div class="shareLeft">
        <a href="http://www.facebook.com/share.php?u=&lt;url&gt;" onclick="return fbs_click()" target="_blank">
            <img style="width:30px;" src="http://stmedia.startribune.com/designimages/faceBookCustomIcon.png">
        </a>
    </div>
    <div class="shareRight">
        <a id="twitterbtn-link" onclick="return twitter_click('https://twitter.com/share?url=ENCODEDURL&amp;counturl=ENCODEDURL&amp;text=ENCODEDTWEETTEXT&amp;via=StarTribune')">
            <img style="width:30px;" src="http://stmedia.startribune.com/designimages/twitterCustomIcon.png">
        </a> 
    </div>
</div></li>
</div> <!-- end mobmenu -->

<!-- DESKTOP MENU FOR GAMERS, SUBTERRANIAN DWELLERS AND OLD PEOPLE -->
<div id='cssmenu'>
<div id="countdown"><span class="ticker">0</span> to next update</div>
<ul id="nav">
   <li class='<!-- active--> has-sub'><a href='#'>President  <img class="test-chev" src="http://static.startribune.com/mike-test/down-chevron.png"></a>
      <ul>
         <li class="raceSwitch advance uszoom" data="president" legend="legendWinners" type="carto" layer="country" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="us"><a href='#'><div><div><strong>U.S.</strong> electoral</div></div></a>
         </li>
         <li class="raceSwitch advance uszoom" data="president" legend="legendWinners" type="geo" layer="country" dLabel="Clinton" rLabel="Trump" stateKey="showMe" infobox="us"><a href='#'> <div><div><strong>U.S.</strong> popular by state</div></div></a>
         </li>
         <li class="raceSwitch advance uszoom" data="president" legend="legendMargins" type="geo" layer="counties" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="us"><a href='#'><div><div><strong>U.S.</strong> popular by county</div></div></a>
         </li>
         <li class="raceSwitch advance mnzoom" data="president" legend="legendMargins" type="geo" layer="counties" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="mn"><a href='#'><div><div><strong>MN</strong> popular by county</div></div></a>
         </li>
<!--          <li><a href='#'><div class="raceSwitch advance mnzoom" data="president" legend="legendMargins" type="map" layer="pct"><div><strong>MN</strong> popular by precinct</div></div></a> -->
         </li>
         <li class="raceSwitch advance metrozoom" data="president" legend="legendMargins" type="geo" layer="counties" dLabel="Clinton" rLabel="Trump" stateKey="false" infobox="mn"><a href='#'><div><div><strong>Metro</strong> popular by county</div></div></a>
         </li>
<!--          <li><a href='#'><div class="raceSwitch advance metrozoom" data="president" legend="legendMargins" type="map" layer="pct"><div><strong>Metro</strong> popular by precinct</div></div></a> -->
         </li>
      </ul>   
   </li>
   <li class='has-sub'><a href='#'>US House  <img class="test-chev" src="http://static.startribune.com/mike-test/down-chevron.png"></a>
      <ul>
        <li class="raceSwitch advance uszoom" data="house" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="false" infobox="cd"><a href='#'><div><div><strong>U.S.</strong> by district</div></div></a></li>
        <li class="raceSwitch advance uszoom" data="house" legend="legendWinners" type="carto" layer="country" dLabel="DEM" rLabel="GOP" stateKey="false" infobox="cd"><a href='#'><div><div>CARTO by district </div></div></a></li>
        <li class="raceSwitch advance mnzoom" data="house" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="false" infobox="cd"><a href='#'><div><div><strong>MN</strong> by district</div></div></a></li>
      </ul>
   </li> 
   <li class="raceSwitch advance uszoom"  section="senate" data="senate" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="showMe" infobox="none"><a href='#'><div><div>U.S. Senate</div></div></a></li> 
   <li class="raceSwitch advance uszoom" section="governors" data="governors" legend="legendWinners" type="geo" layer="country" dLabel="DEM" rLabel="GOP" stateKey="showMe" infobox="none"><a href='#'><div><div>Governors</div></div></a></li>
   <li section="mnhouse" class="raceSwitch advance uszoom" data="mnhouse" legend="legendWinners" type="geo" layer="country" dLabel="DFL" rLabel="GOP" stateKey="false" infobox="none"><a href='#'>MN House</a></li>
   <li section="mnsenate" class="raceSwitch advance uszoom" data="mnsenate" legend="legendWinners" type="geo" layer="country" dLabel="DFL" rLabel="GOP" stateKey="false" infobox="none"><a href='#'>MN Senate</a></li>
<li><div class="shareRow">
    <div class="shareLeft">
        <a href="http://www.facebook.com/share.php?u=&lt;url&gt;" onclick="return fbs_click()" target="_blank">
            <img style="width:30px;" src="http://stmedia.startribune.com/designimages/faceBookCustomIcon.png">
        </a>
    </div>
    <div class="shareRight">
        <a id="twitterbtn-link" onclick="return twitter_click('https://twitter.com/share?url=http%3A%2F%2Fwww.startribune.com%2Fx%2F396064451%2F&amp;counturl=http%3A%2F%2Fwww.startribune.com%2Fx%2F396064451%2F&amp;text=Star+Tribune%3A+Election+2016+live+results+tracker&amp;via=StarTribune')">
            <img style="width:30px;" src="http://stmedia.startribune.com/designimages/twitterCustomIcon.png">
        </a> 
    </div>
</div></li>
</ul>
</div> <!-- end cssmenu -->

</div> <!-- end raceSwitcher -->

<!-- WHERE THE SHINY THINGS LIVE -->
<div id="datavizPane">

<!-- POWER BALANCE BAR -->
<div class="bars" id="powerbar">
<div id="partyLabels">
  <div class="label demsLabel"><span class="count demsCount">0</span> <span class="dparty dlabel" style="text-align:left;">DEM</span> <span id="dMark" class="check"></span> <span id="dChange" class="change"></span> </div>
  <div class="label gopLabel"><span id="rChange" class="change"></span> <span id="rMark" class="check"></span> <span class="rparty rlabel" style="text-align:right;">GOP</span> <span class="count gopCount">0</span></div>
</div>
<div id="partyBar">
  <div class="backbar">
  <div class="bar democrat" id="dWin" style="float:left !important;"></div><div class="bar green4" id="iWin"  style="float:left !important;"></div><div class="bar republican" id="rWin"></div>
  </div>
</div>
</div> <!-- end powerbar -->

<div class="breaker"></div>


<!-- PRESIDENTIAL PANE: FOR PEERING INTO THE ABYSS OF OUR DOOMED FUTURE -->
<div id="president" class="dataviz">

<!-- ZOMG MAPS THAT CLICK -->
<div class="mapBox">
<!-- THE MAIN EVENT MAP -->
<div id="map" class="map geo"><svg id="USMAP" width="800" height="600" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid"></svg>

<!-- FOR THE TINY STATES TOO SAD TO FIT A LABEL -->
<div class="sideStates"><div class="block stateBlock VT" name="Vermont" ab="VT">VT</div><div class="block stateBlock NH" name="New Hampshire" ab="NH">NH</div><div class="block stateBlock MA" name="Massachusetts" ab="MA">MA</div><div class="block stateBlock RI" name="Rhode Island" ab="RI">RI</div><div class="block stateBlock CT" name="Connecticut" ab="CT">CT</div><div class="block stateBlock NJ" name="New Jersey" ab="NJ">NJ</div><div class="block stateBlock DE" name="Delaware" ab="DE">DE</div><div class="block stateBlock MD" name="Maryland" ab="MD">MD</div><div class="block stateBlock DC" name="District of Columbia" ab="DC">DC</div><div class="block stateBlock HI" name="Hawaii" ab="HI">HI</div><div class="block ME01 evcd" name="Main District 1" ab="ME01">ME1</div><div class="block ME02 evcd" name="Main District 2" ab="ME02">ME2</div><div class="block NE01 evcd" name="Nebraska District 1" ab="NE01">NE1</div><div class="block NE02 evcd" name="Nebraska District 2" ab="NE02">NE2</div><div class="block NE03 evcd" name="Nebraska District 3" ab="NE03">NE3</div></div>
</div>

<!-- AN UGLY ELECTORAL COLLEGE MAP FOR WONKS WHO LIKE SQUARES -->
<div id="carto" class="map normal carto">
<div id="cartogram">
<svg id="FULLCARTO" version="1.1" x="0px" y="0px" width="90%" viewBox="0 0 600 696.572" enable-background="new 0 0 860 696.572" xml:space="preserve">
<style type="text/css">
  .st0{font-family:'ArialMT';}
  .st1{font-size:7.6856px;}
  .st2{fill:none;}
</style>
<g id="PA" class="cartoState" name="Pennsylvania">
  <polygon points="450.6,126.6 464.6,126.6 464.6,140.5 450.6,140.5 450.6,126.6"/>
  <polygon points="380.8,126.6 394.8,126.6 394.8,140.5 380.8,140.5 380.8,126.6"/>
  <polygon points="408.8,140.9 422.8,140.9 422.8,154.8 408.8,154.8 408.8,140.9"/>
  <polygon points="394.8,126.6 408.7,126.6 408.7,140.5 394.8,140.5 394.8,126.6"/>
  <polygon points="436.7,140.9 450.6,140.9 450.6,154.8 436.7,154.8 436.7,140.9"/>
  <polygon points="422.8,155.4 436.8,155.4 436.8,169.3 422.8,169.3 422.8,155.4"/>
  <polygon points="422.8,126.6 436.8,126.6 436.8,140.5 422.8,140.5 422.8,126.6"/>
  <polygon points="409,126.6 422.9,126.6 422.9,140.5 409,140.5 409,126.6"/>
  <polygon points="422.8,140.9 436.8,140.9 436.8,154.8 422.8,154.8 422.8,140.9"/>
  <polygon points="450.6,169.2 464.6,169.2 464.6,183.1 450.6,183.1 450.6,169.2"/>
  <polygon points="450.7,140.9 464.6,140.9 464.6,154.8 450.7,154.8 450.7,140.9"/>
  <polygon points="436.7,155.4 450.7,155.4 450.7,169.3 436.7,169.3 436.7,155.4"/>
  <polygon points="436.7,126.6 450.7,126.6 450.7,140.5 436.7,140.5 436.7,126.6"/>
  <polygon points="366.8,126.6 380.8,126.6 380.8,140.5 366.8,140.5 366.8,126.6"/>
  <polygon points="380.8,140.9 394.8,140.9 394.8,154.8 380.8,154.8 380.8,140.9"/>
  <polygon points="394.8,140.9 408.7,140.9 408.7,154.8 394.8,154.8 394.8,140.9"/>
  <polygon points="464.7,155.2 478.6,155.2 478.6,169.2 464.7,169.2 464.7,155.2"/>
  <polygon points="464.6,169.2 478.5,169.2 478.5,183.1 464.6,183.1 464.6,169.2"/>
  <polygon points="450.6,155.2 464.6,155.2 464.6,169.2 450.6,169.2 450.6,155.2"/>
  <polygon points="464.6,140.9 478.5,140.9 478.5,154.8 464.6,154.8 464.6,140.9"/>
</g>
<g id="ME" class="cartoState" name="Maine">
  <polygon points="465,1.8 478.9,1.8 478.9,15.8 465,15.8 465,1.8"/>
  <polygon points="451,15.8 465,15.8 465,29.7 451,29.7 451,15.8"/>
</g>
<g id="ME01" class="cartoState evcd" name="Maine">
  <polygon points="465,15.8 478.9,15.8 478.9,29.7 465,29.7 465,15.8"/>
</g>
<g id="ME02" class="cartoState evcd" name="Maine">
  <polygon points="478.6,29.7 492.5,29.7 492.5,43.6 478.6,43.6 478.6,29.7"/>
</g>
<g id="NH" class="cartoState" name="New Hampshire">
  <polygon points="478.6,57.6 492.5,57.6 492.5,71.6 478.6,71.6 478.6,57.6"/>
  <polygon points="478.6,43.6 492.5,43.6 492.5,57.6 478.6,57.6 478.6,43.6"/>
  <polygon points="492.5,57.6 506.5,57.6 506.5,71.5 492.5,71.5 492.5,57.6"/>
  <polygon points="492.5,43.6 506.5,43.6 506.5,57.6 492.5,57.6 492.5,43.6"/>
</g>
<g id="VT" class="cartoState" name="Vermont">
  <polygon points="464.7,29.7 478.7,29.7 478.7,43.6 464.7,43.6 464.7,29.7"/>
  <polygon points="464.6,43.6 478.6,43.6 478.6,57.5 464.6,57.5 464.6,43.6"/>
  <polygon points="464.7,57.5 478.7,57.5 478.7,71.5 464.7,71.5 464.7,57.5"/>
</g>
<g id="MA" class="cartoState" name="Massachusetts">
  <polygon points="492.5,71.2 506.5,71.2 506.5,85.1 492.5,85.1 492.5,71.2"/>
  <polygon points="492.5,85.1 506.5,85.1 506.5,99.1 492.5,99.1 492.5,85.1"/>
  <polygon points="478.5,71.2 492.5,71.2 492.5,85.1 478.5,85.1 478.5,71.2"/>
  <polygon points="478.5,85.1 492.5,85.1 492.5,99.1 478.5,99.1 478.5,85.1"/>
  <polygon points="506.5,71.2 520.5,71.2 520.5,85.1 506.5,85.1 506.5,71.2"/>
  <polygon points="506.5,85.1 520.5,85.1 520.5,99.1 506.5,99.1 506.5,85.1"/>
  <polygon points="520.5,71.2 534.4,71.2 534.4,85.1 520.5,85.1 520.5,71.2"/>
  <polygon points="520.5,85.1 534.4,85.1 534.4,99.1 520.5,99.1 520.5,85.1"/>
  <polygon points="534.4,71.2 548.4,71.2 548.4,85.1 534.4,85.1 534.4,71.2"/>
  <polygon points="534.4,85.1 548.4,85.1 548.4,99.1 534.4,99.1 534.4,85.1"/>
  <polygon points="464.6,71.2 478.5,71.2 478.5,85.1 464.6,85.1 464.6,71.2"/>
</g>
<g id="RI" class="cartoState" name="Rhode Island">
  <polygon points="506.5,99.1 520.5,99.1 520.5,113 506.5,113 506.5,99.1"/>
  <polygon points="506.5,113 520.5,113 520.5,127 506.5,127 506.5,113"/>
  <polygon points="520.5,99.1 534.4,99.1 534.4,113 520.5,113 520.5,99.1"/>
  <polygon points="520.5,113 534.4,113 534.4,127 520.5,127 520.5,113"/>
</g>
<g id="CT" class="cartoState" name="Connecticut">
  <polygon points="478.6,98.9 492.5,98.9 492.5,112.9 478.6,112.9 478.6,98.9"/>
  <polygon points="464.6,112.9 478.6,112.9 478.6,126.9 464.6,126.9 464.6,112.9"/>
  <polygon points="478.6,112.9 492.5,112.9 492.5,126.9 478.6,126.9 478.6,112.9"/>
  <polygon points="492.5,98.9 506.5,98.9 506.5,112.9 492.5,112.9 492.5,98.9"/>
  <polygon points="492.5,112.9 506.5,112.9 506.5,126.9 492.5,126.9 492.5,112.9"/>
  <polygon points="464.6,98.9 478.6,98.9 478.6,112.9 464.6,112.9 464.6,98.9"/>
  <polygon points="464.6,84.8 478.6,84.8 478.6,98.8 464.6,98.8 464.6,84.8"/>
</g>
<g id="NY" class="cartoState" name="New York">
  <polygon points="464.6,126.6 478.6,126.6 478.6,140.5 464.6,140.5 464.6,126.6"/>
  <polygon points="422.7,112.8 436.7,112.8 436.7,126.6 422.7,126.6 422.7,112.8"/>
  <polygon points="380.9,112.8 394.8,112.8 394.8,126.6 380.9,126.6 380.9,112.8"/>
  <polygon points="394.8,112.8 408.8,112.8 408.8,126.6 394.8,126.6 394.8,112.8"/>
  <polygon points="408.8,112.8 422.7,112.8 422.7,126.6 408.8,126.6 408.8,112.8"/>
  <polygon points="422.7,98.9 436.7,98.9 436.7,112.8 422.7,112.8 422.7,98.9"/>
  <polygon points="436.7,98.9 450.7,98.9 450.7,112.8 436.7,112.8 436.7,98.9"/>
  <polygon points="450.7,98.9 464.6,98.9 464.6,112.8 450.7,112.8 450.7,98.9"/>
  <polygon points="450.7,85.1 464.6,85.1 464.6,98.9 450.7,98.9 450.7,85.1"/>
  <polygon points="450.7,71.2 464.6,71.2 464.6,85.1 450.7,85.1 450.7,71.2"/>
  <polygon points="450.7,57.3 464.6,57.3 464.6,71.2 450.7,71.2 450.7,57.3"/>
  <polygon points="450.7,43.5 464.6,43.5 464.6,57.3 450.7,57.3 450.7,43.5"/>
  <polygon points="436.7,112.8 450.7,112.8 450.7,126.6 436.7,126.6 436.7,112.8"/>
  <polygon points="366.9,112.8 380.9,112.8 380.9,126.6 366.9,126.6 366.9,112.8"/>
  <polygon points="450.7,29.7 464.6,29.7 464.6,43.5 450.7,43.5 450.7,29.7"/>
  <polygon points="422.7,57.3 436.7,57.3 436.7,71.2 422.7,71.2 422.7,57.3"/>
  <polygon points="394.8,85.1 408.8,85.1 408.8,98.9 394.8,98.9 394.8,85.1"/>
  <polygon points="380.9,98.9 394.8,98.9 394.8,112.8 380.9,112.8 380.9,98.9"/>
  <polygon points="394.8,98.9 408.8,98.9 408.8,112.8 394.8,112.8 394.8,98.9"/>
  <polygon points="408.8,98.9 422.7,98.9 422.7,112.8 408.8,112.8 408.8,98.9"/>
  <polygon points="408.8,85.1 422.7,85.1 422.7,98.9 408.8,98.9 408.8,85.1"/>
  <polygon points="478.6,126.6 492.5,126.6 492.5,140.5 478.6,140.5 478.6,126.6"/>
  <polygon points="408.8,71.2 422.7,71.2 422.7,85.1 408.8,85.1 408.8,71.2"/>
  <polygon points="422.7,85.1 436.7,85.1 436.7,98.9 422.7,98.9 422.7,85.1"/>
  <polygon points="436.7,85.1 450.7,85.1 450.7,98.9 436.7,98.9 436.7,85.1"/>
  <polygon points="436.7,71.2 450.7,71.2 450.7,85.1 436.7,85.1 436.7,71.2"/>
  <polygon points="422.7,71.2 436.7,71.2 436.7,85.1 422.7,85.1 422.7,71.2"/>
  <polygon points="436.7,57.3 450.7,57.3 450.7,71.2 436.7,71.2 436.7,57.3"/>
  <polygon points="450.7,112.8 464.6,112.8 464.6,126.6 450.7,126.6 450.7,112.8"/>
</g>
<g id="NJ" class="cartoState" name="New Jersey">
  <polygon points="492.6,154.1 506.6,154.1 506.6,168 492.6,168 492.6,154.1"/>
  <polygon points="506.6,154.1 520.5,154.1 520.5,168 506.6,168 506.6,154.1"/>
  <polygon points="520.5,168 534.5,168 534.5,182 520.5,182 520.5,168"/>
  <polygon points="492.6,140.1 506.6,140.1 506.6,154.1 492.6,154.1 492.6,140.1"/>
  <polygon points="506.6,140.1 520.5,140.1 520.5,154.1 506.6,154.1 506.6,140.1"/>
  <polygon points="492.6,168 506.6,168 506.6,182 492.6,182 492.6,168"/>
  <polygon points="492.6,182 506.6,182 506.6,196 492.6,196 492.6,182"/>
  <polygon points="506.6,196 520.5,196 520.5,209.9 506.6,209.9 506.6,196"/>
  <polygon points="506.6,182 520.5,182 520.5,196 506.6,196 506.6,182"/>
  <polygon points="506.6,168 520.5,168 520.5,182 506.6,182 506.6,168"/>
  <polygon points="520.5,196 534.5,196 534.5,209.9 520.5,209.9 520.5,196"/>
  <polygon points="492.6,196 506.6,196 506.6,209.9 492.6,209.9 492.6,196"/>
  <polygon points="520.5,182 534.5,182 534.5,196 520.5,196 520.5,182"/>
  <polygon points="478.7,140.1 492.6,140.1 492.6,154.1 478.7,154.1 478.7,140.1"/>
</g>
<g id="DE" class="cartoState" name="Delaware">
  <polygon points="478.7,182 492.7,182 492.7,195.9 478.7,195.9 478.7,182"/>
  <polygon points="478.7,168 492.7,168 492.7,181.9 478.7,181.9 478.7,168"/>
  <polygon points="478.7,154 492.7,154 492.7,168 478.7,168 478.7,154"/>
</g>
<g id="MD" class="cartoState" name="Maryland">
  <polygon points="408.8,155.2 422.8,155.2 422.8,169.2 408.8,169.2 408.8,155.2"/>
  <polygon points="450.6,210.9 464.6,210.9 464.6,224.8 450.6,224.8 450.6,210.9"/>
  <polygon points="380.9,155.2 394.9,155.2 394.9,169.2 380.9,169.2 380.9,155.2"/>
  <polygon points="394.9,155.2 408.9,155.2 408.9,169.2 394.9,169.2 394.9,155.2"/>
  <polygon points="422.8,183.1 436.8,183.1 436.8,197.1 422.8,197.1 422.8,183.1"/>
  <polygon points="436.7,169.2 450.6,169.2 450.6,183.1 436.7,183.1 436.7,169.2"/>
  <polygon points="422.8,169.2 436.8,169.2 436.8,183.1 422.8,183.1 422.8,169.2"/>
  <polygon points="408.8,169.2 422.8,169.2 422.8,183.1 408.8,183.1 408.8,169.2"/>
  <polygon points="436.7,183.1 450.6,183.1 450.6,197.1 436.7,197.1 436.7,183.1"/>
  <polygon points="450.6,197 464.6,197 464.6,211 450.6,211 450.6,197"/>
</g>
<g id="WV" class="cartoState" name="West Virginia">
  <polygon points="380.9,183.1 394.8,183.1 394.8,197.1 380.9,197.1 380.9,183.1"/>
  <polygon points="394.8,183.1 408.8,183.1 408.8,197.1 394.8,197.1 394.8,183.1"/>
  <polygon points="394.8,169.2 408.8,169.2 408.8,183.1 394.8,183.1 394.8,169.2"/>
  <polygon points="408.8,183.1 422.7,183.1 422.7,197.1 408.8,197.1 408.8,183.1"/>
  <polygon points="380.8,169.2 394.8,169.2 394.8,183.2 380.8,183.2 380.8,169.2"/>
</g>
<g id="OH" class="cartoState" name="Ohio">
  <polygon points="325,126.9 338.9,126.9 338.9,140.8 325,140.8 325,126.9"/>
  <polygon points="338.9,140.8 352.9,140.8 352.9,154.8 338.9,154.8 338.9,140.8"/>
  <polygon points="338.9,168.7 352.9,168.7 352.9,182.7 338.9,182.7 338.9,168.7"/>
  <polygon points="352.9,154.8 366.9,154.8 366.9,168.7 352.9,168.7 352.9,154.8"/>
  <polygon points="352.9,168.7 366.9,168.7 366.9,182.7 352.9,182.7 352.9,168.7"/>
  <polygon points="352.9,140.8 366.9,140.8 366.9,154.8 352.9,154.8 352.9,140.8"/>
  <polygon points="352.9,126.9 366.9,126.9 366.9,140.8 352.9,140.8 352.9,126.9"/>
  <polygon points="366.9,155.3 380.8,155.3 380.8,169.2 366.9,169.2 366.9,155.3"/>
  <polygon points="325.4,183.1 339.4,183.1 339.4,197.1 325.4,197.1 325.4,183.1"/>
  <polygon points="339.4,183.1 353.3,183.1 353.3,197.1 339.4,197.1 339.4,183.1"/>
  <polygon points="353.3,183.1 367.3,183.1 367.3,197.1 353.3,197.1 353.3,183.1"/>
  <polygon points="366.8,169.2 380.8,169.2 380.8,183.2 366.8,183.2 366.8,169.2"/>
  <polygon points="338.9,154.8 352.9,154.8 352.9,168.7 338.9,168.7 338.9,154.8"/>
  <polygon points="366.8,140.9 380.8,140.9 380.8,154.8 366.8,154.8 366.8,140.9"/>
  <polygon points="325,140.8 338.9,140.8 338.9,154.8 325,154.8 325,140.8"/>
  <polygon points="325,154.8 338.9,154.8 338.9,168.7 325,168.7 325,154.8"/>
  <polygon points="325,168.7 338.9,168.7 338.9,182.7 325,182.7 325,168.7"/>
  <polygon points="338.9,126.9 352.9,126.9 352.9,140.8 338.9,140.8 338.9,126.9"/>
</g>
<g id="MI" class="cartoState" name="Michigan">
  <polygon points="283.1,84.6 297.1,84.6 297.1,98.6 283.1,98.6 283.1,84.6"/>
  <polygon points="297.1,84.6 311.1,84.6 311.1,98.6 297.1,98.6 297.1,84.6"/>
  <polygon points="311.1,84.6 325,84.6 325,98.6 311.1,98.6 311.1,84.6"/>
  <polygon points="283.1,70.7 297.1,70.7 297.1,84.6 283.1,84.6 283.1,70.7"/>
  <polygon points="269.2,56.7 283.1,56.7 283.1,70.7 269.2,70.7 269.2,56.7"/>
  <polygon points="283.1,98.6 297.1,98.6 297.1,112.6 283.1,112.6 283.1,98.6"/>
  <polygon points="297.1,98.6 311.1,98.6 311.1,112.6 297.1,112.6 297.1,98.6"/>
  <polygon points="325,112.6 339,112.6 339,126.5 325,126.5 325,112.6"/>
  <polygon points="325,98.6 339,98.6 339,112.6 325,112.6 325,98.6"/>
  <polygon points="325,84.6 339,84.6 339,98.6 325,98.6 325,84.6"/>
  <polygon points="311.1,98.6 325,98.6 325,112.6 311.1,112.6 311.1,98.6"/>
  <polygon points="283.1,112.6 297.1,112.6 297.1,126.5 283.1,126.5 283.1,112.6"/>
  <polygon points="297.1,112.6 311.1,112.6 311.1,126.5 297.1,126.5 297.1,112.6"/>
  <polygon points="311.1,112.6 325,112.6 325,126.5 311.1,126.5 311.1,112.6"/>
  <polygon points="297.1,70.7 311.1,70.7 311.1,84.6 297.1,84.6 297.1,70.7"/>
  <polygon points="255.2,56.7 269.2,56.7 269.2,70.7 255.2,70.7 255.2,56.7"/>
</g>
<g id="WI" class="cartoState" name="Wisconsin">
  <polygon points="199.4,85.1 213.3,85.1 213.3,99 199.4,99 199.4,85.1"/>
  <polygon points="199.4,99 213.3,99 213.3,113 199.4,113 199.4,99"/>
  <polygon points="213.3,85.1 227.3,85.1 227.3,99 213.3,99 213.3,85.1"/>
  <polygon points="199.4,71.1 213.3,71.1 213.3,85.1 199.4,85.1 199.4,71.1"/>
  <polygon points="213.3,71.1 227.3,71.1 227.3,85.1 213.3,85.1 213.3,71.1"/>
  <polygon points="227.3,99.1 241.2,99.1 241.2,113.1 227.3,113.1 227.3,99.1"/>
  <polygon points="213.3,99 227.3,99 227.3,113 213.3,113 213.3,99"/>
  <polygon points="213.3,113 227.3,113 227.3,127 213.3,127 213.3,113"/>
  <polygon points="227.3,113.1 241.2,113.1 241.2,127.1 227.3,127.1 227.3,113.1"/>
  <polygon points="199.4,113 213.3,113 213.3,127 199.4,127 199.4,113"/>
</g>
<g id="MN" class="cartoState" name="Minnesota">
  <polygon points="157.5,113 171.5,113 171.5,127 157.5,127 157.5,113"/>
  <polygon points="171.5,113 185.4,113 185.4,127 171.5,127 171.5,113"/>
  <polygon points="157.5,99.1 171.5,99.1 171.5,113 157.5,113 157.5,99.1"/>
  <polygon points="185.4,71.1 199.4,71.1 199.4,85.1 185.4,85.1 185.4,71.1"/>
  <polygon points="185.4,85.1 199.4,85.1 199.4,99 185.4,99 185.4,85.1"/>
  <polygon points="171.5,99.1 185.4,99.1 185.4,113 171.5,113 171.5,99.1"/>
  <polygon points="171.5,85.1 185.4,85.1 185.4,99.1 171.5,99.1 171.5,85.1"/>
  <polygon points="185.4,113 199.4,113 199.4,127 185.4,127 185.4,113"/>
  <polygon points="185.4,99 199.4,99 199.4,113 185.4,113 185.4,99"/>
  <polygon points="171.5,71.1 185.4,71.1 185.4,85.1 171.5,85.1 171.5,71.1"/>
</g>
<g id="IA" class="cartoState" name="Iowa">
  <polygon points="157.5,127 171.5,127 171.5,140.9 157.5,140.9 157.5,127"/>
  <polygon points="171.5,127 185.4,127 185.4,140.9 171.5,140.9 171.5,127"/>
  <polygon points="185.4,127 199.4,127 199.4,140.9 185.4,140.9 185.4,127"/>
  <polygon points="157.5,140.9 171.5,140.9 171.5,154.9 157.5,154.9 157.5,140.9"/>
  <polygon points="185.4,140.9 199.4,140.9 199.4,154.9 185.4,154.9 185.4,140.9"/>
  <polygon points="171.5,140.9 185.4,140.9 185.4,154.9 171.5,154.9 171.5,140.9"/>
</g>
<g id="ND" class="cartoState" name="North Dakota">
  <polygon points="115.9,99.1 129.8,99.1 129.8,113.1 115.9,113.1 115.9,99.1"/>
  <polygon points="129.8,99.1 143.8,99.1 143.8,113.1 129.8,113.1 129.8,99.1"/>
  <polygon points="143.8,99.1 157.7,99.1 157.7,113.1 143.8,113.1 143.8,99.1"/>
</g>
<g id="SD" class="cartoState" name="South Dakota">
  <polygon points="115.9,113.1 129.8,113.1 129.8,127.1 115.9,127.1 115.9,113.1"/>
  <polygon points="129.8,113.1 143.8,113.1 143.8,127.1 129.8,127.1 129.8,113.1"/>
  <polygon points="143.8,113.1 157.7,113.1 157.7,127.1 143.8,127.1 143.8,113.1"/>
</g>
<g id="NE" class="cartoState" name="Nebraska">
  <polygon points="115.9,127 129.8,127 129.8,141 115.9,141 115.9,127"/>
  <polygon points="129.9,141 143.9,141 143.9,154.9 129.9,154.9 129.9,141"/>
</g>
<g id="NE01" class="cartoState evcd" name="Nebraska">
  <polygon points="143.7,127 157.7,127 157.7,141 143.7,141 143.7,127"/>
</g>
<g id="NE02" class="cartoState evcd" name="Nebraska">
  <polygon points="129.9,127 143.8,127 143.8,141 129.9,141 129.9,127"/>
</g>
<g id="NE03" class="cartoState evcd" name="Nebraska">
  <polygon points="143.7,141 157.7,141 157.7,154.9 143.7,154.9 143.7,141"/>
</g>
<g id="IN" class="cartoState" name="Indiana">
  <polygon points="297.1,127.3 311.1,127.3 311.1,141.3 297.1,141.3 297.1,127.3"/>
  <polygon points="311.1,127.3 325,127.3 325,141.3 311.1,141.3 311.1,127.3"/>
  <polygon points="311.1,141.3 325,141.3 325,155.2 311.1,155.2 311.1,141.3"/>
  <polygon points="297.1,141.3 311.1,141.3 311.1,155.2 297.1,155.2 297.1,141.3"/>
  <polygon points="297.1,155.2 311.1,155.2 311.1,169.2 297.1,169.2 297.1,155.2"/>
  <polygon points="311.1,155.2 325,155.2 325,169.2 311.1,169.2 311.1,155.2"/>
  <polygon points="283.2,127.3 297.1,127.3 297.1,141.3 283.2,141.3 283.2,127.3"/>
  <polygon points="297.1,169.2 311.1,169.2 311.1,183.1 297.1,183.1 297.1,169.2"/>
  <polygon points="311.1,169.2 325,169.2 325,183.1 311.1,183.1 311.1,169.2"/>
  <polygon points="297.1,183.1 311.1,183.1 311.1,197.1 297.1,197.1 297.1,183.1"/>
  <polygon points="311.1,183.1 325,183.1 325,197.1 311.1,197.1 311.1,183.1"/>
</g>
<g id="IL" class="cartoState" name="Illinois">
  <polygon points="283,169.7 297,169.7 297,183.6 283,183.6 283,169.7"/>
  <polygon points="268.8,140.9 282.8,140.9 282.8,154.8 268.8,154.8 268.8,140.9"/>
  <polygon points="283,155.7 297,155.7 297,169.7 283,169.7 283,155.7"/>
  <polygon points="199.4,141.2 213.3,141.2 213.3,155.1 199.4,155.1 199.4,141.2"/>
  <polygon points="213.3,127.1 227.3,127.1 227.3,141.1 213.3,141.1 213.3,127.1"/>
  <polygon points="227.3,127.1 241.2,127.1 241.2,141.1 227.3,141.1 227.3,127.1"/>
  <polygon points="213.3,141.2 227.3,141.2 227.3,155.1 213.3,155.1 213.3,141.2"/>
  <polygon points="227.3,141.2 241.3,141.2 241.3,155.1 227.3,155.1 227.3,141.2"/>
  <polygon points="241.2,127.1 255.2,127.1 255.2,141.1 241.2,141.1 241.2,127.1"/>
  <polygon points="283.1,141.6 297.1,141.6 297.1,155.5 283.1,155.5 283.1,141.6"/>
  <polygon points="255.2,141.1 269.1,141.1 269.1,155 255.2,155 255.2,141.1"/>
  <polygon points="283,183.4 297,183.4 297,197.4 283,197.4 283,183.4"/>
  <polygon points="255.5,154.8 269.4,154.8 269.4,168.8 255.5,168.8 255.5,154.8"/>
  <polygon points="268.8,154.8 282.8,154.8 282.8,168.8 268.8,168.8 268.8,154.8"/>
  <polygon points="255.2,169.3 269.1,169.3 269.1,183.2 255.2,183.2 255.2,169.3"/>
  <polygon points="269.3,168.8 283.3,168.8 283.3,182.8 269.3,182.8 269.3,168.8"/>
  <polygon points="241.3,141.2 255.2,141.2 255.2,155.1 241.3,155.1 241.3,141.2"/>
  <polygon points="255.2,183.3 269.1,183.3 269.1,197.2 255.2,197.2 255.2,183.3"/>
  <polygon points="199.4,127.1 213.3,127.1 213.3,141.1 199.4,141.1 199.4,127.1"/>
  <polygon points="269.1,182.8 283.1,182.8 283.1,196.8 269.1,196.8 269.1,182.8"/>
</g>
<g id="MO" class="cartoState" name="Missouri">
  <polygon points="241.2,169.4 255.2,169.4 255.2,183.4 241.2,183.4 241.2,169.4"/>
  <polygon points="185.4,155.3 199.4,155.3 199.4,169.3 185.4,169.3 185.4,155.3"/>
  <polygon points="213.3,169.4 227.3,169.4 227.3,183.4 213.3,183.4 213.3,169.4"/>
  <polygon points="213.3,155.3 227.3,155.3 227.3,169.3 213.3,169.3 213.3,155.3"/>
  <polygon points="199.4,155.3 213.3,155.3 213.3,169.3 199.4,169.3 199.4,155.3"/>
  <polygon points="241.2,155.2 255.2,155.2 255.2,169.2 241.2,169.2 241.2,155.2"/>
  <polygon points="199.4,169.4 213.3,169.4 213.3,183.4 199.4,183.4 199.4,169.4"/>
  <polygon points="171.5,169.4 185.4,169.4 185.4,183.4 171.5,183.4 171.5,169.4"/>
  <polygon points="227.3,169.4 241.2,169.4 241.2,183.4 227.3,183.4 227.3,169.4"/>
  <polygon points="227.3,155.3 241.2,155.3 241.2,169.3 227.3,169.3 227.3,155.3"/>
  <polygon points="171.5,155.3 185.4,155.3 185.4,169.3 171.5,169.3 171.5,155.3"/>
  <polygon points="185.4,169.4 199.4,169.4 199.4,183.4 185.4,183.4 185.4,169.4"/>
</g>
<g id="KS" class="cartoState" name="Kansas">
  <polygon points="129.8,155.3 143.8,155.3 143.8,169.2 129.8,169.2 129.8,155.3"/>
  <polygon points="143.8,155.3 157.7,155.3 157.7,169.2 143.8,169.2 143.8,155.3"/>
  <polygon points="157.7,155.3 171.7,155.3 171.7,169.2 157.7,169.2 157.7,155.3"/>
  <polygon points="143.8,169.2 157.7,169.2 157.7,183.2 143.8,183.2 143.8,169.2"/>
  <polygon points="157.7,169.2 171.7,169.2 171.7,183.2 157.7,183.2 157.7,169.2"/>
  <polygon points="129.8,169.2 143.8,169.2 143.8,183.2 129.8,183.2 129.8,169.2"/>
</g>
<g id="WY" class="cartoState" name="Wyoming">
  <polygon points="74,127 88,127 88,141 74,141 74,127"/>
  <polygon points="88,127 101.9,127 101.9,141 88,141 88,127"/>
  <polygon points="101.9,127 115.9,127 115.9,141 101.9,141 101.9,127"/>
</g>
<g id="MT" class="cartoState" name="Montana">
  <polygon points="74,113.1 88,113.1 88,127 74,127 74,113.1"/>
  <polygon points="87.9,113.1 101.9,113.1 101.9,127 87.9,127 87.9,113.1"/>
  <polygon points="101.9,113.1 115.9,113.1 115.9,127 101.9,127 101.9,113.1"/>
</g>
<g id="CO" class="cartoState" name="Colorado">
  <polygon points="87.9,155.3 101.9,155.3 101.9,169.2 87.9,169.2 87.9,155.3"/>
  <polygon points="101.9,155.3 115.9,155.3 115.9,169.2 101.9,169.2 101.9,155.3"/>
  <polygon points="115.9,155.3 129.8,155.3 129.8,169.2 115.9,169.2 115.9,155.3"/>
  <polygon points="87.9,141.3 101.9,141.3 101.9,155.3 87.9,155.3 87.9,141.3"/>
  <polygon points="115.9,141.3 129.8,141.3 129.8,155.3 115.9,155.3 115.9,141.3"/>
  <polygon points="115.9,169.2 129.8,169.2 129.8,183.2 115.9,183.2 115.9,169.2"/>
  <polygon points="87.9,169.2 101.9,169.2 101.9,183.2 87.9,183.2 87.9,169.2"/>
  <polygon points="101.9,169.2 115.9,169.2 115.9,183.2 101.9,183.2 101.9,169.2"/>
  <polygon points="101.9,141.3 115.9,141.3 115.9,155.3 101.9,155.3 101.9,141.3"/>
</g>
<g id="UT" class="cartoState" name="Utah">
  <polygon points="60,183.2 74,183.2 74,197.2 60,197.2 60,183.2"/>
  <polygon points="74,155.3 87.9,155.3 87.9,169.3 74,169.3 74,155.3"/>
  <polygon points="74,183.2 87.9,183.2 87.9,197.2 74,197.2 74,183.2"/>
  <polygon points="60,155.3 74,155.3 74,169.3 60,169.3 60,155.3"/>
  <polygon points="60,169.3 74,169.3 74,183.2 60,183.2 60,169.3"/>
  <polygon points="74,169.3 87.9,169.3 87.9,183.2 74,183.2 74,169.3"/>
</g>
<g id="NV" class="cartoState" name="Nevada">
  <polygon points="74,211.5 87.9,211.5 87.9,225.5 74,225.5 74,211.5"/>
  <polygon points="60,225.5 74,225.5 74,239.4 60,239.4 60,225.5"/>
  <polygon points="74,225.5 87.9,225.5 87.9,239.4 74,239.4 74,225.5"/>
  <polygon points="60,211.5 74,211.5 74,225.5 60,225.5 60,211.5"/>
  <polygon points="74,197.5 87.9,197.5 87.9,211.5 74,211.5 74,197.5"/>
  <polygon points="60,197.5 74,197.5 74,211.5 60,211.5 60,197.5"/>
</g>
<g id="ID" class="cartoState" name="Idaho">
  <polygon points="60,113.1 74,113.1 74,127.1 60,127.1 60,113.1"/>
  <polygon points="60,127.1 74,127.1 74,141 60,141 60,127.1"/>
  <polygon points="60,141 74,141 74,155 60,155 60,141"/>
  <polygon points="74,141 87.9,141 87.9,155 74,155 74,141"/>
</g>
<g id="WA" class="cartoState" name="Washington">
  <polygon points="3.6,70.8 17.5,70.8 17.5,84.8 3.6,84.8 3.6,70.8"/>
  <polygon points="17.5,70.8 31.5,70.8 31.5,84.8 17.5,84.8 17.5,70.8"/>
  <polygon points="3.6,42.8 17.5,42.8 17.5,56.8 3.6,56.8 3.6,42.8"/>
  <polygon points="17.5,42.9 31.5,42.9 31.5,56.9 17.5,56.9 17.5,42.9"/>
  <polygon points="31.5,42.9 45.5,42.9 45.5,56.9 31.5,56.9 31.5,42.9"/>
  <polygon points="45.5,42.9 59.4,42.9 59.4,56.9 45.5,56.9 45.5,42.9"/>
  <polygon points="45.5,70.8 59.4,70.8 59.4,84.8 45.5,84.8 45.5,70.8"/>
  <polygon points="31.5,70.8 45.5,70.8 45.5,84.8 31.5,84.8 31.5,70.8"/>
  <polygon points="45.5,56.9 59.4,56.9 59.4,70.8 45.5,70.8 45.5,56.9"/>
  <polygon points="31.5,56.9 45.5,56.9 45.5,70.8 31.5,70.8 31.5,56.9"/>
  <polygon points="17.5,56.9 31.5,56.9 31.5,70.8 17.5,70.8 17.5,56.9"/>
  <polygon points="3.6,56.9 17.5,56.9 17.5,70.8 3.6,70.8 3.6,56.9"/>
</g>
<g id="OR" class="cartoState" name="Oregon">
  <polygon points="3.6,84.8 17.5,84.8 17.5,98.7 3.6,98.7 3.6,84.8"/>
  <polygon points="17.5,98.7 31.5,98.7 31.5,112.7 17.5,112.7 17.5,98.7"/>
  <polygon points="31.5,98.7 45.4,98.7 45.4,112.7 31.5,112.7 31.5,98.7"/>
  <polygon points="31.5,84.8 45.4,84.8 45.4,98.7 31.5,98.7 31.5,84.8"/>
  <polygon points="45.4,98.7 59.4,98.7 59.4,112.7 45.4,112.7 45.4,98.7"/>
  <polygon points="45.4,84.8 59.4,84.8 59.4,98.7 45.4,98.7 45.4,84.8"/>
  <polygon points="17.5,84.8 31.5,84.8 31.5,98.7 17.5,98.7 17.5,84.8"/>
</g>
<g id="CA" class="cartoState" name="California">
  <polygon points="3.6,113 17.5,113 17.5,126.9 3.6,126.9 3.6,113"/>
  <polygon points="17.5,113 31.5,113 31.5,126.9 17.5,126.9 17.5,113"/>
  <polygon points="31.5,113 45.4,113 45.4,126.9 31.5,126.9 31.5,113"/>
  <polygon points="45.4,113 59.4,113 59.4,126.9 45.4,126.9 45.4,113"/>
  <polygon points="3.6,126.9 17.5,126.9 17.5,140.9 3.6,140.9 3.6,126.9"/>
  <polygon points="17.5,126.9 31.5,126.9 31.5,140.9 17.5,140.9 17.5,126.9"/>
  <polygon points="31.5,126.9 45.4,126.9 45.4,140.9 31.5,140.9 31.5,126.9"/>
  <polygon points="45.4,126.9 59.4,126.9 59.4,140.9 45.4,140.9 45.4,126.9"/>
  <polygon points="3.6,140.9 17.5,140.9 17.5,154.9 3.6,154.9 3.6,140.9"/>
  <polygon points="17.5,140.9 31.5,140.9 31.5,154.9 17.5,154.9 17.5,140.9"/>
  <polygon points="31.5,140.9 45.4,140.9 45.4,154.9 31.5,154.9 31.5,140.9"/>
  <polygon points="45.4,140.9 59.4,140.9 59.4,154.9 45.4,154.9 45.4,140.9"/>
  <polygon points="3.6,154.8 17.5,154.8 17.5,168.8 3.6,168.8 3.6,154.8"/>
  <polygon points="17.5,154.8 31.5,154.8 31.5,168.8 17.5,168.8 17.5,154.8"/>
  <polygon points="31.5,154.8 45.4,154.8 45.4,168.8 31.5,168.8 31.5,154.8"/>
  <polygon points="45.4,154.8 59.4,154.8 59.4,168.8 45.4,168.8 45.4,154.8"/>
  <polygon points="3.6,168.8 17.5,168.8 17.5,182.7 3.6,182.7 3.6,168.8"/>
  <polygon points="17.5,168.8 31.5,168.8 31.5,182.7 17.5,182.7 17.5,168.8"/>
  <polygon points="31.5,168.8 45.4,168.8 45.4,182.7 31.5,182.7 31.5,168.8"/>
  <polygon points="45.4,168.8 59.4,168.8 59.4,182.7 45.4,182.7 45.4,168.8"/>
  <polygon points="17.5,252.7 31.5,252.7 31.5,266.6 17.5,266.6 17.5,252.7"/>
  <polygon points="31.5,252.7 45.5,252.7 45.5,266.6 31.5,266.6 31.5,252.7"/>
  <polygon points="45.4,252.7 59.4,252.7 59.4,266.6 45.4,266.6 45.4,252.7"/>
  <polygon points="17.5,294.5 31.4,294.5 31.4,308.5 17.5,308.5 17.5,294.5"/>
  <polygon points="17.5,266.6 31.5,266.6 31.5,280.6 17.5,280.6 17.5,266.6"/>
  <polygon points="31.5,266.6 45.5,266.6 45.5,280.6 31.5,280.6 31.5,266.6"/>
  <polygon points="45.4,266.6 59.4,266.6 59.4,280.6 45.4,280.6 45.4,266.6"/>
  <polygon points="31.4,294.5 45.4,294.5 45.4,308.5 31.4,308.5 31.4,294.5"/>
  <polygon points="3.6,182.8 17.5,182.8 17.5,196.7 3.6,196.7 3.6,182.8"/>
  <polygon points="17.5,182.8 31.5,182.8 31.5,196.7 17.5,196.7 17.5,182.8"/>
  <polygon points="31.5,182.8 45.4,182.8 45.4,196.7 31.5,196.7 31.5,182.8"/>
  <polygon points="45.4,182.8 59.4,182.8 59.4,196.7 45.4,196.7 45.4,182.8"/>
  <polygon points="3.5,280.6 17.5,280.6 17.5,294.5 3.5,294.5 3.5,280.6"/>
  <polygon points="3.6,196.8 17.5,196.8 17.5,210.8 3.6,210.8 3.6,196.8"/>
  <polygon points="17.5,196.8 31.5,196.8 31.5,210.8 17.5,210.8 17.5,196.8"/>
  <polygon points="31.5,196.8 45.4,196.8 45.4,210.8 31.5,210.8 31.5,196.8"/>
  <polygon points="45.4,196.8 59.4,196.8 59.4,210.8 45.4,210.8 45.4,196.8"/>
  <polygon points="17.5,280.6 31.5,280.6 31.5,294.5 17.5,294.5 17.5,280.6"/>
  <polygon points="3.6,210.7 17.5,210.7 17.5,224.7 3.6,224.7 3.6,210.7"/>
  <polygon points="17.5,210.7 31.5,210.7 31.5,224.7 17.5,224.7 17.5,210.7"/>
  <polygon points="31.5,210.7 45.4,210.7 45.4,224.7 31.5,224.7 31.5,210.7"/>
  <polygon points="45.4,210.7 59.4,210.7 59.4,224.7 45.4,224.7 45.4,210.7"/>
  <polygon points="31.4,280.6 45.4,280.6 45.4,294.5 31.4,294.5 31.4,280.6"/>
  <polygon points="3.6,224.8 17.5,224.8 17.5,238.7 3.6,238.7 3.6,224.8"/>
  <polygon points="17.5,224.8 31.5,224.8 31.5,238.7 17.5,238.7 17.5,224.8"/>
  <polygon points="31.5,224.8 45.4,224.8 45.4,238.7 31.5,238.7 31.5,224.8"/>
  <polygon points="45.4,224.8 59.4,224.8 59.4,238.7 45.4,238.7 45.4,224.8"/>
  <polygon points="45.4,280.6 59.4,280.6 59.4,294.5 45.4,294.5 45.4,280.6"/>
  <polygon points="3.6,266.6 17.5,266.6 17.5,280.6 3.6,280.6 3.6,266.6"/>
  <polygon points="3.6,238.7 17.5,238.7 17.5,252.7 3.6,252.7 3.6,238.7"/>
  <polygon points="17.5,238.7 31.5,238.7 31.5,252.7 17.5,252.7 17.5,238.7"/>
  <polygon points="31.5,238.7 45.4,238.7 45.4,252.7 31.5,252.7 31.5,238.7"/>
  <polygon points="45.4,238.7 59.4,238.7 59.4,252.7 45.4,252.7 45.4,238.7"/>
  <polygon points="45.4,294.5 59.4,294.5 59.4,308.5 45.4,308.5 45.4,294.5"/>
  <polygon points="3.6,252.7 17.5,252.7 17.5,266.6 3.6,266.6 3.6,252.7"/>
</g>
<g id="AZ" class="cartoState" name="Arizona">
  <polygon points="87.9,197.6 101.9,197.6 101.9,211.5 87.9,211.5 87.9,197.6"/>
  <polygon points="101.9,197.6 115.8,197.6 115.8,211.5 101.9,211.5 101.9,197.6"/>
  <polygon points="115.8,197.6 129.8,197.6 129.8,211.5 115.8,211.5 115.8,197.6"/>
  <polygon points="115.8,211.5 129.8,211.5 129.8,225.5 115.8,225.5 115.8,211.5"/>
  <polygon points="101.9,211.5 115.8,211.5 115.8,225.5 101.9,225.5 101.9,211.5"/>
  <polygon points="101.9,225.5 115.8,225.5 115.8,239.5 101.9,239.5 101.9,225.5"/>
  <polygon points="87.9,225.5 101.9,225.5 101.9,239.5 87.9,239.5 87.9,225.5"/>
  <polygon points="87.9,211.5 101.9,211.5 101.9,225.5 87.9,225.5 87.9,211.5"/>
  <polygon points="101.9,183.6 115.8,183.6 115.8,197.6 101.9,197.6 101.9,183.6"/>
  <polygon points="115.8,183.6 129.8,183.6 129.8,197.6 115.8,197.6 115.8,183.6"/>
  <polygon points="87.9,183.6 101.9,183.6 101.9,197.6 87.9,197.6 87.9,183.6"/>
</g>
<g id="NM" class="cartoState" name="New Mexico">
  <polygon points="129.7,211.5 143.7,211.5 143.7,225.5 129.7,225.5 129.7,211.5"/>
  <polygon points="143.7,197.6 157.6,197.6 157.6,211.5 143.7,211.5 143.7,197.6"/>
  <polygon points="129.7,197.6 143.7,197.6 143.7,211.5 129.7,211.5 129.7,197.6"/>
  <polygon points="143.7,183.6 157.6,183.6 157.6,197.6 143.7,197.6 143.7,183.6"/>
  <polygon points="129.7,183.6 143.7,183.6 143.7,197.6 129.7,197.6 129.7,183.6"/>
</g>
<g id="OK" class="cartoState" name="Oklahoma">
  <polygon points="171.6,183.5 185.5,183.5 185.5,197.5 171.6,197.5 171.6,183.5"/>
  <polygon points="185.5,183.5 199.5,183.5 199.5,197.5 185.5,197.5 185.5,183.5"/>
  <polygon points="199.5,183.5 213.4,183.5 213.4,197.5 199.5,197.5 199.5,183.5"/>
  <polygon points="199.5,197.5 213.4,197.5 213.4,211.4 199.5,211.4 199.5,197.5"/>
  <polygon points="157.6,183.5 171.5,183.5 171.5,197.5 157.6,197.5 157.6,183.5"/>
  <polygon points="171.6,197.5 185.5,197.5 185.5,211.4 171.6,211.4 171.6,197.5"/>
  <polygon points="185.5,197.5 199.5,197.5 199.5,211.4 185.5,211.4 185.5,197.5"/>
</g>
<g id="AR" class="cartoState" name="Arkansas">
  <polygon points="227.3,183.5 241.3,183.5 241.3,197.5 227.3,197.5 227.3,183.5"/>
  <polygon points="241.3,183.5 255.3,183.5 255.3,197.5 241.3,197.5 241.3,183.5"/>
  <polygon points="241.3,197.5 255.3,197.5 255.3,211.4 241.3,211.4 241.3,197.5"/>
  <polygon points="213.4,197.5 227.3,197.5 227.3,211.4 213.4,211.4 213.4,197.5"/>
  <polygon points="213.4,183.5 227.3,183.5 227.3,197.5 213.4,197.5 213.4,183.5"/>
  <polygon points="227.3,197.5 241.3,197.5 241.3,211.4 227.3,211.4 227.3,197.5"/>
</g>
<g id="TN" class="cartoState" name="Tennessee">
  <polygon points="283,225.4 297,225.4 297,239.4 283,239.4 283,225.4"/>
  <polygon points="311.1,224.9 325.1,224.9 325.1,238.9 311.1,238.9 311.1,224.9"/>
  <polygon points="325.1,224.9 339,224.9 339,238.9 325.1,238.9 325.1,224.9"/>
  <polygon points="339,224.9 353,224.9 353,238.9 339,238.9 339,224.9"/>
  <polygon points="311.1,211 325.1,211 325.1,224.9 311.1,224.9 311.1,211"/>
  <polygon points="269.3,197 283.2,197 283.2,211 269.3,211 269.3,197"/>
  <polygon points="297.2,211 311.1,211 311.1,224.9 297.2,224.9 297.2,211"/>
  <polygon points="283,211.4 297,211.4 297,225.4 283,225.4 283,211.4"/>
  <polygon points="297.2,224.9 311.1,224.9 311.1,238.9 297.2,238.9 297.2,224.9"/>
  <polygon points="255.2,197.2 269.2,197.2 269.2,211.1 255.2,211.1 255.2,197.2"/>
  <polygon points="269.3,211 283.2,211 283.2,224.9 269.3,224.9 269.3,211"/>
</g>
<g id="KY" class="cartoState" name="Kentucky">
  <polygon points="325,211.5 338.9,211.5 338.9,225.4 325,225.4 325,211.5"/>
  <polygon points="325,197.5 338.9,197.5 338.9,211.5 325,211.5 325,197.5"/>
  <polygon points="338.9,211.5 352.9,211.5 352.9,225.4 338.9,225.4 338.9,211.5"/>
  <polygon points="352.9,211.5 366.8,211.5 366.8,225.4 352.9,225.4 352.9,211.5"/>
  <polygon points="297.1,197.5 311,197.5 311,211.4 297.1,211.4 297.1,197.5"/>
  <polygon points="338.9,197.5 352.9,197.5 352.9,211.5 338.9,211.5 338.9,197.5"/>
  <polygon points="283,197.6 297,197.6 297,211.5 283,211.5 283,197.6"/>
  <polygon points="311,197.5 325,197.5 325,211.5 311,211.5 311,197.5"/>
</g>
<g id="VA"  class="cartoState" name="Virginia">
  <polygon points="436.7,196.9 450.6,196.9 450.6,210.9 436.7,210.9 436.7,196.9"/>
  <polygon points="408.7,196.7 422.7,196.7 422.7,210.7 408.7,210.7 408.7,196.7"/>
  <polygon points="366.9,183 380.8,183 380.8,197 366.9,197 366.9,183"/>
  <polygon points="352.9,196.9 366.8,196.9 366.8,210.9 352.9,210.9 352.9,196.9"/>
  <polygon points="380.8,196.7 394.8,196.7 394.8,210.7 380.8,210.7 380.8,196.7"/>
  <polygon points="380.8,210.9 394.8,210.9 394.8,224.8 380.8,224.8 380.8,210.9"/>
  <polygon points="366.8,196.7 380.8,196.7 380.8,210.7 366.8,210.7 366.8,196.7"/>
  <polygon points="422.7,196.9 436.7,196.9 436.7,210.9 422.7,210.9 422.7,196.9"/>
  <polygon points="394.8,196.7 408.8,196.7 408.8,210.7 394.8,210.7 394.8,196.7"/>
  <polygon points="394.8,210.9 408.7,210.9 408.7,224.8 394.8,224.8 394.8,210.9"/>
  <polygon points="422.7,210.9 436.7,210.9 436.7,224.8 422.7,224.8 422.7,210.9"/>
  <polygon points="436.7,210.9 450.6,210.9 450.6,224.8 436.7,224.8 436.7,210.9"/>
  <polygon points="408.8,210.5 422.7,210.5 422.7,224.5 408.8,224.5 408.8,210.5"/>
</g>
<g id="NC" class="cartoState" name="North Carolina">
  <polygon points="394.8,238.7 408.7,238.7 408.7,252.7 394.8,252.7 394.8,238.7"/>
  <polygon points="408.8,238.7 422.7,238.7 422.7,252.7 408.8,252.7 408.8,238.7"/>
  <polygon points="380.9,224.8 394.8,224.8 394.8,238.7 380.9,238.7 380.9,224.8"/>
  <polygon points="422.7,238.7 436.7,238.7 436.7,252.7 422.7,252.7 422.7,238.7"/>
  <polygon points="436.7,238.7 450.7,238.7 450.7,252.7 436.7,252.7 436.7,238.7"/>
  <polygon points="394.8,224.8 408.8,224.8 408.8,238.7 394.8,238.7 394.8,224.8"/>
  <polygon points="408.8,224.8 422.7,224.8 422.7,238.7 408.8,238.7 408.8,224.8"/>
  <polygon points="450.7,238.7 464.6,238.7 464.6,252.7 450.7,252.7 450.7,238.7"/>
  <polygon points="436.7,224.8 450.7,224.8 450.7,238.7 436.7,238.7 436.7,224.8"/>
  <polygon points="436.7,252.7 450.7,252.7 450.7,266.6 436.7,266.6 436.7,252.7"/>
  <polygon points="450.7,224.8 464.6,224.8 464.6,238.7 450.7,238.7 450.7,224.8"/>
  <polygon points="408.8,252.7 422.7,252.7 422.7,266.6 408.8,266.6 408.8,252.7"/>
  <polygon points="422.7,252.7 436.7,252.7 436.7,266.6 422.7,266.6 422.7,252.7"/>
  <polygon points="366.8,211 380.8,211 380.8,224.9 366.8,224.9 366.8,211"/>
  <polygon points="422.8,224.8 436.7,224.8 436.7,238.7 422.8,238.7 422.8,224.8"/>
</g>
<g id="DC" class="cartoState" name="District of Columbia">
  <polygon points="464.8,197 478.7,197 478.7,211 464.8,211 464.8,197"/>
  <polygon points="464.7,211 478.7,211 478.7,224.9 464.7,224.9 464.7,211"/>
  <polygon points="464.6,225.2 478.6,225.2 478.6,238.7 464.6,238.7 464.6,225.2"/>
</g>
<g id="AK" class="cartoState" name="Alaska">
  <polygon points="17.5,366.9 31.5,366.9 31.5,380.9 17.5,380.9 17.5,366.9"/>
  <polygon points="17.5,380.9 31.5,380.9 31.5,394.9 17.5,394.9 17.5,380.9"/>
  <polygon points="3.3,395.1 17.3,395.1 17.3,409 3.3,409 3.3,395.1"/>
</g>
<g id="HI" class="cartoState" name="Hawaii">
  <polygon points="60.8,366.8 74.8,366.8 74.8,380.8 60.8,380.8 60.8,366.8"/>
  <polygon points="74.7,380.8 88.7,380.8 88.7,394.7 74.7,394.7 74.7,380.8"/>
  <polygon points="88.8,395 102.8,395 102.8,408.9 88.8,408.9 88.8,395"/>
  <polygon points="102.8,395 116.7,395 116.7,408.9 102.8,408.9 102.8,395"/>
</g>
<g id="FL" class="cartoState" name="Florida">
  <polygon points="380.8,294.2 394.8,294.2 394.8,308.2 380.8,308.2 380.8,294.2"/>
  <polygon points="394.8,294.2 408.8,294.2 408.8,308.2 394.8,308.2 394.8,294.2"/>
  <polygon points="408.8,308.2 422.7,308.2 422.7,322.1 408.8,322.1 408.8,308.2"/>
  <polygon points="422.7,308.2 436.7,308.2 436.7,322.1 422.7,322.1 422.7,308.2"/>
  <polygon points="436.7,405.9 450.6,405.9 450.6,419.8 436.7,419.8 436.7,405.9"/>
  <polygon points="366.9,280.6 380.8,280.6 380.8,294.5 366.9,294.5 366.9,280.6"/>
  <polygon points="436.7,364 450.6,364 450.6,377.9 436.7,377.9 436.7,364"/>
  <polygon points="394.8,308.2 408.8,308.2 408.8,322.1 394.8,322.1 394.8,308.2"/>
  <polygon points="422.7,322.1 436.7,322.1 436.7,336.1 422.7,336.1 422.7,322.1"/>
  <polygon points="380.8,322.1 394.8,322.1 394.8,336.1 380.8,336.1 380.8,322.1"/>
  <polygon points="394.8,322.1 408.7,322.1 408.7,336.1 394.8,336.1 394.8,322.1"/>
  <polygon points="436.7,336.1 450.6,336.1 450.6,350 436.7,350 436.7,336.1"/>
  <polygon points="436.7,391.9 450.6,391.9 450.6,405.9 436.7,405.9 436.7,391.9"/>
  <polygon points="408.8,322.1 422.7,322.1 422.7,336.1 408.8,336.1 408.8,322.1"/>
  <polygon points="422.7,405.9 436.7,405.9 436.7,419.8 422.7,419.8 422.7,405.9"/>
  <polygon points="436.7,377.9 450.6,377.9 450.6,391.9 436.7,391.9 436.7,377.9"/>
  <polygon points="422.7,391.9 436.7,391.9 436.7,405.9 422.7,405.9 422.7,391.9"/>
  <polygon points="422.7,377.9 436.7,377.9 436.7,391.9 422.7,391.9 422.7,377.9"/>
  <polygon points="422.7,364 436.7,364 436.7,377.9 422.7,377.9 422.7,364"/>
  <polygon points="422.7,350 436.7,350 436.7,364 422.7,364 422.7,350"/>
  <polygon points="408.8,336.1 422.7,336.1 422.7,350 408.8,350 408.8,336.1"/>
  <polygon points="408.8,350 422.7,350 422.7,364 408.8,364 408.8,350"/>
  <polygon points="408.8,364 422.7,364 422.7,377.9 408.8,377.9 408.8,364"/>
  <polygon points="408.8,377.9 422.7,377.9 422.7,391.9 408.8,391.9 408.8,377.9"/>
  <polygon points="436.7,350 450.6,350 450.6,364 436.7,364 436.7,350"/>
  <polygon points="436.7,308.2 450.6,308.2 450.6,322.1 436.7,322.1 436.7,308.2"/>
  <polygon points="436.7,322.1 450.6,322.1 450.6,336.1 436.7,336.1 436.7,322.1"/>
  <polygon points="422.7,336.1 436.7,336.1 436.7,350 422.7,350 422.7,336.1"/>
  <polygon points="380.8,308.2 394.8,308.2 394.8,322.1 380.8,322.1 380.8,308.2"/>
</g>
<g id="SC" class="cartoState" name="South Carolina">
  <polygon points="422.7,293.8 436.7,293.8 436.7,307.8 422.7,307.8 422.7,293.8"/>
  <polygon points="436.7,279.9 450.7,279.9 450.7,293.8 436.7,293.8 436.7,279.9"/>
  <polygon points="436.7,265.9 450.7,265.9 450.7,279.9 436.7,279.9 436.7,265.9"/>
  <polygon points="408.8,279.9 422.7,279.9 422.7,293.8 408.8,293.8 408.8,279.9"/>
  <polygon points="408.8,293.8 422.7,293.8 422.7,307.8 408.8,307.8 408.8,293.8"/>
  <polygon points="436.7,293.8 450.7,293.8 450.7,307.8 436.7,307.8 436.7,293.8"/>
  <polygon points="422.7,279.9 436.7,279.9 436.7,293.8 422.7,293.8 422.7,279.9"/>
  <polygon points="408.8,265.9 422.7,265.9 422.7,279.9 408.8,279.9 408.8,265.9"/>
  <polygon points="422.7,265.9 436.7,265.9 436.7,279.9 422.7,279.9 422.7,265.9"/>
</g>
<g id="GA" class="cartoState" name="Georgia">
  <polygon points="352.9,238.7 366.9,238.7 366.9,252.7 352.9,252.7 352.9,238.7"/>
  <polygon points="366.9,225 380.8,225 380.8,238.9 366.9,238.9 366.9,225"/>
  <polygon points="380.8,238.7 394.8,238.7 394.8,252.7 380.8,252.7 380.8,238.7"/>
  <polygon points="352.9,224.8 366.8,224.8 366.8,238.7 352.9,238.7 352.9,224.8"/>
  <polygon points="352.9,252.7 366.9,252.7 366.9,266.6 352.9,266.6 352.9,252.7"/>
  <polygon points="366.9,238.7 380.8,238.7 380.8,252.7 366.9,252.7 366.9,238.7"/>
  <polygon points="380.8,252.7 394.8,252.7 394.8,266.6 380.8,266.6 380.8,252.7"/>
  <polygon points="380.8,280.6 394.8,280.6 394.8,294.5 380.8,294.5 380.8,280.6"/>
  <polygon points="394.8,280.6 408.7,280.6 408.7,294.5 394.8,294.5 394.8,280.6"/>
  <polygon points="394.8,266.6 408.7,266.6 408.7,280.6 394.8,280.6 394.8,266.6"/>
  <polygon points="394.8,252.7 408.7,252.7 408.7,266.6 394.8,266.6 394.8,252.7"/>
  <polygon points="352.9,280.6 366.9,280.6 366.9,294.5 352.9,294.5 352.9,280.6"/>
  <polygon points="366.9,266.6 380.8,266.6 380.8,280.6 366.9,280.6 366.9,266.6"/>
  <polygon points="380.8,266.6 394.8,266.6 394.8,280.6 380.8,280.6 380.8,266.6"/>
  <polygon points="352.9,266.6 366.9,266.6 366.9,280.6 352.9,280.6 352.9,266.6"/>
  <polygon points="366.8,252.7 380.8,252.7 380.8,266.6 366.8,266.6 366.8,252.7"/>
</g>
<g id="AL" class="cartoState" name="Alabama">
  <polygon points="311,253.3 325,253.3 325,267.2 311,267.2 311,253.3"/>
  <polygon points="325,253.3 339,253.3 339,267.2 325,267.2 325,253.3"/>
  <polygon points="311,239.3 325,239.3 325,253.3 311,253.3 311,239.3"/>
  <polygon points="325,239.3 339,239.3 339,253.3 325,253.3 325,239.3"/>
  <polygon points="325,267.3 339,267.3 339,281.2 325,281.2 325,267.3"/>
  <polygon points="311,267.3 325,267.3 325,281.2 311,281.2 311,267.3"/>
  <polygon points="338.9,253.3 352.9,253.3 352.9,267.2 338.9,267.2 338.9,253.3"/>
  <polygon points="338.9,239.3 352.9,239.3 352.9,253.3 338.9,253.3 338.9,239.3"/>
  <polygon points="338.9,267.3 352.9,267.3 352.9,281.2 338.9,281.2 338.9,267.3"/>
</g>
<g id="MS" class="cartoState" name="Mississippi">
  <polygon points="283.1,253.3 297.1,253.3 297.1,267.2 283.1,267.2 283.1,253.3"/>
  <polygon points="297.1,267.3 311,267.3 311,281.3 297.1,281.3 297.1,267.3"/>
  <polygon points="297.1,239.4 311,239.4 311,253.3 297.1,253.3 297.1,239.4"/>
  <polygon points="283,239.4 297,239.4 297,253.4 283,253.4 283,239.4"/>
  <polygon points="283.2,267.3 297.1,267.3 297.1,281.3 283.2,281.3 283.2,267.3"/>
  <polygon points="297.1,253.3 311,253.3 311,267.3 297.1,267.3 297.1,253.3"/>
</g>
<g id="LA" class="cartoState" name="Louisiana">
  <polygon points="255.2,225.4 269.1,225.4 269.1,239.4 255.2,239.4 255.2,225.4"/>
  <polygon points="269.2,253.4 283.1,253.4 283.1,267.3 269.2,267.3 269.2,253.4"/>
  <polygon points="255.2,253.4 269.1,253.4 269.1,267.3 255.2,267.3 255.2,253.4"/>
  <polygon points="255.2,239.4 269.1,239.4 269.1,253.4 255.2,253.4 255.2,239.4"/>
  <polygon points="269.2,267.3 283.1,267.3 283.1,281.3 269.2,281.3 269.2,267.3"/>
  <polygon points="269.2,225.4 283.1,225.4 283.1,239.4 269.2,239.4 269.2,225.4"/>
  <polygon points="269.2,239.4 283.1,239.4 283.1,253.4 269.2,253.4 269.2,239.4"/>
  <polygon points="255.2,211.5 269.1,211.5 269.1,225.4 255.2,225.4 255.2,211.5"/>
</g>
<g id="TX" class="cartoState" name="Texas">
  <polygon points="213.3,295.2 227.3,295.2 227.3,309.2 213.3,309.2 213.3,295.2"/>
  <polygon points="157.6,211.5 171.5,211.5 171.5,225.4 157.6,225.4 157.6,211.5"/>
  <polygon points="129.8,225.5 143.7,225.5 143.7,239.5 129.8,239.5 129.8,225.5"/>
  <polygon points="143.6,239.4 157.6,239.4 157.6,253.4 143.6,253.4 143.6,239.4"/>
  <polygon points="171.5,211.5 185.5,211.5 185.5,225.4 171.5,225.4 171.5,211.5"/>
  <polygon points="185.5,211.5 199.4,211.5 199.4,225.4 185.5,225.4 185.5,211.5"/>
  <polygon points="199.4,211.5 213.4,211.5 213.4,225.4 199.4,225.4 199.4,211.5"/>
  <polygon points="213.4,281.3 227.3,281.3 227.3,295.2 213.4,295.2 213.4,281.3"/>
  <polygon points="171.5,225.4 185.5,225.4 185.5,239.4 171.5,239.4 171.5,225.4"/>
  <polygon points="185.5,225.4 199.4,225.4 199.4,239.4 185.5,239.4 185.5,225.4"/>
  <polygon points="199.4,225.4 213.4,225.4 213.4,239.4 199.4,239.4 199.4,225.4"/>
  <polygon points="213.4,225.4 227.3,225.4 227.3,239.4 213.4,239.4 213.4,225.4"/>
  <polygon points="227.3,225.4 241.3,225.4 241.3,239.4 227.3,239.4 227.3,225.4"/>
  <polygon points="241.3,225.4 255.3,225.4 255.3,239.4 241.3,239.4 241.3,225.4"/>
  <polygon points="199.4,281.3 213.4,281.3 213.4,295.2 199.4,295.2 199.4,281.3"/>
  <polygon points="199.4,267.3 213.4,267.3 213.4,281.3 199.4,281.3 199.4,267.3"/>
  <polygon points="185.5,267.3 199.4,267.3 199.4,281.3 185.5,281.3 185.5,267.3"/>
  <polygon points="157.6,225.4 171.5,225.4 171.5,239.4 157.6,239.4 157.6,225.4"/>
  <polygon points="171.5,239.4 185.5,239.4 185.5,253.4 171.5,253.4 171.5,239.4"/>
  <polygon points="185.5,239.4 199.4,239.4 199.4,253.4 185.5,253.4 185.5,239.4"/>
  <polygon points="199.4,239.4 213.4,239.4 213.4,253.4 199.4,253.4 199.4,239.4"/>
  <polygon points="213.4,239.4 227.3,239.4 227.3,253.4 213.4,253.4 213.4,239.4"/>
  <polygon points="227.3,239.4 241.3,239.4 241.3,253.4 227.3,253.4 227.3,239.4"/>
  <polygon points="241.3,239.4 255.3,239.4 255.3,253.4 241.3,253.4 241.3,239.4"/>
  <polygon points="213.4,211.5 227.3,211.5 227.3,225.4 213.4,225.4 213.4,211.5"/>
  <polygon points="157.6,253.4 171.5,253.4 171.5,267.3 157.6,267.3 157.6,253.4"/>
  <polygon points="143.6,225.4 157.6,225.4 157.6,239.4 143.6,239.4 143.6,225.4"/>
  <polygon points="241.3,211.5 255.3,211.5 255.3,225.4 241.3,225.4 241.3,211.5"/>
  <polygon points="157.6,239.4 171.5,239.4 171.5,253.4 157.6,253.4 157.6,239.4"/>
  <polygon points="171.5,253.4 185.5,253.4 185.5,267.3 171.5,267.3 171.5,253.4"/>
  <polygon points="185.5,253.4 199.4,253.4 199.4,267.3 185.5,267.3 185.5,253.4"/>
  <polygon points="199.4,253.4 213.4,253.4 213.4,267.3 199.4,267.3 199.4,253.4"/>
  <polygon points="213.4,253.4 227.3,253.4 227.3,267.3 213.4,267.3 213.4,253.4"/>
  <polygon points="227.3,253.4 241.3,253.4 241.3,267.3 227.3,267.3 227.3,253.4"/>
  <polygon points="227.3,211.5 241.3,211.5 241.3,225.4 227.3,225.4 227.3,211.5"/>
  <polygon points="157.6,197.5 171.5,197.5 171.5,211.4 157.6,211.4 157.6,197.5"/>
  <polygon points="213.4,267.3 227.3,267.3 227.3,281.3 213.4,281.3 213.4,267.3"/>
  <polygon points="143.6,211.5 157.6,211.5 157.6,225.4 143.6,225.4 143.6,211.5"/>
</g>
<g id="labels">
</g>
<g>
  <text transform="matrix(1 0 0 1 396.9173 150.5309)" class="st0 st1">PA</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 452.2379 25.7795)" class="st0 st1">ME</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 480.798 53.4083)" class="st0 st1">NH</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 453.1977 53.4085)" class="st0 st1">VT</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 494.293 80.9006)" class="st0 st1">MA</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 510.0966 122.13)" class="st0 st1">RI</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 466.6976 122.1302)" class="st0 st1">CT</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 424.2637 95.0965)" class="st0 st1">NY</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 508.3321 191.931)" class="st0 st1">NJ</text>
</g>
<g>
<text transform="matrix(1 0 0 1 480.7983 178.6126)" class="st0 st1">DE</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 424.2699 178.9657)" class="st0 st1">MD</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 381.2359 179.1963)" class="st0 st1">WV</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 339.9442 164.4353)" class="st0 st1">OH</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 299.4641 108.2007)" class="st0 st1">MI</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 201.7703 108.7479)" class="st0 st1">WI</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 173.003 108.6608)" class="st0 st1">MN</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 174.9721 137.43)" class="st0 st1">IA</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 131.8757 108.9115)" class="st0 st1">ND</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 132.0879 123.1076)" class="st0 st1">SD</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 131.4365 136.8233)" class="st0 st1">NE</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 300.4641 165.2686)" class="st0 st1">IN</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 259.4822 151.8234)" class="st0 st1">IL</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 200.2506 178.9658)" class="st0 st1">MO</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 132.197 179.1965)" class="st0 st1">KS</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 89.0612 137.0633)" class="st0 st1">WY</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 89.5615 123.0602)" class="st0 st1">MT</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 102.8962 164.7906)" class="st0 st1">CO</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 61.9595 178.9661)" class="st0 st1">UT</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 61.9593 220.7859)" class="st0 st1">NV</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 63.4911 137.0631)" class="st0 st1">ID</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 18.317 66.844)" class="st0 st1">WA</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 18.2707 108.867)" class="st0 st1">OR</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 19.0208 207.3411)" class="st0 st1">CA</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 104.2765 207.7442)" class="st0 st1">AZ</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 130.9834 207.7442)" class="st0 st1">NM</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 173.4127 195.0671)" class="st0 st1">OK</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 228.8825 205.3846)" class="st0 st1">AR</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 299.4889 222.2232)" class="st0 st1">TN</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 327.1002 208.3978)" class="st0 st1">KY</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 396.917 221.6602)" class="st0 st1">VA</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 424.27 248.2614)" class="st0 st1">NC</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 465.4243 220.786)" class="st0 st1">DC</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 19.021 360.5347)" class="st0 st1">AK</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 104.2767 389.3983)" class="st0 st1">HI</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 419.3057 360.5347)" class="st0 st1">FL</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 424.2701 289.5551)" class="st0 st1">SC</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 368.2039 262.479)" class="st0 st1">GA</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 327.1001 262.9278)" class="st0 st1">AL</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 284.7047 248.4093)" class="st0 st1">MS</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 257.1083 248.2613)" class="st0 st1">LA</text>
</g>
<g>
  <text transform="matrix(1 0 0 1 187.7681 248.4095)" class="st0 st1">TX</text>
</g>
</svg></div></div>
<!-- <div id="mapStates" class="hideIT"><svg id="USSTATES" width="800" height="600" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid"></svg></div> -->
</div>
</div> <!-- end presidential stuff -->

<!-- SENATE PANES: WE DON'T EVEN HAVE THESE RACES -->
<div id="senate" class="dataviz">
<small class="footnote">Notes: Two independent senators caucus with Democrats. In Louisiana's Senate race, there's a run-off on Dec. 10 nobody received a majority vote</small>
<div class="mapBox">
<div id="mapSen" class="map geo"><svg id="USSENATE" width="800" height="600" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid"></svg>
<div class="sideStates"><div class="block stateBlock VT" name="Vermont" ab="VTs">VT</div><div class="block stateBlock NH" name="New Hampshire" ab="NHs">NH</div><div class="block stateBlock CT" name="Connecticut" ab="CTs">CT</div><div class="block stateBlock MD" name="Maryland" ab="MDs">MD</div></div>
</div>
</div>
</div> <!-- end senate stuff -->

<!-- GOVERNORS PANES: FOR THOSE LONGING FOR THEIR NORTH DAKOTAN HOME -->
<div id="governors" class="dataviz">
<div class="mapBox">
<small class="footnote">Note: Alaska has an independent governor</small>
<div id="mapGov" class="map geo"><svg id="USGOV" width="800" height="600" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid"></svg>
<div class="sideStates"><div class="block stateBlock VT" name="Vermont" ab="VTg">VT</div><div class="block stateBlock NH" name="New Hampshire" ab="NHg">NH</div><div class="block stateBlock DE" name="Delaware" ab="DEg">DE</div></div>
</div>
</div>
</div> <!-- end govenors stuff -->

<!-- HOUSE PANES: CALIFORNIA AND LOUISANA HAVE A SPECIAL PLACE IN CONGRESSIONAL HELL -->
<div id="house" class="dataviz">
<div class="mapBox">
<div id="mapHouse" class="map geo"><svg id="USHOUSE" width="800" height="600" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid"></svg></div>
<div id="cartoHouse" class="map normal carto"><svg width="800" height="600" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid"></svg></div>
<!-- <div id="mapMN" class="map geo"><svg id="USHOUSEMN" width="800" height="600" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid"></svg></div> -->
</div>
</div> <!-- end house stuff -->

<!-- MNHOUSE PANES: WHAT MINNPOST READERS TRULY CARE ABOUT -->
<div id="mnhouse" class="dataviz">
<small class="footnote">Note: Some candidates are running unopposed</small>
<div class="mapBox">
      <div class="mapState map geo"><svg id="MNHOUSE" width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
      <div class="mapMetro map geo metroMap"><svg id="MNHOUSEMETRO" width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
      <div class="cartoState map normal carto"><svg width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
      <div class="cartoMetro map normal carto"><svg width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
</div>
</div> <!-- end mnhouse stuff -->

<!-- MNSENATE PANES: ON YEARS THAT END IN SIX SENATORIAL WINNERS ALSO GET A LIVE PONY -->
<div id="mnsenate" class="dataviz">
<small class="footnote">Note: Some candidates are running unopposed</small>
<div class="mapBox">
      <div class="mapState map geo"><svg id="MNSENATE" width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
      <div class="mapMetro map geo metroMap"><svg id="MNSENATEMETRO" width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
      <div class="cartoState map normal carto"><svg width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
      <div class="cartoMetro map normal carto"><svg width="320" height="350" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid"></svg></div>
</div>
</div> <!-- end mnsenate stuff -->

<!-- CONTEXT TO UNRAVEL THE MYSTERY OF WHAT RED AND BLUE COULD POSSIBLY MEAN ON THE MAPS -->
<div id="rightSide">

<!-- COLOR SCALE LEGENDS: CAN'T HAVE TOO MANY OF THESE -->
<div id="legends"> 
<div id="legendMargins" class="legendBlock">
  <div class='partyBlock'>
    <div class='dparty legendLabel'>Clinton</div>
    <div class='dlean brick'></div>
    <div class='democrat brick'></div>
    <div class="tinybreak"></div>
    <div class="legendLabel mobileKill"></div>
    <div class='brick smallLabel'>50%</div>
    <div class='brick smallLabel'>70%</div>  
  </div>
  <div class='partyBlock'>
    <div class='rparty legendLabel'>Trump</div>
    <div class='rlean brick'></div>
    <div class='republican brick'></div>
    <div class="tinybreak"></div>
    <div class="legendLabel mobileKill"></div>
    <div class='brick smallLabel'>50%</div>
    <div class='brick smallLabel'>70%</div>   
  </div>
  <div class='partyBlock'>
    <div class='iparty legendLabel'>IND</div>
    <div class='green2 brick'></div>
    <div class='green4 brick'></div>
    <div class="tinybreak"></div>
    <div class="legendLabel mobileKill"></div>
    <div class='brick smallLabel'>50%</div>
    <div class='brick smallLabel'>70%</div>   
  </div>
<!--     <div class="breaker"></div> -->
<!--     <div class='partyBlock'>
    <div class='dparty legendLabel'>DEM</div>
    <div class='d4 brick'></div>
    <div class='d3 brick'></div>
    <div class='d2 brick'></div>
    <div class='d1 brick'></div>
    <div class="tinybreak"></div>
    <div class='legendLabel'></div>
    <div class='brick smallLabel'>80%</div> 
    <div class='brick smallLabel'>70%</div> 
    <div class='brick smallLabel'>60%</div> 
    <div class='brick smallLabel'>50%</div>
  </div>
  <div class='partyBlock'>
    <div class='green4 brick'></div>
    <div class='r1 brick'></div>
    <div class='r2 brick'></div>
    <div class='r3 brick'></div>
    <div class='r4 brick'></div>
    <div class='rparty legendLabel'>GOP</div>
    <div class="tinybreak"></div>
    <div class='brick smallLabel'>IND</div>
    <div class='brick smallLabel'>50%</div>
    <div class='brick smallLabel'>60%</div> 
    <div class='brick smallLabel'>70%</div>
    <div class='brick smallLabel'>80%</div>
    <div class='legendLabel'></div>
  </div> -->
</div>

<div id="legendWinners" class="legendBlock">
<!--   <div class="breaker"></div> -->
  <div class='partyBlock'>
    <div class='dparty legendLabel'>Clinton</div>
    <div class='dlean brick'></div>
    <div class='democrat brick'></div>
    <div class="tinybreak"></div>
    <div class="legendLabel mobileKill"></div>
    <div class='brick smallLabel'>Lean</div>
    <div class='brick smallLabel'>Win</div>  
  </div>
  <div class='partyBlock'>
    <div class='rparty legendLabel'>Trump</div>
    <div class='rlean brick'></div>
    <div class='republican brick'></div>
    <div class="tinybreak"></div>
    <div class="legendLabel mobileKill"></div>
    <div class='brick smallLabel'>Lean</div>
    <div class='brick smallLabel'>Win</div>   
  </div>
  <div class='partyBlock'>
    <div class='iparty legendLabel'>IND</div>
    <div class='green2 brick'></div>
    <div class='green4 brick'></div>
    <div class="tinybreak"></div>
    <div class="legendLabel mobileKill"></div>
    <div class='brick smallLabel'>Lean</div>
    <div class='brick smallLabel'>Win</div>   
  </div>
</div>
</div>

<div class="zoom">Reset</div>

</div>

<div class="breaker mobileHide"></div>

<!-- WHERE THE VERY HELPFUL TABLES LIVE -->
<div class="table" id="table">
<div id="infobox"></div>
<div class="filter"><input type="search" class="filter_box" placeholder="Search races by location or candidate"></div>
<div id="allResults">
    <div class='president bigBoard'></div>
    <div class='house bigBoard'></div>
    <div class='senate bigBoard'></div>
    <div class='governors bigBoard'></div>
    <div class='mnhouse bigBoard'></div>
    <div class='mnsenate bigBoard'></div>
</div>
</div> <!-- end table -->

</div>
<!-- end datavizPane -->
</div>
<!-- end fulldataviz -->

</div>
<!-- end wrapper -->

<!-- FALLBACK CONTAINER IN CASE THIS ELECTION SOMEHOW GETS WORSE -->
<div id="fallback">
</div>
<!-- end fallback -->

</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src="//d3js.org/topojson.v1.min.js"></script>

<script>
var thisView = "us";

//D3 CLICKY MAP BINDINGS
jQuery.fn.d3Click = function () {
  this.each(function (i, e) {
    var evt = document.createEvent("MouseEvents");
    evt.initMouseEvent("click", true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);

    e.dispatchEvent(evt);
    return false;
  });
};

jQuery.fn.d3Down = function () {
  this.each(function (i, e) {
    var evt = document.createEvent("MouseEvents");
    evt.initMouseEvent("mousedown", true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);

    e.dispatchEvent(evt);
    return false;
  });
};

jQuery.fn.d3Up = function () {
  this.each(function (i, e) {
    var evt = document.createEvent("MouseEvents");
    evt.initMouseEvent("mouseup", true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);

    e.dispatchEvent(evt);
    return false;
  });
};

//WE HAVE A BINARY POLITICAL PARTY SYSTEM UNTIL YOU HAVE TO CRUNCH NUMBERS ON ELECTION NIGHT
function fetchData(district,state,type,dataCompare,race,ev,label,evcd){

//initialize top level variables 
var stateName = '';
var statePostal = '';
var precinctsReporting = 0;
var precinctsTotal = 0;
var precinctsReportingPct = 0;
var lastUpdated = 0;

var fipsCode = '';
var seatName = '';
var seatNum = '';

var voteCountT = 0;

//initialize candidate arrays
var first = [];
var last = [];
var party = [];
var incumbent = [];
var voteCount = [];
var winner = [];

//initialize sorting array
var sortAll = [];

//run through data and assign variables to candidate arrays
  for (var i=0; i < dataCompare.races.length; i++) {
   if (race == "ushouse" || race == "mnhouse" || race == "mnsenate"){
    if (district == "District 0"){
      if (dataCompare.races[i].seatName == "District 1") {
     for (var j=0; j < dataCompare.races[i].reportingUnits.length; j++) {
         if (dataCompare.races[i].reportingUnits[j].stateName == state){
              stateName = dataCompare.races[i].reportingUnits[j].stateName;
              statePostal = dataCompare.races[i].reportingUnits[j].statePostal;
              precinctsReporting = dataCompare.races[i].reportingUnits[j].precinctsReporting;
              precinctsTotal = dataCompare.races[i].reportingUnits[j].precinctsTotal;
              precinctsReportingPct = dataCompare.races[i].reportingUnits[j].precinctsReportingPct;
              lastUpdated = dataCompare.races[i].reportingUnits[j].lastUpdated;

           for (var k=0; k < dataCompare.races[i].reportingUnits[j].candidates.length; k++) {
              first[k] = dataCompare.races[i].reportingUnits[j].candidates[k].first;
              last[k] = dataCompare.races[i].reportingUnits[j].candidates[k].last;
              party[k] = dataCompare.races[i].reportingUnits[j].candidates[k].party;
              incumbent[k] = dataCompare.races[i].reportingUnits[j].candidates[k].incumbent;
              voteCount[k] = dataCompare.races[i].reportingUnits[j].candidates[k].voteCount;
              winner[k] = dataCompare.races[i].reportingUnits[j].candidates[k].winner; 
           } //end k loop
         } //end if
     } //end j loop
    } //end if
}
     else {
        if (dataCompare.races[i].seatName == district) {
     for (var j=0; j < dataCompare.races[i].reportingUnits.length; j++) {
         if (dataCompare.races[i].reportingUnits[j].stateName == state){
              stateName = dataCompare.races[i].reportingUnits[j].stateName;
              statePostal = dataCompare.races[i].reportingUnits[j].statePostal;
              precinctsReporting = dataCompare.races[i].reportingUnits[j].precinctsReporting;
              precinctsTotal = dataCompare.races[i].reportingUnits[j].precinctsTotal;
              precinctsReportingPct = dataCompare.races[i].reportingUnits[j].precinctsReportingPct;
              lastUpdated = dataCompare.races[i].reportingUnits[j].lastUpdated;

           for (var k=0; k < dataCompare.races[i].reportingUnits[j].candidates.length; k++) {
              first[k] = dataCompare.races[i].reportingUnits[j].candidates[k].first;
              last[k] = dataCompare.races[i].reportingUnits[j].candidates[k].last;
              party[k] = dataCompare.races[i].reportingUnits[j].candidates[k].party;
              incumbent[k] = dataCompare.races[i].reportingUnits[j].candidates[k].incumbent;
              voteCount[k] = dataCompare.races[i].reportingUnits[j].candidates[k].voteCount;
              winner[k] = dataCompare.races[i].reportingUnits[j].candidates[k].winner;
           } //end k loop
         } //end if
     } //end j loop
    } //end if
     }
   } else {
     for (var j=0; j < dataCompare.races[i].reportingUnits.length; j++) {
       if (state != null && evcd != null) {
         if (dataCompare.races[i].reportingUnits[j].statePostal == state && dataCompare.races[i].reportingUnits[j].reportingunitName == evcd){
              stateName = dataCompare.races[i].reportingUnits[j].stateName;
              statePostal = dataCompare.races[i].reportingUnits[j].statePostal;
              precinctsReporting = dataCompare.races[i].reportingUnits[j].precinctsReporting;
              precinctsTotal = dataCompare.races[i].reportingUnits[j].precinctsTotal;
              precinctsReportingPct = dataCompare.races[i].reportingUnits[j].precinctsReportingPct;
              lastUpdated = dataCompare.races[i].reportingUnits[j].lastUpdated;

           for (var k=0; k < dataCompare.races[i].reportingUnits[j].candidates.length; k++) { 
              first[k] = dataCompare.races[i].reportingUnits[j].candidates[k].first;
              last[k] = dataCompare.races[i].reportingUnits[j].candidates[k].last;
              party[k] = dataCompare.races[i].reportingUnits[j].candidates[k].party;
              incumbent[k] = dataCompare.races[i].reportingUnits[j].candidates[k].incumbent;
              voteCount[k] = dataCompare.races[i].reportingUnits[j].candidates[k].voteCount;
              winner[k] = dataCompare.races[i].reportingUnits[j].candidates[k].winner;
           } //end k loop
         }
      } else if (state != null){
         if (dataCompare.races[i].reportingUnits[j].stateName == state){
              stateName = dataCompare.races[i].reportingUnits[j].stateName;
              statePostal = dataCompare.races[i].reportingUnits[j].statePostal;
              precinctsReporting = dataCompare.races[i].reportingUnits[j].precinctsReporting;
              precinctsTotal = dataCompare.races[i].reportingUnits[j].precinctsTotal;
              precinctsReportingPct = dataCompare.races[i].reportingUnits[j].precinctsReportingPct;
              lastUpdated = dataCompare.races[i].reportingUnits[j].lastUpdated;

           for (var k=0; k < dataCompare.races[i].reportingUnits[j].candidates.length; k++) { 
              first[k] = dataCompare.races[i].reportingUnits[j].candidates[k].first;
              last[k] = dataCompare.races[i].reportingUnits[j].candidates[k].last;
              party[k] = dataCompare.races[i].reportingUnits[j].candidates[k].party;
              incumbent[k] = dataCompare.races[i].reportingUnits[j].candidates[k].incumbent;
              voteCount[k] = dataCompare.races[i].reportingUnits[j].candidates[k].voteCount;
              winner[k] = dataCompare.races[i].reportingUnits[j].candidates[k].winner;
           } //end k loop
         }
      } else if (district != null) {
         if (dataCompare.races[i].reportingUnits[j].fipsCode == district){
              stateName = dataCompare.races[i].reportingUnits[j].stateName;
              statePostal = dataCompare.races[i].reportingUnits[j].statePostal;
              precinctsReporting = dataCompare.races[i].reportingUnits[j].precinctsReporting;
              precinctsTotal = dataCompare.races[i].reportingUnits[j].precinctsTotal;
              precinctsReportingPct = dataCompare.races[i].reportingUnits[j].precinctsReportingPct;
              lastUpdated = dataCompare.races[i].reportingUnits[j].lastUpdated;

           for (var k=0; k < dataCompare.races[i].reportingUnits[j].candidates.length; k++) { 
              first[k] = dataCompare.races[i].reportingUnits[j].candidates[k].first;
              last[k] = dataCompare.races[i].reportingUnits[j].candidates[k].last;
              party[k] = dataCompare.races[i].reportingUnits[j].candidates[k].party;
              incumbent[k] = dataCompare.races[i].reportingUnits[j].candidates[k].incumbent;
              voteCount[k] = dataCompare.races[i].reportingUnits[j].candidates[k].voteCount;
              winner[k] = dataCompare.races[i].reportingUnits[j].candidates[k].winner;
           } //end k loop
         }
      } 
     } //end j loop
   }
} //end i loop

//sort arrays by vountCount
for (var i = 0; i < voteCount.length; i++) {
    sortAll.push({ 'first': first[i], 'last': last[i], 'party': party[i], 'incumbent': incumbent[i], 'voteCount': voteCount[i], 'winner': winner[i] });
}

sortAll.sort(function(a, b) {
  return b.voteCount - a.voteCount;
});

first = [];
last = [];
party = [];
incumbent = [];
voteCount = [];
winner = [];

for (var i = 0; i < sortAll.length; i++) {
   first.push(sortAll[i].first);
   last.push(sortAll[i].last);
   party.push(sortAll[i].party);
   incumbent.push(sortAll[i].incumbent);
   voteCount.push(sortAll[i].voteCount);
   winner.push(sortAll[i].winner);
} 


//initialize and calculate some miscellaneous variables for printing results
for (var i=0; i < voteCount.length; i++){
  voteCountT += voteCount[i];
}

var topPCT = voteCount[0] / voteCountT;

var evString = "";
if (ev != null) { evString = "<span class='ev'> - " + ev + " electoral votes</span>"; }

var stateString = state;
if (label != null) { stateString = label + ", " + statePostal; } else { stateString = state; }

var iMark = [];
for (var i = 0; i < incumbent.length; i++) {
if (incumbent[i] == true) { iMark[i] = "*"; }
else { iMark[i] = ""; }
}

var wMark = [];
for (var i = 0; i < last.length; i++) {
if (winner[i] == "X") { wMark[i] = "&#x2714;"; }
else if (winner[i] == "R") { wMark[i] = "-R"; }
else { wMark[i] = ""; }
}

var colors = [];
for (var i=0; i < last.length; i++){
  var thisPCT = voteCount[i] / voteCountT;
    if (party[i] == "GOP"){
      if (thisPCT >= .80) { colors[i] = "#d84c27"; } 
      else if (thisPCT >= .70) { colors[i] = "#df6a4c"; } 
      else if (thisPCT >= .60) { colors[i] = "#e58970"; } 
      else if (thisPCT >= 0) { colors[i] = "#eca795"; } 
    }
    else if (party[i] == "Dem") { 
      if (thisPCT >= .80) { colors[i] = "#2b7ab5"; } 
      else if (thisPCT >= .70) { colors[i] = "#4f90c1"; } 
      else if (thisPCT >= .60) { colors[i] = "#73a7ce"; } 
      else if (thisPCT >= 0) { colors[i] = "#97bedb"; } 
    }
    else if (thisPCT > 0) { colors[i] = "#299E3D"; }
    else { colors[i] = "#bbbbbb"; }
}


//return precincts
if (type == "pct"){ return precinctsReportingPct; }

//return timestamp
if (type == "timestamp"){ return lastUpdated; }

//return all votes
if (type == "votesT"){ return voteCountT; }

//return dem votes
if (type == "votesD"){
    for (var i = 0; i < last.length; i++) {
    if (party[i] == "Dem") { return voteCount[i]; }
    }
}

//return gop votes
if (type == "votesR"){
    for (var i = 0; i < last.length; i++) {
    if (party[i] == "GOP") { return voteCount[i]; }
    }
}

//return winner
if (type == "winner"){
    if (winner[0] == "X" && party[0] == "GOP"){ return "GOP Win"; }
    else if (winner[0] == "X" && party[0] == "Dem"){ return "DEM Win"; }
    else if (winner[0] == "X") { return "IND Win"; }
}

//return lean
if (type == "lean"){
    if (winner[0] == "X" && party[0] == "GOP"){ return "#d34A44"; }
    else if (winner[0] == "X" && party[0] == "Dem"){ return "#3585BC"; }
    else if (winner[0] == "X") { return "#299E3D"; }
    else if (party[0] == "GOP") { return "#f7816E"; }
    else if (party[0] == "Dem") { return "#72A9D6"; }
    else if (voteCount[0] == 0) { return "#bbbbbb"; } 
    else { return "#bbbbbb"; } 
}

//return color
if (type == "colors"){ return colors[0]; }

//return tooltips
if (type == "tooltip"){
  var tooltipString = "<div class='districtName'>" + stateString + "</div>";
  if (last.length < 2) { var howMany = last.length; }
  else { var howMany = 2; }

  for (var i = 0; i < howMany; i++) {
    var thisPCT = "0%";
    if (voteCountT > 0) { thisPCT = d3.format("%")(voteCount[i] / voteCountT); }
    tooltipString += "<div class='candidate'>" + iMark[i] + last[i] + " " + wMark[i] + "</div><div class='pct' style='background-color:" + colors[i] + "'>" + thisPCT + "</div><div class='smallbreak'>"
  }

  return tooltipString;
}

//return tables
if (type == "table"){
  var stateColor = "";
  if (last.length < 3) { var howMany = last.length; }
  else { var howMany = 3; }

  var tableString = "<div class='districtName'>" + stateString + " " + evString + "</div><div class='resultsRow'><div class='resultsHead'>Candidate</div><div class='counts resultsHead'>#</div><div class='pct resultsHead'>%</div></div>";

  for (var i = 0; i < howMany; i++) {
    var thisPCT = "0%";
    if (voteCountT > 0) { thisPCT = d3.format(".1%")(voteCount[i] / voteCountT); }

    stateColor = ""

    if (winner[i] == "X" && party[i] == "GOP") { stateColor = "republican"; }
    else if (winner[i] == "X" && party[i] == "Dem") { stateColor = "democrat"; }
    else if (winner[i] == "X") { stateColor = "green4"; }

    tableString += "<div class='resultsRow'><div class='candidate'>" + iMark[i] + first[i] + " " + last[i] + " (" + party[i] + ")" + " " + wMark[i] + "</div><div class='counts'>" + d3.format(",")(voteCount[i]) + "</div><div class='pct " + stateColor + "' style='border:2px solid " + colors[i] + ";'>" + thisPCT + "</div></div>"
  }

  return tableString + "<div class='reportingRow'><span class='pctReported'>" + precinctsReporting + "</span> / <span class='pctAll'>" + precinctsTotal + "</span> (" + precinctsReportingPct + "%) precincts reporting</div>";
}

//return boards
if (type == "board"){
var pct1 = "0%";
var pct2 = "0%";
var color1 = "";
var color2 = "";
var candidate1 = first[0] + " " + last[0];
var candidate2 = first[1] + " " + last[1];
var stateColor1 = "";
var stateColor2 = "";
var dTest = false;

  for (var i = 0; i < 2; i++) {
    if (party[i] == "Dem" && pct1 == "0%"){
        pct1 = d3.format("%")(voteCount[i] / voteCountT); 
        color1 = colors[i];
        if (winner[i] == "X") { stateColor1 = "democrat"; }
    }
    else if (party[i] == "Dem" && pct1 != "0%"){
        pct2 = d3.format("%")(voteCount[i] / voteCountT); 
        color2 = colors[i];
        if (winner[i] == "X") { stateColor2 = "democrat"; }
    }
    else if (party[i] == "GOP" && pct2 == "0%"){
        pct2 = d3.format("%")(voteCount[i] / voteCountT); 
        color2 = colors[i];
        if (winner[i] == "X") { stateColor2 = "republican"; }
    }
    else if (party[i] == "GOP" && pct2 != "0%"){
        pct1 = d3.format("%")(voteCount[i] / voteCountT); 
        color1 = colors[i];
        if (winner[i] == "X") { stateColor1 = "republican"; }
    }
  }

    if (voteCountT == 0) { pct1 = "0%"; pct2 = "0%"; }

    if (race == "president" && evcd != null){
    return "<div id='evcd" + label + "' class='tableRow evcd' name='" + label + "'><div class='stateBlockR'>" + label + "</div><div class='pctBox'>" + ev + "</div><div class='pctBox " + stateColor1 + "' style='border:2px solid " + color1 + ";'>" + pct1 + "</div><div class='pctBox " + stateColor2 + "' style='border:2px solid " + color2 + ";'>" + pct2 + "</div><div class='pctBox reporting'>" + precinctsReportingPct + "%</div><div class='searchTerms'>" + stateName + " " + candidate1 + " " + candidate2 +  "</div></div>";
    }

    if (race == "president"){
    return "<div class='tableRow' name='" + statePostal + "'><div class='stateBlockR'>" + statePostal + "</div><div class='pctBox'>" + ev + "</div><div class='pctBox " + stateColor1 + "' style='border:2px solid " + color1 + ";'>" + pct1 + "</div><div class='pctBox " + stateColor2 + "' style='border:2px solid " + color2 + ";'>" + pct2 + "</div><div class='pctBox reporting'>" + precinctsReportingPct + "%</div><div class='searchTerms'>" + stateName + " " + candidate1 + " " + candidate2 +  "</div></div>";
    }

    if (race == "senate" || race == "governors"){
    return "<div class='tableRow' name='" + statePostal + "'><div class='stateBlockR'>" + statePostal + "</div><div class='pctBox " + stateColor1 + "' style='border:2px solid " + color1 + ";'>" + pct1 + "</div><div class='pctBox " + stateColor2 + "' style='border:2px solid " + color2 + ";'>" + pct2 + "</div><div class='pctBox reporting'>" + precinctsReportingPct + "%</div><div class='searchTerms'>" + stateName + " " + candidate1 + " " + candidate2 +  "</div></div>";
    }

    if (race == "mnhouse" || race == "mnsenate"){
    return "<div class='tableRow' name='" + label + "'><div class='stateBlockR'>" + label + "</div><div class='pctBox " + stateColor1 + "' style='border:2px solid " + color1 + ";'>" + pct1 + "</div><div class='pctBox " + stateColor2 + "' style='border:2px solid " + color2 + ";'>" + pct2 + "</div><div class='pctBox reporting'>" + precinctsReportingPct + "%</div><div class='searchTerms'>" + stateName + " " + candidate1 + " " + candidate2 +  "</div></div>";
    }

    if (race == "ushouse"){
    return "<div class='tableRow' name='Minnesota" + label + "'><div class='stateBlockR'>MN" + label + "</div><div class='pctBox " + stateColor1 + "' style='border:2px solid " + color1 + ";'>" + pct1 + "</div><div class='pctBox " + stateColor2 + "' style='border:2px solid " + color2 + ";'>" + pct2 + "</div><div class='pctBox reporting'>" + precinctsReportingPct + "%</div><div class='searchTerms'>" + stateName + " " + candidate1 + " " + candidate2 +  "</div></div>";
    }
  }

} //end fetchData

//UPDATE INFOBOXES
function spillInfo(data){
 $("#infobox").html(data);
} //end spillInfo

//CARTOGRAM DATA UPDATE
function electoralCarto(data){
    $('.cartoState').each(function(i, obj) {
        var color = fetchData($(this).attr("name"),$(this).attr("name"),"lean",data,"president");
        $(this).attr("fill", color);
    });
} //end electoralCarto

//US HOUSE CARTOGRAM
function houseCarto(data){
(function(){
    var margin = {top: 3, left: 10, bottom: 40, right: 10}
    , width = 800
    // , width = width - margin.left - margin.right
    , mapRatio = .5
    , height = 600;

    var projection = d3.geo.equirectangular()
              .scale(width/1.1)//this makes it larger or smaller for the space you have
              .translate([width / 4, height / 2.5])
              .center([-102, 40 ]); //move the map center to fit in the spsace

    var path = d3.geo.path()
          .projection(projection);

    var svg = d3.select("#cartoHouse svg")
          .attr("width", width)
          .attr("height", height);

    var g = svg.append("g").attr('transform',"translate(150,25)").attr('class','house-group-g');

    makeCartogram();

function makeCartogram() {
        d3.json("shapefiles/usdistricts_cartogram.json", function(error, us) {

            g.append("g").attr("id", "districts").selectAll("path")
            .data(topojson.feature(us, us.objects['cart113']).features)
            .enter().append("path")
                .attr("d", path)
                .attr("class","cd")
                .attr("fill", function(d){
                    var color = fetchData("District " + d.properties['d'],d.properties.State,"lean",data,"ushouse",null,"District " + d.properties['d']);
                    return color;
                })
                .attr('id',function(d){ return d.properties.State + '' + d.properties['d'] + "c"; })
                .attr('data-hash-key',function(d){ return d.properties.State + '-' + d.properties['d']; })
                .on("mousedown", function(d, i){
                    d3.selectAll(".cd").classed("active",false);
                    d3.select(this).classed("active",true);
                    $(".tableRow").removeClass("selectedBox");
                    if (d.properties.State == "Minnesota") { $(".tableRow[name=" + d.properties.State + "" + d.properties['d'] + "]").addClass("selectedBox"); }
                    spillInfo(fetchData("District " + d.properties['d'],d.properties.State,"table",data,"ushouse",null,"District " + d.properties['d']));
                })
                .call(d3.helper.tooltip(function(d, i){
                    if ($(window).width() > 500) { 
                    return fetchData("District " + d.properties['d'],d.properties.State,"tooltip",data,"ushouse",null,"District " + d.properties['d']);
                } else { $(".tooltip").hide(); }}));
        })
    }
})();

d3.helper = {};

d3.helper.tooltip = function(accessor){
    return function(selection){
        var tooltipDiv;
        var bodyNode = d3.select('body').node();
        selection.on("mouseover", function(d, i){
            // Clean up lost tooltips
            d3.select('body').selectAll('div.tooltip').remove();
            // Append tooltip
            tooltipDiv = d3.select('body').append('div').attr('class', 'tooltip');
            var absoluteMousePos = d3.mouse(bodyNode);
            tooltipDiv.style('left', (absoluteMousePos[0] - 160)+'px')
                .style('top', (absoluteMousePos[1] - 15)+'px')
                .style('position', 'absolute')
                .style('z-index', 1001);
            // Add text using the accessor function
            var tooltipText = accessor(d, i) || '';
            // Crop text arbitrarily
            //tooltipDiv.style('width', function(d, i){return (tooltipText.length > 80) ? '300px' : null;})
            //    .html(tooltipText);
        })
        .on('mousemove', function(d, i) {
            // Move tooltip
            var absoluteMousePos = d3.mouse(bodyNode);
            tooltipDiv.style('left', (absoluteMousePos[0] - 160)+'px')
                .style('top', (absoluteMousePos[1] - 15)+'px');
            var tooltipText = accessor(d, i) || '';
            tooltipDiv.html(tooltipText);
        })
        .on("mouseout", function(d, i){
            // Remove tooltip
            tooltipDiv.remove();
        });

    };
};

var aspect = 800 / 600, chart = $("#cartoHouse svg"); //, chart2 = $(".carto svg")
  var targetWidth = chart.parent().width();
  chart.attr("width", targetWidth);
  chart.attr("height", targetWidth / aspect);

$(window).on("resize", function() {
  if ($(window).width() >= 970) { $("#mobmenu").hide(); }
  chart.attr("style","");
  $("#cartogram svg").attr("style","");
  var targetWidth = chart.parent().width();
  chart.attr("width", targetWidth);
  chart.attr("height", targetWidth / aspect);
});

} //end houseCarto

//ALL OTHER MAPS
function mapBuild(container, boxContainer, chartContainer, shape, race, geo, level, dataCompare, index, visible) {

if (geo=="us") { var width = 800, height = 600, centered; var projection = d3.geo.albersUsa().scale(1000).translate([400, 210]); }
else if (geo=="mn") { var width = 400, height = 400, centered; var projection = d3.geo.mercator().scale([3200]).center([-89.736328,46.377254]); }
else if (geo=="metro") { var width = 400, height = 400, centered; var projection = d3.geo.mercator().scale([16500]).center([-92.403259,44.988113]); }

var path = d3.geo.path()
    .projection(projection);

var svg = d3.select(container + " svg")
    .attr("width", width)
    .attr("height", height);

var g = svg.append("g").attr("class", "mappage states " + race + " " + level);

d3.json("shapefiles/" + shape, function(error, us) {

  g.selectAll("path")
      .data(us.features)
    .enter().append("path")
      .attr("d", path)
      .on("click", clicked)
      .attr("precinctName", function(d){ return d.properties.NAME })
      .style("fill", function(d){
         if (race == "president") { 
        $('#president .sideStates .block').each(function(i, obj) {
            if ($(this).hasClass(d.properties.STUSPS)){
            var color = fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race);
            $(this).css("background-color", color);
            }
        });
            return fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race); 
         }
         if (race == "senate") { 
        $('#senate .sideStates .block').each(function(i, obj) {
            if ($(this).hasClass(d.properties.STUSPS)){
            var color = fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race);
            $(this).css("background-color", color);
            }
        });
            return fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race); 
         }
         if (race == "governors") { 
        $('#governors .sideStates .block').each(function(i, obj) {
            if ($(this).hasClass(d.properties.STUSPS)){
            var color = fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race);
            $(this).css("background-color", color);
            }
        });
            return fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race); 
         }
         else if (race == "county") { return fetchData(d.properties.GEOID,null,"colors",dataCompare,race); }
         // else if (race == "pct") { return mapColor(d.properties.PCTCODE, race, dataCompare); }
         else if (race == "house") { return fetchData("District " + d.properties.DISTRICT,d.properties.STATENAME,"lean",dataCompare,"ushouse",null,"District " + d.properties.DISTRICT); $(".tableRow").removeClass("selectedBox"); if (d.properties.STATENAME == "Minnesota") { $(".tableRow[name=" + d.properties.STATENAME + "" + d.properties.DISTRICT + "]").addClass("selectedBox"); } }
         else if (race == "mnsenate" || race == "mnhouse") { return fetchData("District " + d.properties.DISTRICT,"Minnesota","lean",dataCompare,race,null,"District " + d.properties.DISTRICT); }
        })
       .on("mousedown", function(d, i){

        var str = d.properties.NAME; 
        $(".district").removeClass("selected");
        $(".tableRow").removeClass("selectedBox");
        $(".tableRow[name=" + d.properties.STUSPS + "]").addClass("selectedBox");
        $(".tableRow[name=" + d.properties.DISTRICT + "]").addClass("selectedBox");
        if (race == "president" || race == "senate" ||  race == "governors"){ 
            spillInfo(fetchData(d.properties.NAME,d.properties.NAME,"table",dataCompare,race)); $(".block").removeClass("blockSelect"); $("." + d.properties.STUSPS).addClass("blockSelect"); }
        else if (race == "county"){ spillInfo(fetchData(d.properties.GEOID,null,"table",dataCompare,race,null,d.properties.NAME)); }
        else if (race == "house"){ spillInfo(fetchData("District " + d.properties.DISTRICT,d.properties.STATENAME,"table",dataCompare,"ushouse",null,"District " + d.properties.DISTRICT)); if (d.properties.STATENAME == "Minnesota") { $(".tableRow[name=" + d.properties.STATENAME + "" + d.properties.DISTRICT + "]").addClass("selectedBox"); } } 
        else if (race == "mnsenate" || race == "mnhouse") { 
          if (d.properties.DISTRICT == "32B") { return spillInfo("<div class='districtName'>District 32B, MN</div><div>No race. A special election has been called for Feb. 14, 2017.</div>"); }
          else { spillInfo(fetchData("District " + d.properties.DISTRICT,"Minnesota","table",dataCompare,race,null,"District " + d.properties.DISTRICT)); } 
        }

       })
      .style("stroke-width", "0.3px")
      .style("stroke", "#fff")
      .attr("id",function(d){ 
        if (race == "president"){ return d.properties.STUSPS; }
        else if (race == "senate"){ return d.properties.STUSPS + "s"; }
        else if (race == "governors"){ return d.properties.STUSPS + "g"; }
        else if (race == "mnsenate"){ return "mns" + d.properties.DISTRICT; }
        else if (race == "mnhouse"){ return "mnh" + d.properties.DISTRICT; }
        else if (race == "house"){ return d.properties.STATENAME + "" + d.properties.DISTRICT; }
        else { return null; }
      })
      .attr("class",function(d){
          if (race == "president"){ return "district " + d.properties.STUSPS; }
          if (race == "senate"){ 
            if (d.properties.NAME == "Montana" || d.properties.NAME == "Wyoming" || d.properties.NAME == "Nebraska" || d.properties.NAME == "Minnesota" || d.properties.NAME == "New Mexico" || d.properties.NAME == "Texas" || d.properties.NAME == "Mississippi" || d.properties.NAME == "Tennessee" || d.properties.NAME == "West Virginia" || d.properties.NAME == "Virginia" || d.properties.NAME == "New Jersey" || d.properties.NAME == "Delaware" || d.properties.NAME == "Rhode Island" || d.properties.NAME == "Massachusetts" || d.properties.NAME == "Maine" || d.properties.NAME == "Michigan"){
                return "noclicky  district " + d.properties.STUSPS;
            }
          }
          if (race == "governors"){ 
            if (d.properties.NAME != "Washington" && d.properties.NAME != "Oregon" && d.properties.NAME != "Montana" && d.properties.NAME != "Utah" && d.properties.NAME != "Missouri" && d.properties.NAME != "Montana" && d.properties.NAME != "Montana" && d.properties.NAME != "Montana" && d.properties.NAME != "West Virginia" && d.properties.NAME != "North Carolina" && d.properties.NAME != "Delaware" && d.properties.NAME != "New Hampshire" && d.properties.NAME != "Vermont" && d.properties.NAME != "Indiana" && d.properties.NAME != "North Dakota"){
                return "noclicky district " + d.properties.STUSPS;
            }
          }
          if (race == "county"){ 
            if (d.properties.STATEFP == 27){
              if (d.properties.NAME == "Hennepin" || d.properties.NAME == "Ramsey" || d.properties.NAME == "Washington" || d.properties.NAME == "Carver" || d.properties.NAME == "Scott" || d.properties.NAME == "Dakota" || d.properties.NAME == "Anoka") { return "mn metro"; }
              else { return "mn"; }  
            } else if (d.properties.STATEFP == 2){
              return "noclicky district";
            }
            else { return "areas district"; }
          }
          if (race == "house"){ 
            if (d.properties.STATENAME == "Minnesota"){ return "mn"; }
            else { return "areas district"; }
          }
      })
      .call(d3.helper.tooltip(function(d, i){
        if ($(window).width() > 500) { 
         if (race == "president" || race == "senate" || race == "governors") { return fetchData(d.properties.NAME,d.properties.NAME,"tooltip",dataCompare,race); }
         else if (race == "county") { return fetchData(d.properties.GEOID,null,"tooltip",dataCompare,race,null,d.properties.NAME); }
         // else if (race == "pct") { return mapTips(d, race, dataCompare, level); }
         else if (race == "house") { return fetchData("District " + d.properties.DISTRICT,d.properties.STATENAME,"tooltip",dataCompare,"ushouse",null,"District " + d.properties.DISTRICT); }
         else if (race == "mnsenate" || race == "mnhouse") { 
          if (d.properties.DISTRICT == "32B") { return "<div class='districtName'>District 32B, MN</div><div>No race</div>"; }
          else { return fetchData("District " + d.properties.DISTRICT,"Minnesota","tooltip",dataCompare,race,null,"District " + d.properties.DISTRICT); }
        }
      } else { $(".tooltip").hide(); }}))

if (race == "president" || race == "senate" ||  race == "governors"){
    g.selectAll("text")
    .data(us.features)
    .enter()
    .append("text")
    .attr("fill", "white")
    .style("font-weight",900)
    .attr("class","passthrough")
    .attr("transform", function(d) { 
        var centroid = path.centroid(d);
        var x = centroid[0];
        var y = centroid[1];

        if (d.properties.STUSPS == "FL") { x = x + 11; }
        if (d.properties.STUSPS == "MI") { x = x + 9; y = y + 18; }
        if (d.properties.STUSPS == "AK") { y = y - 4; }
        if (d.properties.STUSPS == "LA") { x = x - 8; y = y - 4; }
        return "translate(" + x + "," + y + ")";
    })
    .attr("text-anchor", "middle")
    .attr("dy", ".35em")
    .text(function(d) {
        if (race == "president") { 
            if (d.properties.STUSPS != "MA" && d.properties.STUSPS != "RI" && d.properties.STUSPS != "CT" && d.properties.STUSPS != "DE" && d.properties.STUSPS != "DC" && d.properties.STUSPS != "MD" && d.properties.STUSPS != "NH" && d.properties.STUSPS != "VT" && d.properties.STUSPS != "NJ") { return d.properties.STUSPS; }
        }
        if (race == "senate") { 
            if (d.properties.STUSPS != "MA" && d.properties.STUSPS != "RI" && d.properties.STUSPS != "CT" && d.properties.STUSPS != "DE" && d.properties.STUSPS != "DC" && d.properties.STUSPS != "MD" && d.properties.STUSPS != "NH" && d.properties.STUSPS != "VT" && d.properties.STUSPS != "NJ" && d.properties.STUSPS != "MT" && d.properties.STUSPS != "WY" && d.properties.STUSPS != "NE" && d.properties.STUSPS != "NM" && d.properties.STUSPS != "TX" && d.properties.STUSPS != "MN" && d.properties.STUSPS != "MI" && d.properties.STUSPS != "MS" && d.properties.STUSPS != "TN" && d.properties.STUSPS != "WV" && d.properties.STUSPS != "VA" && d.properties.STUSPS != "ME") { return d.properties.STUSPS; }
        }
        if (race == "governors") { 
            if (d.properties.STUSPS != "OH" && d.properties.STUSPS != "MI" && d.properties.STUSPS != "AZ" && d.properties.STUSPS != "ME" && d.properties.STUSPS != "NY" && d.properties.STUSPS != "PA" && d.properties.STUSPS != "VA" && d.properties.STUSPS != "FL" && d.properties.STUSPS != "SC" && d.properties.STUSPS != "GA" && d.properties.STUSPS != "MS" && d.properties.STUSPS != "AL" && d.properties.STUSPS != "KY" && d.properties.STUSPS != "TN" && d.properties.STUSPS != "WI" && d.properties.STUSPS != "IL" && d.properties.STUSPS != "AR" && d.properties.STUSPS != "LA" && d.properties.STUSPS != "MN" && d.properties.STUSPS != "IA" && d.properties.STUSPS != "TX" && d.properties.STUSPS != "KS" && d.properties.STUSPS != "OK" && d.properties.STUSPS != "SD" && d.properties.STUSPS != "NE" && d.properties.STUSPS != "NM" && d.properties.STUSPS != "CO" && d.properties.STUSPS != "ID" && d.properties.STUSPS != "WY" && d.properties.STUSPS != "CA" && d.properties.STUSPS != "NV" && d.properties.STUSPS != "AK" && d.properties.STUSPS != "HI" && d.properties.STUSPS != "MA" && d.properties.STUSPS != "RI" && d.properties.STUSPS != "CT" && d.properties.STUSPS != "DE" && d.properties.STUSPS != "DC" && d.properties.STUSPS != "MD" && d.properties.STUSPS != "NH" && d.properties.STUSPS != "VT" && d.properties.STUSPS != "NJ") { return d.properties.STUSPS; }
        }
    });
}

  g.append("path")
      //.datum(topojson.mesh(us, us.features, function(a, b) { return a !== b; }))
      .attr("class", "state-borders")
      .attr("d", path);

});

var zoom = d3.behavior.zoom()
    .on("zoom",function() {
        g.attr("transform","translate("+
            d3.event.translate.join(",")+")scale("+d3.event.scale+")");
        g.selectAll("circle")
            .attr("d", path.projection(projection));
        g.selectAll("path")
            .attr("d", path.projection(projection));

  });

$(".zoom").click(function() {
  g.selectAll("." + race + " path")
      .classed("faded", false)
      .classed("active", false);
});

$(".uszoom").on("mousedown",function() {
    clicked2();
    d3.selectAll(".areas").classed("gone", false);
    d3.selectAll(".mn").classed("gone", false);
    d3.selectAll(".metro").classed("gone", false);
});

$(".mnzoom").on("mousedown",function() {
    mnzoom();
    d3.selectAll(".areas").classed("gone", true);
    d3.selectAll(".mn").classed("gone", false);
});

$(".metrozoom").on("mousedown",function() {
    metrozoom();
    d3.selectAll(".areas").classed("gone", true);
    d3.selectAll(".mn").classed("gone", true);
    d3.selectAll(".metro").classed("gone", false);
});

function clicked(d) {
  var x, y, k;

  if (d && centered !== d) {
    var centroid = path.centroid(d);
    x = centroid[0];
    y = centroid[1];
    k = 3;
    centered = d;
  } else {
    x = width / 2;
    y = height / 2;
    k = 3;
    centered = null;
  }

  g.selectAll("." + race + " path")
      .classed("faded", true)
      .classed("active", centered && function(d) { return d === centered; });

  // g.transition()
  //     .duration(200)
  //     .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")scale(" + k + ")translate(" + -x + "," + -y + ")")
      // .style("stroke-width", 1.5 / k + "px");

  // g.selectAll("path").style("stroke-width", "0.3px");
}

function mnzoom(d) {
  var x, y, k;

    var centroid = path.centroid(d);
    x = 429.8542649319006;
    y = 90.27472769218944;
    k = 5;

  g.transition()
      .duration(200)
      .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")scale(" + k + ")translate(" + -x + "," + -y + ")")
      .style("stroke-width", "0");

  g.selectAll("path").style("stroke-width", "0.3px");
}

function metrozoom(d) {
  var x, y, k;

    var centroid = path.centroid(d);
    x = 439.8542649319006;
    y = 103.27472769218944;
    k = 25;

  g.transition()
      .duration(200)
      .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")scale(" + k + ")translate(" + -x + "," + -y + ")")
      .style("stroke-width", "0");

  g.selectAll("path").style("stroke-width", "0.1px");
}

function clicked2(d) {
  var x, y, k;

  if (d && centered !== d) {
    var centroid = path.centroid(d);
    x = centroid[0];
    y = centroid[1];
    k = 1;
    centered = d;
  } else {
    x = width / 2;
    y = height / 2;
    k = 1;
    centered = null;
  }

  g.selectAll("." + race + " path")
      .classed("faded", false)
      .classed("active", centered && function(d) { return d === centered; });

  g.transition()
      .duration(200)
      .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")scale(" + k + ")translate(" + -x + "," + -y + ")")
      .style("stroke-width","0.5px");

  g.selectAll("path").style("stroke-width", ".5px");
}

d3.helper = {};

d3.helper.tooltip = function(accessor){
    return function(selection){
        var tooltipDiv;
        var bodyNode = d3.select('body').node();
        selection.on("mouseover", function(d, i){
            // Clean up lost tooltips
            d3.select('body').selectAll('div.tooltip').remove();
            // Append tooltip
            tooltipDiv = d3.select('body').append('div').attr('class', 'tooltip');
            var absoluteMousePos = d3.mouse(bodyNode);
            tooltipDiv.style('left', (absoluteMousePos[0] - 160)+'px')
                .style('top', (absoluteMousePos[1] - 15)+'px')
                .style('position', 'absolute')
                .style('z-index', 1001);
            // Add text using the accessor function
            var tooltipText = accessor(d, i) || '';
            // Crop text arbitrarily
            //tooltipDiv.style('width', function(d, i){return (tooltipText.length > 80) ? '300px' : null;})
            //    .html(tooltipText);
        })
        .on('mousemove', function(d, i) {
            // Move tooltip
            var absoluteMousePos = d3.mouse(bodyNode);
            tooltipDiv.style('left', (absoluteMousePos[0] - 160)+'px')
                .style('top', (absoluteMousePos[1] - 15)+'px');
            var tooltipText = accessor(d, i) || '';
            tooltipDiv.html(tooltipText);
        })
        .on("mouseout", function(d, i){
            // Remove tooltip
            tooltipDiv.remove();
        });

    };
};

var aspect = 800 / 600, chart = $(container + " svg"); //, chart2 = $(".carto svg")
$(document).ready(function() {
  var targetWidth = chart.parent().width();
  chart.attr("width", targetWidth);
  chart.attr("height", targetWidth / aspect);
});
$(window).on("resize", function() {
  if ($(window).width() >= 970) { $("#mobmenu").hide(); }
  chart.attr("style","");
  var targetWidth = chart.parent().width();
  chart.attr("width", targetWidth);
  chart.attr("height", targetWidth / aspect);
});

} //end mapBuild


//show/hide parameters
$.urlParam = function(name){
  var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
  return results[1] || 0;
}

var race = $.urlParam('race');
$(".raceSwitch, li").removeClass("selected2");
$(".raceSwitch[section=" + race + "]").addClass("selected2");
$("li[section=" + race + "]").addClass("selected2");

var currentrace = race;

function mapShow(container, race){
 d3.selectAll(".mappage").each(function(i){
  if (!d3.select(this).classed(race)) { d3.select(this).style("display","none"); }
  else { d3.select(this).style("display","block"); }
 });
} //end mapShow

function mapSpill(race,data){

  if (race == "president"){
    mapBuild("#president .geo", "#districtName", "#chart", "us_states.json", race, "us", "country", data);
    if ($(window).width() > 500) { mapBuild("#president .geo", "#districtName", "#chart", "us_counties.json", "county", "us", "counties", data); }
    electoralCarto(data);
    // mapBuild("#mapStates", "#districtName", "#chart", "us_states.json", race, "us", "country", data);
    // mapBuild("#mapCounties", "#districtName", "#chart", "us_counties.json", "county", "us", "counties", data);
  }  

  if (race == "house"){
    mapBuild("#house .geo", "#districtName", "#chart", "uscongress.json", race, "us", "country", data);
    // mapBuild("#mapMN", "#districtName", "#chart", "us_cd_mn_2012.json", race, "mn", "country", data);
    houseCarto(data);
  }  

  if (race == "senate"){
    mapBuild("#senate .geo", "#districtName", "#chart", "us_states.json", race, "us", "country", data);
  }  

  if (race == "governors"){
    mapBuild("#governors .geo", "#districtName", "#chart", "us_states.json", race, "us", "country", data);
  }  

  if (race == "mnhouse"){
    mapBuild("#mnhouse .mapState", "#districtName", "#chart", "mnleg.json", race, "mn", "country", data);
    mapBuild("#mnhouse .mapMetro", "#districtName", "#chart", "mnleg_metro.json", race, "metro", "country", data);
    // cartoBuild("#mnhouse .cartoState", "#districtName", "#chart", null, race, data, "us", 0, cartoData(race,"mn"));
    // cartoBuild("#mnhouse .cartoMetro", "#districtName", "#chart", null, race, data, "us", 0, cartoData(race,"metro"));
  }  

  if (race == "mnsenate"){
    mapBuild("#mnsenate .mapState", "#districtName", "#chart", "mnsenate.json", race, "mn", "country", data);
    mapBuild("#mnsenate .mapMetro", "#districtName", "#chart", "mnsenate_metro.json", race, "metro", "country", data);
    // cartoBuild("#mnsenate .cartoState", "#districtName", "#chart", null, race, data, "us", 0, cartoData(race,"mn"));
    // cartoBuild("#mnsenate .cartoMetro", "#districtName", "#chart", null, race, data, "us", 0, cartoData(race,"metro"));
  }

} //end mapSpill

//RETRIEVE NEW DATA FOR THE TABLES AND POWER BALANCE
function prezCrunch(data,dataEV){

  $("#allResults .president").html("");

  var stateList = ["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","District of Columbia","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"];

  var evList = [9,3,11,6,55,9,7,3,3,29,16,4,4,20,11,6,6,8,8,2,10,11,16,10,6,10,3,2,6,4,14,5,29,15,3,18,7,7,20,4,9,3,11,38,6,3,13,12,5,10,3];

  var dTally = 0;
  var rTally = 0;
  var iTally = 0;

  for (var i=0; i < 51; i++){
    var updated = fetchData(null,stateList[i],"winner",data,"president",null,null,null);
    if (updated == "GOP Win") { rTally += evList[i]; }
    else if (updated == "DEM Win") { dTally += evList[i]; }
    else if (updated == "IND Win") { iTally += evList[i]; }
    $("#allResults .president").append(fetchData(null,stateList[i],"board",data,"president",evList[i],null));
  }

  var me1 = fetchData(null,"ME","lean",dataEV,"president",null,null,"District 1");
  var me2 = fetchData(null,"ME","lean",dataEV,"president",null,null,"District 2");
  var ne1 = fetchData(null,"NE","lean",dataEV,"president",null,null,"District 1");
  var ne2 = fetchData(null,"NE","lean",dataEV,"president",null,null,"District 2");
  var ne3 = fetchData(null,"NE","lean",dataEV,"president",null,null,"District 3");

  $(".ME01").css("background-color",me1);
  $(".ME02").css("background-color",me2);
  $(".NE01").css("background-color",ne1);
  $(".NE02").css("background-color",ne2);
  $(".NE03").css("background-color",ne3);
  $("#ME01").css("fill",me1);
  $("#ME02").css("fill",me2);
  $("#NE01").css("fill",ne1);
  $("#NE02").css("fill",ne2);
  $("#NE03").css("fill",ne3);

  $("#allResults .president").append(fetchData(null,"ME","board",dataEV,"president",1,"ME01","District 1"));
  $("#allResults .president").append(fetchData(null,"ME","board",dataEV,"president",1,"ME02","District 2"));
  $("#allResults .president").append(fetchData(null,"NE","board",dataEV,"president",1,"NE01","District 1"));
  $("#allResults .president").append(fetchData(null,"NE","board",dataEV,"president",1,"NE02","District 2"));
  $("#allResults .president").append(fetchData(null,"NE","board",dataEV,"president",1,"NE03","District 3"));

  var me1W = fetchData(null,"ME","winner",dataEV,"president",null,null,"District 1");
  var me2W = fetchData(null,"ME","winner",dataEV,"president",null,null,"District 2");
  var ne1W = fetchData(null,"NE","winner",dataEV,"president",null,null,"District 1");
  var ne2W = fetchData(null,"NE","winner",dataEV,"president",null,null,"District 2");
  var ne3W = fetchData(null,"NE","winner",dataEV,"president",null,null,"District 3");

  if (me1W == "GOP Win") { rTally++; }
  else if (me1W == "DEM Win") { dTally++; }
  if (me2W == "GOP Win") { rTally++; }
  else if (me2W == "DEM Win") { dTally++; }
  if (ne1W == "GOP Win") { rTally++; }
  else if (ne1W == "DEM Win") { dTally++; }
  if (ne2W == "GOP Win") { rTally++; }
  else if (ne2W == "DEM Win") { dTally++; }
  if (ne3W == "GOP Win") { rTally++; }
  else if (ne3W == "DEM Win") { dTally++; }

  // var votesR = fetchData(null,"United States","votesR",data,"data",null,null);
  // var votesD = fetchData(null,"United States","votesD",data,"data",null,null);
  // var votesT = fetchData(null,"United States","votesT",data,"data",null,null);

  var winner = fetchData(null,"United States","winner",data,"president",null,null);

  if (winner == "GOP Win") { $("#rMark").html("&#x2714;"); }
  else if (winner == "DEM Win") { $("#dMark").html("&#x2714;"); }

  $(".demsCount").html(dTally);
  $(".gopCount").html(rTally);
  // $(".dcount").html(d3.format(",")(votesD));
  // $(".rcount").html(d3.format(",")(votesR));
  // $(".demPCT").html(d3.format("%")(votesD/votesT));
  // $(".gopPCT").html(d3.format("%")(votesR/votesT)); 
  $("#dWin").css("width", d3.format("%")(dTally/538));
  $("#rWin").css("width", d3.format("%")(rTally/538));
  $("#iWin").css("width", d3.format("%")(iTally/538));
  $("#dChange").html("");
  $("#rChange").html("");

  $('.filter_box').keyup(function(i){
     $('#allResults .president .tableRow').hide();
     $("#allResults .president .tableRow").removeClass("selectedBox");
     var txt = String($('.filter_box').val());
     $('#allResults .president .tableRow').each(function(){
        if($(this).text().toUpperCase().indexOf(txt.toUpperCase()) != -1){
            $(this).show();
        }
     });
  });

  $(".president .tableRow").click(function() {
    $(".tableRow").removeClass("selectedBox");
    $(this).addClass("selectedBox");
    var findDistrict = $(this).attr("name");
    $(".cartoState").removeClass("selectedBox");
    $("#cartogram #" + $(this).attr("name")).addClass("selectedBox");
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
  });

} //end prezCrunch

function senCrunch(data){

  $("#allResults .senate").html("");
  $("#rMark, #dMark").html("");

  var stateList = ["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maryland","Missouri","Nevada","New Hampshire","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","South Carolina","South Dakota","Utah","Vermont","Washington","Wisconsin"];

  var dPre = 46;
  var rPre = 54;

  var dTally = 36;
  var rTally = 30;
  var iTally = 0;

  for (var i=0; i < stateList.length; i++){
    var updated = fetchData(null,stateList[i],"winner",data,"senate",null,null);
    if (updated == "GOP Win") { rTally++; }
    else if (updated == "DEM Win") { dTally++; }
    else if (updated == "IND Win") { iTally++; }

    $("#allResults .senate").append(fetchData(null,stateList[i],"board",data,"senate",null,null));
  }

  $(".demsCount").html(dTally);
  $(".gopCount").html(rTally);
  $("#dWin").css("width", d3.format("%")(dTally/100));
  $("#rWin").css("width", d3.format("%")(rTally/100));
  $("#iWin").css("width", d3.format("%")(iTally/100));
  $("#dChange").html(d3.format("+")(dTally - dPre));
  $("#rChange").html(d3.format("+")(rTally - rPre));


  $('.filter_box').keyup(function(i){
     $('#allResults .senate .tableRow').hide();
     $("#allResults .senate .tableRow").removeClass("selectedBox");
     var txt = String($('.filter_box').val());
     $('#allResults .senate .tableRow').each(function(){
        if($(this).text().toUpperCase().indexOf(txt.toUpperCase()) != -1){
            $(this).show();
        }
     });
  });

  $(".senate .tableRow").click(function() {
     d3.selectAll("path").classed("faded", false).classed("active", false); 
     $(".tableRow").removeClass("selectedBox");
     $(this).addClass("selectedBox");
     var findDistrict = $(this).attr("name") + "s";
     $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
     $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
     $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
  });

} //end senCrunch

function govCrunch(data){

  $("#allResults .governors").html("");
  $("#rMark, #dMark").html("");

  var stateList = ["Delaware","Indiana","Missouri","Montana","New Hampshire","North Carolina","North Dakota","Oregon","Utah","Vermont","Washington","West Virginia"];

  var dPre = 18;
  var rPre = 31;

  var dTally = 10;
  var rTally = 27;
  var iTally = 1;

  for (var i=0; i < stateList.length; i++){
    var updated = fetchData(null,stateList[i],"winner",data,"governors",null,null);
    if (updated == "GOP Win") { rTally++; }
    else if (updated == "DEM Win") { dTally++; }
    else if (updated == "IND Win") { iTally++; }

    $("#allResults .governors").append(fetchData(null,stateList[i],"board",data,"governors",null,null));
  }

  $(".demsCount").html(dTally);
  $(".gopCount").html(rTally);
  $("#dWin").css("width", d3.format("%")(dTally/50));
  $("#rWin").css("width", d3.format("%")(rTally/50));
  $("#iWin").css("width", d3.format("%")(iTally/50));
  $("#dChange").html(d3.format("+")(dTally - dPre));
  $("#rChange").html(d3.format("+")(rTally - rPre));

  $('.filter_box').keyup(function(i){
     $('#allResults .governors .tableRow').hide();
     $("#allResults .governors .tableRow").removeClass("selectedBox");
     var txt = String($('.filter_box').val());
     $('#allResults .governors .tableRow').each(function(){
        if($(this).text().toUpperCase().indexOf(txt.toUpperCase()) != -1){
            $(this).show();
        }
     });
  });

  $(".governors .tableRow").click(function() {
    d3.selectAll("path").classed("faded", false).classed("active", false);  
    $(".tableRow").removeClass("selectedBox");
    $(this).addClass("selectedBox");
    var findDistrict = $(this).attr("name") + "g";
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
  });

} //end govCrunch

function houseCrunch(data){

  $("#allResults .house").html("");
  $("#rMark, #dMark").html("");

  var stateList = ["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"];
  var districtList = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53];

  var dPre = 186;
  var rPre = 246;

  var dTally = 0;
  var rTally = 0;
  var iTally = 0;

  for (var i=0; i < districtList.length; i++){
    for (var k=0; k < stateList.length; k++){
    var updated = fetchData("District " + districtList[i],stateList[k],"winner",data,"ushouse",null,"District " + districtList[i]);
    if (updated == "GOP Win") { rTally++; }
    else if (updated == "DEM Win") { dTally++; }
    else if (updated == "IND Win") { iTally++; }
    }

  }

  $("#allResults .house").append(fetchData("District 1","Minnesota","board",data,"ushouse",null,"1"));
  $("#allResults .house").append(fetchData("District 2","Minnesota","board",data,"ushouse",null,"2"));
  $("#allResults .house").append(fetchData("District 3","Minnesota","board",data,"ushouse",null,"3"));
  $("#allResults .house").append(fetchData("District 4","Minnesota","board",data,"ushouse",null,"4"));
  $("#allResults .house").append(fetchData("District 5","Minnesota","board",data,"ushouse",null,"5"));
  $("#allResults .house").append(fetchData("District 6","Minnesota","board",data,"ushouse",null,"6"));
  $("#allResults .house").append(fetchData("District 7","Minnesota","board",data,"ushouse",null,"7"));
  $("#allResults .house").append(fetchData("District 8","Minnesota","board",data,"ushouse",null,"8"));

  $(".demsCount").html(dTally);
  $(".gopCount").html(rTally);
  $("#dWin").css("width", d3.format("%")(dTally/435));
  $("#rWin").css("width", d3.format("%")(rTally/435));
  $("#iWin").css("width", d3.format("%")(iTally/435));
  $("#dChange").html(d3.format("+")(dTally - dPre));
  $("#rChange").html(d3.format("+")(rTally - rPre));

  $('.filter_box').keyup(function(i){
     $('#allResults .house .tableRow').hide();
     $("#allResults .house .tableRow").removeClass("selectedBox");
     var txt = String($('.filter_box').val());
     $('#allResults .house .tableRow').each(function(){
        if($(this).text().toUpperCase().indexOf(txt.toUpperCase()) != -1){
            $(this).show();
        }
     });
  });

  $(".house .tableRow").click(function() {
    d3.selectAll("path").classed("faded", false).classed("active", false);  
    $(".tableRow").removeClass("selectedBox");
    $(this).addClass("selectedBox");  

      var findDistrict = $(this).attr("name");
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();  

      var findDistrict2 = $(this).attr("name") + "c";
    $("[id='" + findDistrict2.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
    $("[id='" + findDistrict2.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
    $("[id='" + findDistrict2.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
  });

} //end houseCrunch

function mnhouseCrunch(data){

  $("#allResults .mnhouse").html("");
  $("#rMark, #dMark").html("");

  var districtList = ["1A","1B","2A","2B","3A","3B","4A","4B","5A","5B","6A","6B","7A","7B","8A","8B","9A","9B","10A","10B","11A","11B","12A","12B","13A","13B","14A","14B","15A","15B","16A","16B","17A","17B","18A","18B","19A","19B","20A","20B","21A","21B","22A","22B","23A","23B","24A","24B","25A","25B","26A","26B","27A","27B","28A","28B","29A","29B","30A","30B","31A","31B","32A","32B","33A","33B","34A","34B","35A","35B","36A","36B","37A","37B","38A","38B","39A","39B","40A","40B","41A","41B","42A","42B","43A","43B","44A","44B","45A","45B","46A","46B","47A","47B","48A","48B","49A","49B","50A","50B","51A","51B","52A","52B","53A","53B","54A","54B","55A","55B","56A","56B","57A","57B","58A","58B","59A","59B","60A","60B","61A","61B","62A","62B","63A","63B","64A","64B","65A","65B","66A","66B","67A","67B"];

  var dPre = 61;
  var rPre = 73;

  var dTally = 0;
  var rTally = 0;
  var iTally = 0;

  for (var i=0; i < districtList.length; i++){
    var updated = fetchData("District " + districtList[i],"Minnesota","winner",data,"mnhouse",null,"District " + districtList[i]);
    if (updated == "GOP Win") { rTally++; }
    else if (updated == "DEM Win") { dTally++; }
    else if (updated == "IND Win") { iTally++; }
    $("#allResults .mnhouse").append(fetchData("District " + districtList[i],"Minnesota","board",data,"mnhouse",null,districtList[i]));
  }

  $(".demsCount").html(dTally);
  $(".gopCount").html(rTally);
  $("#dWin").css("width", d3.format("%")(dTally/134));
  $("#rWin").css("width", d3.format("%")(rTally/134));
  $("#iWin").css("width", d3.format("%")(iTally/134));
  $("#dChange").html(d3.format("+")(dTally - dPre));
  $("#rChange").html(d3.format("+")(rTally - rPre));

  $('.filter_box').keyup(function(i){
     $('#allResults .mnhouse .tableRow').hide();
     $("#allResults .mnhouse .tableRow").removeClass("selectedBox");
     var txt = String($('.filter_box').val());
     $('#allResults .mnhouse .tableRow').each(function(){
        if($(this).text().toUpperCase().indexOf(txt.toUpperCase()) != -1){
            $(this).show();
        }
     });
  });

  $(".mnhouse .tableRow").click(function() {
      d3.selectAll("path").classed("faded", false).classed("active", false);
      $(".tableRow").removeClass("selectedBox");
      $(this).addClass("selectedBox");
      var findDistrict = "mnh" + $(this).attr("name");
      $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
      $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
      $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
  });

} //end mnhouseCrunch

function mnsenCrunch(data){

  $("#allResults .mnsenate").html("");
  $("#rMark, #dMark").html("");

  var districtList = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67];

  var dPre = 39;
  var rPre = 28;

  var dTally = 0;
  var rTally = 0;
  var iTally = 0;

  for (var i=0; i < districtList.length; i++){
    var updated = fetchData("District " + districtList[i],"Minnesota","winner",data,"mnsenate",null,"District " + districtList[i]);
    if (updated == "GOP Win") { rTally++; }
    else if (updated == "DEM Win") { dTally++; }
    else if (updated == "IND Win") { iTally++; }
    $("#allResults .mnsenate").append(fetchData("District " + districtList[i],"Minnesota","board",data,"mnsenate",null,districtList[i]));
  }

  $(".demsCount").html(dTally);
  $(".gopCount").html(rTally);
  $("#dWin").css("width", d3.format("%")(dTally/67));
  $("#rWin").css("width", d3.format("%")(rTally/67));
  $("#iWin").css("width", d3.format("%")(iTally/67));
  $("#dChange").html(d3.format("+")(dTally - dPre));
  $("#rChange").html(d3.format("+")(rTally - rPre));

  $('.filter_box').keyup(function(i){
     $('.tableRow').hide();
     $(".tableRow").removeClass("selectedBox");
     var txt = String($('.filter_box').val());
     $('.tableRow').each(function(){
        if($(this).text().toUpperCase().indexOf(txt.toUpperCase()) != -1){
            $(this).show();
        }
     });
  });

  $(".mnsenate .tableRow").click(function() {
      d3.selectAll("path").classed("faded", false).classed("active", false);
      $(".tableRow").removeClass("selectedBox");
      $(this).addClass("selectedBox");
      var findDistrict = "mns" + $(this).attr("name");
      $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
      $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
      $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
  });

} //end mnsenCrunch

function toggleyBits(data1,data2,data3,data4,data5,data6,data7,reload){
  var loadState = 0;

function loadBars(race){
  if (race == "president") { prezCrunch(data1,data7); } 
  if (race == "senate") { senCrunch(data2); } 
  if (race == "governors") { govCrunch(data3); } 
  if (race == "mnsenate") { mnsenCrunch(data4); } 
  if (race == "mnhouse") { mnhouseCrunch(data5); } 
  if (race == "house") { houseCrunch(data6); } 
}

loadBars(currentrace);

//MAKE THOSE PESKY EVCDS WORK
function evcdToggles(){
$(".ME01, #ME01").hover(function(event) {
 spillInfo(fetchData(null,"ME","table",data7,"president",null,"District 1","District 1"));
 $(".block").removeClass("blockSelect");
 $(".ME01.evcd").addClass("blockSelect");
 $("#evcdME01").addClass("selectedBox");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$("#evcdME01").click(function(event) {
 spillInfo(fetchData(null,"ME","table",data7,"president",null,"District 1","District 1"));
 $(".block").removeClass("blockSelect");
 $(".ME01.evcd").addClass("blockSelect");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$(".ME02, #ME02").hover(function(event) {
 spillInfo(fetchData(null,"ME","table",data7,"president",null,"District 2","District 2"));
 $(".block").removeClass("blockSelect");
 $(".ME02.evcd").addClass("blockSelect");
 $("#evcdME02").addClass("selectedBox");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$("#evcdME02").click(function(event) {
 spillInfo(fetchData(null,"ME","table",data7,"president",null,"District 2","District 2"));
 $(".block").removeClass("blockSelect");
 $(".ME02.evcd").addClass("blockSelect");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$(".NE01, #NE01").hover(function(event) {
 spillInfo(fetchData(null,"NE","table",data7,"president",null,"District 1","District 1"));
 $(".block").removeClass("blockSelect");
 $(".NE01.evcd").addClass("blockSelect");
 $("#evcdNE01").addClass("selectedBox");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$("#evcdNE01").click(function(event) {
 spillInfo(fetchData(null,"NE","table",data7,"president",null,"District 1","District 1"));
 $(".block").removeClass("blockSelect");
 $(".NE01.evcd").addClass("blockSelect");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$(".NE02, #NE02").hover(function(event) {
 spillInfo(fetchData(null,"NE","table",data7,"president",null,"District 2","District 2"));
 $(".block").removeClass("blockSelect");
 $(".NE02.evcd").addClass("blockSelect");
 $("#evcdNE02").addClass("selectedBox");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$("#evcdNE02").click(function(event) {
 spillInfo(fetchData(null,"NE","table",data7,"president",null,"District 2","District 2"));
 $(".block").removeClass("blockSelect");
 $(".NE02.evcd").addClass("blockSelect");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$(".NE03, #NE03").hover(function(event) {
 spillInfo(fetchData(null,"NE","table",data7,"president",null,"District 3","District 3"));
 $(".block").removeClass("blockSelect");
 $(".NE03.evcd").addClass("blockSelect");
 $("#evcdNE03").addClass("selectedBox");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

$("#evcdNE03").click(function(event) {
 spillInfo(fetchData(null,"NE","table",data7,"president",null,"District 3","District 3"));
 $(".block").removeClass("blockSelect");
 $(".NE03.evcd").addClass("blockSelect");
   d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

}

  evcdToggles();

$(".cartoState").click(function(event) {
 spillInfo(fetchData($(this).attr("name"),$(this).attr("name"),"table",data1,"president"));
});

$(".cartoState polygon").hover(function(event) {
$(".cartoState, .tableRow").removeClass("selectedBox");
$(".tableRow[name=" + $(this).parent().attr("id") + "]").addClass("selectedBox");
 spillInfo(fetchData($(this).parent().attr("name"),$(this).parent().attr("name"),"table",data1,"president"));
});

$(".cartoState").mouseleave(function(event) {
  $(".cartoState").removeClass("blockSelect");
  $(".cartoState, .tableRow").removeClass("selectedBox");
  if (thisView == "mn") { spillInfo(fetchData("Minnesota","Minnesota","table",data1,"president")); }
  else if (thisView == "us") { spillInfo(fetchData("United States","United States","table",data1,"president")); }
  else if (thisView == "cd") { spillInfo(fetchData("District 2","Minnesota","table",data6,"ushouse",null,"District 2")); }
  else { $("#infobox").html(""); }
});

$(".block").mouseleave(function(event) {
  $(".block").removeClass("blockSelect");
  $(".tableRow").removeClass("selectedBox");
  if (thisView == "mn") { spillInfo(fetchData("Minnesota","Minnesota","table",data1,"president")); }
  else if (thisView == "us") { spillInfo(fetchData("United States","United States","table",data1,"president")); }
  else if (thisView == "cd") { spillInfo(fetchData("District 2","Minnesota","table",data6,"ushouse",null,"District 2")); }
  else { $("#infobox").html(""); }
    d3.selectAll("path")
      .classed("faded", false)
      .classed("active", false);
});

//RESET ALL THE VIEWS
$(".zoom").click(function(event) {
  $(".block").removeClass("blockSelect");
  $(".tableRow").removeClass("selectedBox");
  $(".cartoState").removeClass("selectedBox");
  d3.selectAll(".cd").classed("active",false);
  $(".tableRow").show();
  $(".filter_box").val("");
  if (thisView == "mn") { spillInfo(fetchData("Minnesota","Minnesota","table",data1,"president")); }
  else if (thisView == "us") { spillInfo(fetchData("United States","United States","table",data1,"president")); }
  else if (thisView == "cd") { spillInfo(fetchData("District 2","Minnesota","table",data6,"ushouse",null,"District 2")); }
  else { $("#infobox").html(""); }
});

//carto clickies
$(".stateBlock").click(function(event) {
$(".block").removeClass("blockSelect");
$(this).addClass("blockSelect");
    var findDistrict = $(this).attr("ab");
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
});

$(".stateBlock").hover(function(event) {
    var findDistrict = $(this).attr("ab");
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Down();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Up();
    $("[id='" + findDistrict.replace(new RegExp(" ", "g"),"-") + "']").d3Click();
}, function(){
      // unhover code 
   });

//TRIGGER CHANGES WHEN SELECTING MENU ITEMS
$(".has-sub").click(function(event) {
  $(".raceSwitch, li").removeClass("selected2");
});

$(".raceSwitch").click(function(event) {
    
  //infobox switches
  thisView = $(this).attr("infobox");

  if (thisView == "mn") { spillInfo(fetchData("Minnesota","Minnesota","table",data1,"president")); }
  else if (thisView == "us") { spillInfo(fetchData("United States","United States","table",data1,"president")); }
  else if (thisView == "cd") { spillInfo(fetchData("District 2","Minnesota","table",data6,"ushouse",null,"District 2")); }
  else { $("#infobox").html(""); }

  //load power bars
  loadBars($(this).attr("data"));

  //button thingies
  $(".raceSwitch, li").removeClass("selected2");
  $(".cartoState").removeClass("selectedBox");
  $(this).addClass("selected2");
  $(".raceSwitch").find("a").removeClass("selected3");
  $(this).find("a").addClass("selected3");

  //show correct race
  $(".dataviz, .bigBoard").hide();
  $("#" + $(this).attr("data")).show();
  $("." + $(this).attr("data")).show();
  currentrace = $(this).attr("data");

  //show correct legend
  $(".legendBlock").hide();
  $("#" + $(this).attr("legend")).show();
  $(".dparty").html($(this).attr("dLabel"));
  $(".rparty").html($(this).attr("rLabel"));
  if ($(this).attr("stateKey") == "showMe") { $(".sideStates").show(); }
  else { $(".sideStates").hide(); }
  
  //show map or carto
  $(".map").hide();
  $("." + $(this).attr("type")).show();
  $("." + $(this).attr("type")).css('display','inline-block');

  //show correct layer
  loadState++;
  mapShow(".map",$(this).attr("layer"));

  evcdToggles();
}); //end menu triggers

} //end togglyBits


//INITIAL DATAMANCY TO CONJURE RESULTS FROM THE ASSOCIATED PRESS
var apiStringPrez = "https://s3-us-west-2.amazonaws.com/strib-elections-ap-api/us-uspresident-by-county/full.json";
// var apiStringPrez = "./data/prezCounty_new.json";
var apiStringSen = "https://s3-us-west-2.amazonaws.com/strib-elections-ap-api/us-ussenate-by-state/full.json";
var apiStringGov = "https://s3-us-west-2.amazonaws.com/strib-elections-ap-api/us-governors-by-state/full.json";
// var apiStringMNS = "./data/mnsenate_new.json";
// var apiStringMNH = "./data/mnhouse_new.json";
// var apiStringHouse = "./data/house_new.json";
var apiStringMNS = "https://s3-us-west-2.amazonaws.com/strib-elections-ap-api/mn-mnsenate-by-district/full.json";
var apiStringMNH = "https://s3-us-west-2.amazonaws.com/strib-elections-ap-api/mn-mnhouse-by-district/full.json";
var apiStringHouse = "https://s3-us-west-2.amazonaws.com/strib-elections-ap-api/us-ushouse-by-state/full.json";
var apiStringEVCD = "https://s3-us-west-2.amazonaws.com/strib-elections-ap-api/us-uspresident-nebraska-maine/full.json";

d3.json(apiStringPrez + '?' + (Math.floor(Math.random() * 1000)), function(error1, jsonSpillPrez) {
d3.json(apiStringSen + '?' + (Math.floor(Math.random() * 1000)), function(error2, jsonSpillSen) {
d3.json(apiStringGov + '?' + (Math.floor(Math.random() * 1000)), function(error3, jsonSpillGov) {
d3.json(apiStringMNS + '?' + (Math.floor(Math.random() * 1000)), function(error4, jsonSpillMNS) {
d3.json(apiStringMNH + '?' + (Math.floor(Math.random() * 1000)), function(error5, jsonSpillMNH) {
d3.json(apiStringHouse + '?' + (Math.floor(Math.random() * 1000)), function(error6, jsonSpillHouse) {
d3.json(apiStringEVCD + '?' + (Math.floor(Math.random() * 1000)), function(error7, jsonSpillEVCD) {

//JUST IN CASE OF THERMONUCLEAR DISASTER
function fallback(){
  var mapsString = "<img src='http://static.startribune.com/news/elections/frontpage_bars_maps.png' width='100%' />";
  var mobileString = "<img src='http://static.startribune.com/news/elections/frontpage_bars_desktop.png' width='100%' />";
  $("#fulldataviz, #loader").hide();
  $("#fallback").html("<div style='padding:20px; text-align:center;'>We're experiencing technical difficulties, please check back shortly.</div><div>" + mapsString + "</div><div>" + mobileString + "</div>");
  // $("#fallback").html("FALLBACKS!!!11~");
  $("#fallback").show();
}

if (error1 != null || error2 != null || error3 != null || error4 != null || error5 != null || error6 != null || error7 != null) {
   fallback(); 
   return;
}

var dataPrez = jsonSpillPrez;
var dataSen = jsonSpillSen;
var dataGov = jsonSpillGov;
var dataMNS = jsonSpillMNS;
var dataMNH = jsonSpillMNH;
var dataHouse = jsonSpillHouse;
var dataEVCD = jsonSpillEVCD;

mapSpill("president",dataPrez);
if ($(window).width() > 500) { mapSpill("senate",dataSen); }
if ($(window).width() > 500) { mapSpill("governors",dataGov); }
mapSpill("mnsenate",dataMNS);
mapSpill("mnhouse",dataMNH);
mapSpill("house",dataHouse);

$(document).ready(function() {
    $(".dataviz").hide();
    $("#" + race).show();
    mapShow(".map","country");

var docwidth = $(window).width(); 

if ((docwidth < 500)) {
    $("svg").width(docwidth);
    $("svg").height(docwidth / 1.5);
}

});

toggleyBits(dataPrez,dataSen,dataGov,dataMNS,dataMNH,dataHouse,dataEVCD,false);

spillInfo(fetchData("United States","United States","table",dataPrez,"president"));

$(".dparty").html("Clinton");
$(".rparty").html("Trump");
$("#prezButton").trigger("click");
$("#table .president").show();

window.setTimeout(function () { $("#message").html("Rendering results..."); }, 3000);

window.setTimeout(function () {
  
  $("#wrapper").show();
  $(".loading-mask").hide();

    var count = 120;
    var timerId = setInterval(function() {
        count--;
        $(".ticker").html(count);

        if(count == 0) {
            count = 120;
            $(".ticker").html("--");
            reloadData();
        }
    }, 1000);

}, 6000);

});
});
});
});
});
});
}); //end data stream initialization


//REPAINT EVERYTHING TO REFLECT OUR TERRIFYING NEW REALITY
function mapReshade(container, shape, subject, race, dataCompare) {
d3.json("shapefiles/" + shape, function(error, us) {
    if (race != "cartoHouse"){
  d3.selectAll(container + " path")
        .data(us.features)
        .style("fill", function(d){
         if (race == "president") { 
            $('#president .sideStates .block').each(function(i, obj) {
                if ($(this).hasClass(d.properties.STUSPS)){
                var color = fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race);
                $(this).css("background-color", color);
                }
            });
            return fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race); 
         }
         if (race == "senate") { 
            $('#senate .sideStates .block').each(function(i, obj) {
                if ($(this).hasClass(d.properties.STUSPS)){
                var color = fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race);
                $(this).css("background-color", color);
                }
            });
            return fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race); 
         }
         if (race == "governors") { 
            $('#governors .sideStates .block').each(function(i, obj) {
                if ($(this).hasClass(d.properties.STUSPS)){
                var color = fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race);
                $(this).css("background-color", color);
                }
            });
            return fetchData(d.properties.NAME,d.properties.NAME,"lean",dataCompare,race); 
         }
         else if (race == "county") { return fetchData(d.properties.GEOID,null,"colors",dataCompare,race); }
           // else if (race == "pct") { return mapColor(d.properties.PCTCODE, race, dataCompare); }
         else if (race == "house") { return fetchData("District " + d.properties.DISTRICT,d.properties.STATENAME,"lean",dataCompare,"ushouse",null,"District " + d.properties.DISTRICT); }
         else if (race == "mnsenate" || race == "mnhouse") { return fetchData("District " + d.properties.DISTRICT,"Minnesota","lean",dataCompare,race); }
        })
       .on("mousedown", function(d, i){
        var str = d.properties.NAME; 
        $(".district").removeClass("selected");
        $(".tableRow").removeClass("selectedBox");
        $(".tableRow[name=" + d.properties.STUSPS + "]").addClass("selectedBox");
        $(".tableRow[name=" + d.properties.DISTRICT + "]").addClass("selectedBox");
        if (race == "president" || race == "senate" ||  race == "governors"){ 
            spillInfo(fetchData(d.properties.NAME,d.properties.NAME,"table",dataCompare,race)); $(".block").removeClass("blockSelect"); $("." + d.properties.STUSPS).addClass("blockSelect"); 
        }
        else if (race == "county"){ 
            spillInfo(fetchData(d.properties.GEOID,null,"table",dataCompare,race,null,d.properties.NAME)); 
        }
        else if (race == "house"){ 
            spillInfo(fetchData("District " + d.properties.DISTRICT,d.properties.STATENAME,"table",dataCompare,"ushouse",null,"District " + d.properties.DISTRICT)); 
            $(".tableRow").removeClass("selectedBox"); 
            if (d.properties.STATENAME == "Minnesota") { 
                $(".tableRow[name=" + d.properties.STATENAME + "" + d.properties.DISTRICT + "]").addClass("selectedBox"); } 
            } 
        else if (race == "mnsenate" || race == "mnhouse") { 
            spillInfo(fetchData("District " + d.properties.DISTRICT,"Minnesota","table",dataCompare,race,null,"District " + d.properties.DISTRICT)); }
            return false;
       })
         .call(d3.helper.tooltip(function(d, i){
         if ($(window).width() > 500) { 
         if (race == "president" || race == "senate" || race == "governors") { 
            return fetchData(d.properties.NAME,d.properties.NAME,"tooltip",dataCompare,race);
         }
         else if (race == "county") { 
            return fetchData(d.properties.GEOID,null,"tooltip",dataCompare,race,null,d.properties.NAME); 
         }
         else if (race == "house") { 
            return fetchData("District " + d.properties.DISTRICT,d.properties.STATENAME,"tooltip",dataCompare,"ushouse",null,"District " + d.properties.DISTRICT); 
         }
         //DON'T FORGET THIS, STUPID
         else if (race == "mnsenate" || race == "mnhouse") { 
          if (d.properties.DISTRICT == "32B") { return "<div class='districtName'>District 32B, MN</div><div>No race</div>"; }
          else { return fetchData("District " + d.properties.DISTRICT,"Minnesota","tooltip",dataCompare,race,null,"District " + d.properties.DISTRICT); }
        }
        }}));
  } else {

  d3.selectAll(container + " path")
        .data(topojson.feature(us, us.objects['cart113']).features)
        .style("fill", function(d){
           return fetchData("District " + d.properties['d'],d.properties.State,"lean",dataCompare,"ushouse",null,"District " + d.properties['d']); 
          })
        .attr("class","cd")
        .on("mousedown", function(d, i){
            d3.selectAll(".cd").classed("active",false);
            d3.select(this).classed("active",true);
            $(".tableRow").removeClass("selectedBox");
            if (d.properties.State == "Minnesota") { 
                $(".tableRow[name=" + d.properties.State + "" + d.properties['d'] + "]").addClass("selectedBox"); 
            }
            spillInfo(fetchData("District " + d.properties['d'],d.properties.State,"table",dataCompare,"ushouse",null,"District " + d.properties['d']))
         })
         .call(d3.helper.tooltip(function(d, i){
        if ($(window).width() > 500) { 
            return fetchData("District " + d.properties['d'],d.properties.State,"tooltip",dataCompare,"ushouse",null,"District " + d.properties['d']);
        } else { $(".tooltip").hide(); }}));
  }
});
} //end mapReshade

//A SUMMONING SPELL FOR NEW DATA
function reloadData(){

   d3.json(apiStringPrez + '?' + (Math.floor(Math.random() * 1000)), function(error1, jsonSpillPrez) {
   d3.json(apiStringSen + '?' + (Math.floor(Math.random() * 1000)), function(error2, jsonSpillSen) {
   d3.json(apiStringGov + '?' + (Math.floor(Math.random() * 1000)), function(error3, jsonSpillGov) {
   d3.json(apiStringMNS + '?' + (Math.floor(Math.random() * 1000)), function(error4, jsonSpillMNS) {
   d3.json(apiStringMNH + '?' + (Math.floor(Math.random() * 1000)), function(error5, jsonSpillMNH) {
   d3.json(apiStringHouse + '?' + (Math.floor(Math.random() * 1000)), function(error6, jsonSpillHouse) {
   d3.json(apiStringEVCD + '?' + (Math.floor(Math.random() * 1000)), function(error7, jsonSpillEVCD) {   

   var dataPrez = jsonSpillPrez;
   var dataSen = jsonSpillSen;
   var dataGov = jsonSpillGov;
   var dataMNS = jsonSpillMNS;
   var dataMNH = jsonSpillMNH;
   var dataHouse = jsonSpillHouse;
   var dataEVCD = jsonSpillEVCD;   

   $('.raceSwitch').on('blur change click dblclick error focus focusin focusout hover keydown keypress keyup load mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup resize scroll select submit', function(event){ event.stopPropagation(); return false; });

   $('.raceSwitch').off("click");

   $('.block, .cartoState, .tableRow, path, .stateBlock, .ME01, #ME01, .ME02, #ME02, .NE01, #NE01, .NE02, #NE02, .NE03, #NE03, .evcd, .cartoState polygon').off();

   //presidential updates
   mapReshade("#USMAP .country", "us_states.json", "country", "president", dataPrez);
   if ($(window).width() > 500) { mapReshade("#USMAP .counties", "us_counties.json", "counties", "county", dataPrez); }
   electoralCarto(dataPrez);   

   //senate updates
   if ($(window).width() > 500) { mapReshade("#USSENATE .country", "us_states.json", "country", "senate", dataSen); }   

   //governors updates
   if ($(window).width() > 500) { mapReshade("#USGOV .country", "us_states.json", "country", "governors", dataGov); }   

   //house updates
   mapReshade("#USHOUSE .country", "uscongress.json", "country", "house", dataHouse);
   mapReshade("#cartoHouse svg", "usdistricts_cartogram.json", "country", "cartoHouse", dataHouse);
   // mapReshade("#USHOUSEMN .country", "us_cd_mn_2012.json", "country", "house", dataHouse);   

   //mnhouse updates
   mapReshade("#MNHOUSE .country", "mnleg.json", "country", "mnhouse", dataMNH);
   if ($(window).width() > 500) { mapReshade("#MNHOUSEMETRO", "mnleg_metro.json", "country", "mnhouse", dataMNH); }   

   //mnsenate updates
   mapReshade("#MNSENATE .country", "mnsenate.json", "country", "mnsenate", dataMNS);
   if ($(window).width() > 500) { mapReshade("#MNSENATEMETRO", "mnsenate_metro.json", "country", "mnsenate", dataMNS); }   

   d3.selectAll("path").classed("faded", false).classed("active", false);
   $(".block").removeClass("blockSelect");   

   toggleyBits(dataPrez,dataSen,dataGov,dataMNS,dataMNH,dataHouse,dataEVCD);

   if (thisView == "mn") { spillInfo(fetchData("Minnesota","Minnesota","table",dataPrez,"president")); }
   else if (thisView == "us") { spillInfo(fetchData("United States","United States","table",dataPrez,"president")); }
   else if (thisView == "cd") { spillInfo(fetchData("District 2","Minnesota","table",dataHouse,"ushouse",null,"District 2")); }
   else { $("#infobox").html(""); }

});
});
});
});
});
});
});
} //end reloadData

//NAV MENU DARK MAGICKS
$('#cssmenu li.active').addClass('open').children('ul').show();

$('#cssmenu li.has-sub>a, #mobmenu li.has-sub>a').on('click', function(){
    $(this).removeAttr('href');
    var element = $(this).parent('li');
    if (element.hasClass('open')) {
        element.removeClass('open');
        element.find('li').removeClass('open');
        element.find('ul').slideUp(200);
    }
    else {
        element.addClass('open');
        element.children('ul').slideDown(200);
        element.siblings('li').children('ul').slideUp(200);
        element.siblings('li').removeClass('open');
        element.siblings('li').find('li').removeClass('open');
        element.siblings('li').find('ul').slideUp(200);
    }
});

$( "button" ).click(function() { $("#mobmenu").toggle(); });
$("#mobmenu .raceSwitch").click(function() { $("#mobmenu").toggle(); });

//SOCIAL MEDIA TRIGGERS THAT DON'T WORK VERY WELL
function fbs_click() {

var u = location.href;
var t = document.title;

window.open('http://www.facebook.com/sharer.php?u='+encodeURIComponent(u)+'&t='+encodeURIComponent(t),'sharer','toolbar=0,status=0,width=520,height=350');return false;
}

function twitter_click(url){newwindow=window.open(url,'name','height=350,width=520');
    if (window.focus) {newwindow.focus()}
    return false;
}
</script>
</html>