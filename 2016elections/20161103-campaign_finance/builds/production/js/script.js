!function t(e,i,r){function a(o,s){if(!i[o]){if(!e[o]){var c="function"==typeof require&&require;if(!s&&c)return c(o,!0);if(n)return n(o,!0);throw new Error("Cannot find module '"+o+"'")}var l=i[o]={exports:{}};e[o][0].call(l.exports,function(t){var i=e[o][1][t];return a(i||t)},l,l.exports,t,e,i,r)}return i[o].exports}for(var n="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(t,e,i){d3.csv("./data/races.csv",function(t){return{race:t.district,chamber:t.chamber,democrat:t.democrat,dLast:t.dLast,dI:t.dI,republican:t.republican,rLast:t.rLast,rI:t.rI,candX:t.cand_xpend,indX:t.ind_xpend,totalX:t.total}},function(t,e){d3.csv("./data/candidates_master2.csv",function(t){return{id:t.CandRegNumb,district:t.District,party:t.PoliticalParty,first:t.CandFirstName,last:t.CandLastName,total:+t.TotReceipts,endcash:+t.EndCash,indcontrib:+t.IndContrib,ppcontrib:+t.PPContrib,pfcontrib:+t.PFContrib,lbcontrib:+t.LbContrib,pubfin:+t.PubFin,miscinc:+t.MiscInc,notepayinc:+t.NotePayInc,noterecinc:+t.NoteRecInc,expend:+t.TotalExpend,begin:+t.BeginCash}},function(t,i){function r(t,e,i,r,a,n,o,c){function l(t){if(t&&u!==t){var e=v.centroid(t);e[0],e[1],6,u=t}else p/2,f/2,3,u=null;d3.selectAll("#mapMetroH path, #mapStateH path, #mapMetroS path, #mapStateS path").classed("activeB",!1),b.selectAll("path").classed("activeB",u&&function(t){return t===u})}function d(t){if(t&&u!==t){var e=v.centroid(t);e[0],e[1],1,u=t}else p/2,f/2,1,u=null;b.selectAll("path").classed("faded",!1).classed("active",u&&function(t){return t===u})}var u,p=320,f=400;if("us"==n)var m=d3.geo.albersUsa().scale(700).translate([330,200]);else if("mn"==n)var m=d3.geo.albersUsa().scale(5037).translate([50,970]);else if("metro"==n)var m=d3.geo.mercator().scale([14800]).center([-92.384033,45.209134]);var v=d3.geo.path().projection(m),h=d3.select(t+" svg").attr("width",p).attr("height",f);h.append("rect").attr("class","background").attr("width",p).attr("height",f);var b=h.append("g");d3.json("shapefiles/"+r,function(t,e){b.append("g").attr("class","states").selectAll("path").data(e.features).enter().append("path").attr("d",v).on("click",l).attr("id",function(t){return(n+"_"+t.properties.DISTRICT).replace(new RegExp(" ","g"),"-")}).attr("precinctName",function(t){return t.properties.DISTRICT}).attr("class",function(t){var e="";"01"==t.properties.DISTRICT&&(e="activeB ");for(var i=0;i<o.length;i++)if(t.properties.DISTRICT==o[i].race){if(o[i].totalX>=5e5)return e+"purple5";if(o[i].totalX>=375e3)return e+"purple4";if(o[i].totalX>=25e4)return e+"purple3";if(o[i].totalX>=125e3)return e+"purple2";if(o[i].totalX>=0)return e+"purple1"}}).on("mousedown",function(t,e){"house"==a?s(t.properties.DISTRICT,"House"):"senate"==a&&s(t.properties.DISTRICT,"Senate")}).style("stroke-width","1px").style("stroke","#fff").call(d3.helper.tooltip(function(t,e){for(var i="",r=0,e=0;e<o.length;e++)t.properties.DISTRICT==o[e].race&&(o[e].totalX>=5e5?(i="purple5",r=o[e].totalX):o[e].totalX>=375e3?(i="purple4",r=o[e].totalX):o[e].totalX>=25e4?(i="purple3",r=o[e].totalX):o[e].totalX>=125e3?(i="purple2",r=o[e].totalX):o[e].totalX>=0&&(i="purple1",r=o[e].totalX));return"<div class='districtName'> District "+t.properties.DISTRICT+"</div><div class='"+i+"'>"+d3.format("$,.0f")(r)+" spent</div>"})),b.append("path").attr("id","state-borders").attr("d",v)});d3.behavior.zoom().on("zoom",function(){b.attr("transform","translate("+d3.event.translate.join(",")+")scale("+d3.event.scale+")"),b.selectAll("circle").attr("d",v.projection(m)),b.selectAll("path").attr("d",v.projection(m))});$(".zoom, .switch, #close, .mapSwitch").click(function(){d()}),$(".mapSwitch").click(function(){$("#filter input").val("")})}function a(t,e,i){var r=d3.format("%")(e[0]/i),a=d3.format("%")(e[1]/e[0]),n=d3.format("%")(e[2]/e[0]),o=d3.format("%")(e[3]/e[0]),s=d3.format("%")(e[4]/e[0]),c=d3.format("%")(e[5]/e[0]),l=d3.format("%")(e[6]/e[0]),d=d3.format("%")(e[7]/e[0]),u=d3.format("%")(e[8]/e[0]);$(t).html("<div class='bigNum'>"+d3.format("$,.0f")(e[0])+"</div><div class='bigBar'><div class='inBar' style='height:"+r+"'><div class='ind' title='"+d3.format("$,.0f")(e[1])+" independent contributions' style='height:"+a+"'></div><div class='pp' title='"+d3.format("$,.0f")(e[2])+" political party' style='height:"+n+"'></div><div class='pf' title='"+d3.format("$,.0f")(e[3])+" political committees' style='height:"+o+"'></div><div class='lb' title='"+d3.format("$,.0f")(e[4])+" lobbyist contributions' style='height:"+s+"'></div><div class='pubfin' title='"+d3.format("$,.0f")(e[5])+" public financing' style='height:"+c+"'></div><div class='misc' title='"+d3.format("$,.0f")(e[6])+" miscellaneous' style='height:"+l+"'></div><div class='notepay' title='"+d3.format("$,.0f")(e[7])+" receipts loans payable' style='height:"+d+"'></div><div class='noterec' title='"+d3.format("$,.0f")(e[8])+" noterec' style='height:"+u+"'></div></div></div><div class='subtotal'><div class='left'>Begin 1/1/16</div><div class='right'>"+d3.format("$,.0f")(e[11])+"</div></div><div class='subtotal'><div class='left'>Raised</div><div class='right'>+"+d3.format("$,.0f")(e[0])+"</div></div><div class='subtotal'><div class='left'>Expenditures</div><div class='right'>-"+d3.format("$,.0f")(e[9])+"</div></div><div class='subtotal'><div class='left'>End 12/31/16</div><div class='right'>"+d3.format("$,.0f")(e[10])+"</div></div>"),$(function(){$(document).tooltip()})}function n(t,e){for(var i,r,e,a=0;a<l.length;a++)l[a].district==t&&l[a].party==e&&(e=l[a].party,i=l[a].first,r=l[a].last);"DFL"==e?($("#partyD").html(e),$("#candD").html("<div>"+i+" "+r+"</div>")):"GOP"==e&&($("#partyR").html(e),$("#candR").html("<div>"+i+" "+r+"</div>"))}function o(t,e){for(var i=[],r=0;r<l.length;r++)l[r].district==t&&l[r].party==e&&(i[0]=Number(l[r].total),i[1]=Number(l[r].indcontrib),i[2]=Number(l[r].ppcontrib),i[3]=Number(l[r].pfcontrib),i[4]=Number(l[r].lbcontrib),i[5]=Number(l[r].pubfin),i[6]=Number(l[r].miscinc),i[7]=Number(l[r].notepayinc),i[8]=Number(l[r].noterecinc),i[9]=Number(l[r].expend),i[10]=Number(l[r].endcash),i[11]=Number(l[r].begin));return i}function s(t,e){if("House"==e||"Senate"==e){$(".results").hide(),$("#races").show(),$("#districtInfo").html("District "+t+" ("+String(e).toUpperCase()+")"),n(t,"DFL"),n(t,"GOP");var i=o(t,"DFL")[0]+o(t,"GOP")[0];a("#chartD",o(t,"DFL"),i),a("#chartR",o(t,"GOP"),i);for(var r,s,l,d=0;d<c.length;d++)t==c[d].race&&(r=c[d].totalX,s=c[d].indX,l=c[d].candX);$("#totalX").html(d3.format("$,.0f")(r)),$("#indX").html(d3.format("$,.0f")(s)),$("#candX").html(d3.format("$,.0f")(l))}}var c=e,l=i;jQuery.fn.d3Click=function(){this.each(function(t,e){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(i)})},jQuery.fn.d3Down=function(){this.each(function(t,e){var i=document.createEvent("MouseEvents");i.initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(i)})},jQuery.fn.d3Up=function(){this.each(function(t,e){var i=document.createEvent("MouseEvents");i.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(i)})},d3.helper={},d3.helper.tooltip=function(t){return function(e){var i,r=d3.select("body").node();e.on("mouseover",function(e,a){d3.select("body").selectAll("div.tooltip").remove(),i=d3.select("body").append("div").attr("class","tooltip");var n=d3.mouse(r);i.style("left",n[0]+10+"px").style("top",n[1]-15+"px").style("position","absolute").style("z-index",1001);t(e,a)}).on("mousemove",function(e,a){var n=d3.mouse(r);i.style("left",n[0]+10+"px").style("top",n[1]-15+"px");var o=t(e,a)||"";i.html(o)}).on("mouseout",function(t,e){i.remove()})}},function(){d3.select("#raceSelection").selectAll(".switch").data(c).enter().append("div").attr("class",function(t){return"switch "+t.chamber}).attr("chamber",function(t){return t.chamber}).attr("district",function(t){return t.race}).on("click",function(t){}).html(function(t){if("House"==t.chamber||"Senate"==t.chamber)return"<div class='cell'>District "+t.race+"</div><div class='cell'>"+t.dLast+" "+t.dI+"</div><div class='cell'>"+t.rLast+" "+t.rI+"</div><div class='cell kill'>"+t.chamber+"</div>"}),$("#filter_box").keyup(function(t){$(".switch").hide();var e=$("#filter_box").val();$(".switch").each(function(){$(this).text().toUpperCase().indexOf(e.toUpperCase())!=-1&&$(this).show()})}),$(".sift").click(function(){return $(".sift").removeClass("selected2"),$(this).addClass("selected2"),$(".switch").hide(),$("."+$(this).attr("data")).show(),$("#raceSelection").animate({scrollTop:0},800),!1}),$(".switch").click(function(){$(".switch").removeClass("selected"),$(this).addClass("selected"),s($(this).attr("district"),$(this).attr("chamber"));var t="mn_"+$(this).attr("district"),e="metro_"+$(this).attr("district");$("[id='"+t.replace(new RegExp(" ","g"),"-")+"']").d3Down(),$("[id='"+t.replace(new RegExp(" ","g"),"-")+"']").d3Up(),$("[id='"+t.replace(new RegExp(" ","g"),"-")+"']").d3Click(),$("[id='"+e.replace(new RegExp(" ","g"),"-")+"']").d3Down(),$("[id='"+e.replace(new RegExp(" ","g"),"-")+"']").d3Up(),$("[id='"+e.replace(new RegExp(" ","g"),"-")+"']").d3Click()}),$("#listLabels").click(function(){$("#listR").slideToggle(),$("#listD").slideToggle()})}(),s("01","Senate"),r("#mapMetroS","#infobox","#chart","mnsenate_metro.json","senate","metro",c,0),r("#mapStateS","#infobox","#chart","mnsenate.json","senate","mn",c,0),r("#mapMetroH","#infobox","#chart","mnleg_metro.json","house","metro",c,0),r("#mapStateH","#infobox","#chart","mnleg.json","house","mn",c,0);$.urlParam=function(t){var e=new RegExp("[?&]"+t+"=([^&#]*)").exec(window.location.href);return null!=e?e[1]:0},0!=$.urlParam("race")&&0!=$.urlParam("chamber")&&(s($.urlParam("race"),$.urlParam("chamber")),$("#leftSide").hide())})})},{}]},{},[1]);