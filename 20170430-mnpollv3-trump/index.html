<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MNPOLL</title>
  	<meta name="description" content="MNPOLL">
 	<meta name="author" content="Frey Hargarten - StarTribune">
	<meta name="generator" content="BBEdit 10.5" />
	
	<link rel="stylesheet" href="./builds/development/css/style.css">

	<style type="text/css">

	#change svg {
	    text-align:center;
	    height:380px !important;
	    max-height:380px !important;
	}

	#change {
	    text-align:center;
	    height:380px !important;
	    margin-left: auto;
	    margin-right: auto;
	    max-height:380px !important;
	}

	.powerline {
	    stroke-dasharray: 5, 5;
	    stroke: #333;
	}

	#change .c3-line {
	  stroke-width: 6px !important;
	}

	.dataframe { 
		height:2200px;
	} 

	#bigResults {
	    text-align: center;
	    width: 100%;
	    margin: 20px;
	}

	.question {
	    font-family: "Benton Sans";
	    font-size: 1.3em;
	    font-weight: 900;
	}

	.result {
	    display: inline-block !important;
	    text-align: center;
	    margin: 20px;
	    width: 112px;
	}

	.bigNum {
	    font-size: 3em;
	    font-family: "Benton Sans" !important;
	    text-align: center;
	    font-weight: 900;
	    padding-top: 15px;
	    padding-left: 15px;
	    padding-right: 15px;
	    padding-bottom: 5px;
	}

	.forNum {
	    color: #00222D;
	}

	.againstNum {
	    color: rgb(115, 115, 115);
	}

	.downloadButton9 {
	    font-family: "Benton Sans",Helvetica,Arial,sans-serif;
	    font-weight: bold;
	    color: #333333;
	    border: none;
	    font-size: .9em;
	    text-align: center;
	    margin-top: 14px;
	    margin-left: 1%;
	    padding-top: 0px;
	    width: 99%;
	    background-color: #fff;
	    color: #333;
	    background-image: url(./builds/development/img/downloadDoc.svg);
	    background-size: 18px 18px;
	    background-repeat: no-repeat;
	    background-position: 42% 76%;
	}

	.downloadButton9:hover {
	    background-color: #fff !important;
	    opacity: .5;
	    cursor: pointer;
	}

	#selector { 
		display:block !important ;
	}

	@media only screen and (min-width: 200px) and (max-width: 767px) { 
		.dataframe { 
			height:2400px; 
		}
	}
	</style>
</head>

<body>
	<div id="questions_list">
		<div class="questionBlock section" id="question1">
			<div class="question">Question 1</div>
			<div class="bigResults">
				<div class="result">
				  <div class="bigNum forNum"><span class="for">0</span>%</div>
				  <div class="stat forLabel">support</div>
				</div>
				<div class="result">
				  <div class="bigNum againstNum"><span class="against">0</span>%</div>
				  <div class="stat againstLabel">oppose</div>
				</div>
			</div>

			<div id="historyBox">
			  <div class="icon"></div>
			  <div class="chartTitle">Historical Minnesota Poll presidential approval ratings</div>
			  <div class="chatter">Data collected by the Star Tribune dates back to 1945. All polls taken early in the president's term.</div>
			<div id="change"></div>
			</div>

		</div>


		<div class="questionBlock section" id="question2">
			<div class="question">Question 2</div>
			<div class="bigResults">
				<div class="result">
				  <div class="bigNum forNum"><span class="for">0</span>%</div>
				  <div class="stat forLabel">support</div>
				</div>
				<div class="result">
				  <div class="bigNum againstNum"><span class="against">0</span>%</div>
				  <div class="stat againstLabel">oppose</div>
				</div>
			</div>
		</div>


		<div class="questionBlock section" id="question3">
			<div class="question">Question 3</div>
			<div class="bigResults">
				<div class="result">
				  <div class="bigNum forNum"><span class="for">0</span>%</div>
				  <div class="stat forLabel">support</div>
				</div>
				<div class="result">
				  <div class="bigNum againstNum"><span class="against">0</span>%</div>
				  <div class="stat againstLabel">oppose</div>
				</div>
			</div>
		</div>


		<div class="questionBlock section" id="question4">
			<div class="question">Question 4</div>
			<div class="bigResults">
				<div class="result">
				  <div class="bigNum forNum"><span class="for">0</span>%</div>
				  <div class="stat forLabel">support</div>
				</div>
				<div class="result">
				  <div class="bigNum againstNum"><span class="against">0</span>%</div>
				  <div class="stat againstLabel">oppose</div>
				</div>
			</div>
		</div>


		<div class="questionBlock section" id="question5">
			<div class="question">Question 5</div>
			<div class="bigResults">
				<div class="result">
				  <div class="bigNum forNum"><span class="for">0</span>%</div>
				  <div class="stat forLabel">support</div>
				</div>
				<div class="result">
				  <div class="bigNum againstNum"><span class="against">0</span>%</div>
				  <div class="stat againstLabel">oppose</div>
				</div>
			</div>
		</div>
	</div>

	<div class="section" id="breakdowns">
		<div id="exploreLayer" class="chartTitle">Explore the data</div>

		<div id="viewSwitch">
		<div id="selector">
		  <section class="main">
		        <div class="wrapper-demo">
		          <div id="dd" class="wrapper-dropdown-1" tabindex="1">
		            <span>Question 1</span>
		              <ul class="dropdown months" tabindex="1">
				        <li class="thisSwitch"><a href="#" data="terrorism1">Question 1</a></li>
				        <li class="thisSwitch"><a href="#" data="terrorism2">Question 2</a></li>
				        <li class="thisSwitch"><a href="#" data="terrorism3">Question 3</a></li>
				        <li class="thisSwitch"><a href="#" data="terrorism1">Question 4</a></li>
				        <li class="thisSwitch"><a href="#" data="terrorism3">Question 5</a></li>
		              </ul>
		          </div>
		        â€‹</div>
		</section>
		</div>
		</div>

	    <div id="results" class="embed"><iframe id="dataframe" class="dataframe" src="./builds/development/?poll=terrorism2" border="0" frameborder="0" scrolling="no" width="100%" height="2200"></iframe></div>

	    <a href="https://github.com/striblab/20170430-mnpollv3-trump/tree/master/builds/development/data/_raw/20170430-mnpollv3-trump.csv"><button class="downloadButton9">Download Data</button></a>
	</div>

</body>

<script src="//code.jquery.com/jquery-latest.js"></script>
<script src="./builds/development/js/c3.min.js"></script>
<script src="./builds/development/js/d3.v3.min.js"></script>

<script>
	$.urlParam = function(name){
	  var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
	  if (results != null) { return results[1] || 0; }
	  else { return null; }
	}

	var selected = $.urlParam('section');

	if (selected != null){
	$(".section").hide();
	$("#" + selected).show();
	} else { $(".section").show(); }

	$(".thisSwitch").on("click",function(){
		$("#dataframe").attr("src","./builds/development/?poll=" + $(this).find("a").attr("data"));
	});

	function trendChart(){

      var  padding = {
            top: 40,
            right: 40,
            bottom: 30,
            left: 40,
        };

      chart = c3.generate({
            bindto: '#change',
            padding: padding,
        data: {
            // x: 'x',
            columns: [
                ["Approve",0.74,0.77,0.83,0.75,0.63,0.41,0.73,0.61,0.65,0.54,0.51,0.62,0]
            ],
            type: 'line'
        },
        legend: {
        	show:false
        },
        color:  { pattern: ['#000000', '#737373'] },
        axis: {
          y: {
          		max: 1,
                min: 0,
                padding: {bottom: 0, top:0},
                tick: {
                 count: 4,
                 values: [0,0.25,0.50,1],
                 format: d3.format('%')
                }
            },
            x: {
            type: 'category',
            tick: {
                rotate: 75,
                multiline: false
            },
            categories: ["Truman (1945)","Eisenhower (1953)","Kennedy (1961)","Johnson (1964)","Nixon (1969)","Ford (1974)","Carter (1977)","Reagan (1981)","Bush (1989)","Clinton (1993)","Bush (2001)","Obama (2009)","Trump (2017)"]
        }
          },
	    grid: {
	        y: {
          lines: [
                {value: 0.5, text: '', position: 'start', class:'powerline'}
          ]
	        }
	    }	
    });
}

trendChart();
</script>

<script type="text/javascript">
      
      function DropDown(el)  { 
        this.dd = el;
        this.placeholder = this.dd.children('span');
        this.opts = this.dd.find('ul.dropdown > li');
        this.val = '';
        this.index = -1;
        this.initEvents();
      }
      DropDown.prototype =  { 
        initEvents : function()  { 
          var obj = this;

          obj.dd.on('click', function(event) { 
            $(this).toggleClass('active');
            return false;
          });

          obj.opts.on('click',function() { 
            var opt = $(this);
            obj.val = opt.text();
            obj.index = opt.index();
            obj.placeholder.text(obj.val);
          });
        },
        getValue : function()  { 
          return this.val;
        },
        getIndex : function()  { 
          return this.index;
        }
      }

      $(function()  { 

        var dd = new DropDown( $('#dd') );
        var dd2 = new DropDown( $('#ddY') );

        $(document).click(function()  { 
          // all dropdowns
          $('.wrapper-dropdown-1').removeClass('active');
        });

      });

</script>
</html>